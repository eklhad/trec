		The L Theorem

An L polyomino is a rectangle with a rectangular notch removed from one corner.
When oriented properly, these resemble the capital letter L,
a large rectangle with a smaller rectangle removed from the upper right.
More often we orient the polyomino so that it lies on its back,
with its foot sticking up. We refer to this polyomino as "lying on its back",
or "face up".

Let the L polyomino have width w and height h, where w >= h.
Remove a y×z rectangle from the upper right corner.
This shape is said to be "lying on its back",
because it is oriented horizontally.
Rotate it 90° counter clockwise and it is "standing up", or "pointing up".

With 4 variables, we need 3 equations to establish the shape. As we place
pieces on the board, we often establish three equations, and thus the shape.
Sometimes an inequality will do the trick,
depending on the section we are in.
You need to keep track of the equations and inequalities that are in force.

	1. L polyominoes of order 2.

If z is half of h or y is half of w, the polyomino has order two.
Henceforth we shall assume z is not half of h and y is not half of w.

	2. Pieces never lie face down on the floor.

If piece a lies face down on the floor, its tab pointing right,
and piece b is immediately to the right of a,
b cannot place its base or back against a,
else the notch of a is permanently isolated.

If b is the 180° rotation of a, it cannot slide its tab under the tab of a
(z < h/2), or the two tabs leave a thin gap (z > h/2).
So the face of b slides under the tab of a.

If there are no gaps anywhere, y = z and z = w-y, hence w = 2y.
This contradicts {1}, so there must be a gap between the tab of a and the notch of b.
This means z = w-y and z > y. In other words, z + y = w, and z is the larger.
z is more than half of w and certainly more than half of h.
With h > z, h is more than half of w. Our shape is not long and skinny.

Only the tab of a piece can fit into the resulting a-b gap of width z-y.
h, w, and w-y are too large.

Let the tab of c fill the corner of a and b.
If c faces left over a, we have a gap of height y - (h-z), or y + z - h, or w - h.
This is smaller than w, and with h more than half of w it is smaller than h.
With h > z > y it is smaller than w-y.
We might try to slide the tab of d between a and c,
but d would lie face up on top of a, the two pieces back to back,
and the tab of d would have to be at least z, to reach c,
but the tab has length y, and z > y.
Therefore a tab cannot slide in between a and c, and there is no gap.
y = h-z, and w = h.
We are dealing with a shape bounded by a square.

If c completely fills the gap above b, z-y = h-z = w-z = y, and the shape is established,
a 3×3 square minus a 1×2 rectangle. This has order 28.
If c and d both point their tabs down into the notch of b,
z-y = 2(h-z) = 2y,
and the shape is established, a 4×4 square minus a 1times3 rectangle.
This is ruled out by trec @f0f0f080.

Finally let c face right. Since d cannot stand next to c facing left,
c fills the gap entirely, giving z - y = h-z, or h + y = 2z.
Now c hangs z-(h-z) squares beyond b. This is y squares beyond b.
Put d on the floor beneath c, and assume d points right. This gives a gap of height w-h.
We dealt with the square shape, w = h, in the last paragraph, giving e0c0c0,
so this gap is real, and must be filled.
Since h is more than half of w it is too large.
w-y > w-z > w-h, so w-y won't fit.
Only a tab can fit, and it must fit precisely, giving 2h-z = w, or 2h = 2z + y.
Combine this with h + y = 2z and find the shape, a 5×4 rectangle minus a 2×3 rectangle.
This is ruled out by trec @f8e0e0e0.

If d faces b there is a gap between b d and c that can't be filled.
If d points toward b, and e fits in the corner of b and d,
e and d can't interlock, as that would give a piece of order 2, or create holes.
e faces b, giving h-z + w-y = w.
This reduces to h = w, which we dealt with.
Therefore d stands back-to-back against b.

Verify that d cannot point down; its notch could not be completely filled by e.
h > z > y, so e can't point right.
If e points left then h-z = y, or h = w, which is the square again.
Thus d stands up, the reflection of b.

If c is flush with the tab of d, then 2(h-z) = z, or 2h = 3z.
Combine this with h + y = 2z and find e0c0c0 again.

If c extends beyond the tab of d, we have a gap of height y to fill.
w and h don't work, and w-y yields order 2.
Thus h-z = y, and we have the square again.

Thus c does not reach the edge of d.
Place e in the corner of c and d,
and note that e cannot point down and wrap around d, as z is more than half of h, and more than h-z.
Neither can e point to c and wrap around d, as y is more than h-z.
e must not extend past the right of d, else we have a gap of height y, as described in the last paragraph.
The tab presents the smallest edge, of length h-z,
and that is the same as the top of d, so would be pushed to the right by c.

Henceforth we can assume that a piece never lies face down on the floor,
or faces the left or right wall.

	3. Square pieces never point down onto the floor.

The only requirement in {2} is that w >= h,
so redefine the roles of h and w, and the piece is lying face down on the floor,
which we already analyzed.

	4. Pieces cannot point down on the floor when y < h.

Let a point down onto the floor,
and clearly, b cannot put its blunt end under a.
b cannot slide its face into the notch of a,
else the shape has order 2.
Thus b points into a.
We may also assume w > h by {3}.

b has to fill the notch of a, thus h-z = y.

If there is no gap between a and b at level y,
y = z, and h = 2z, giving a shape of order 2.
So we have a gap of width y-z in the notch of b.
This puts z < y < h.

Place c in the corner of a and b.
This must be the face or tab of c.
Suppose c lies face down and points left, extending over the top of a.
If z = w-y then we have a square (h=w).
If z > w-y then z > h - y, yet z = h - y.
Therefore c points right, and completely fills the a-b gap,
giving w-y = y - z.
This is a b c interlock,
where c extends z squares beyond b.
Put d on the floor below c.
If d faces left it must fit exactly, giving w-y = h.
Yet w-y = y - z, so h = y - z, which contradicts y < h.
Instead, d must lie down and point right.
We already know z + y = h, hence z < w-y. Thus c does not reach the notch of d.
Place e in the corner of c and d.
If e extends beyond the face of d we have a gap of height z, between d and e,
that cannot be filled by f without crashing into e or creating holes with d or with the floor.
e can't point down and wrap around d, since z < y.
e can't lie face down and point left and interlock with d, because e would crash into c. We already saw that the tabs extend outward from such an interlock.
Therefore, c cannot lie face down atop b.

We now know that c points down onto b.
If c faces right, its tab fills the entire gap, giving y - z = h-z, or y = h.
So c faces left, d stands back-to-back against c, and 2(h-z) = y-z.
this implies 2h = y  +  z, yet y + z is h.
That takes care of c, and b, hence a cannot point down.

	5. Small notch: y < h/2 and z < h/2.

Suppose our shape has a small notch, y and z are both less than half of h.
Let a tile the origin - the lower left corner of the tiled rectangle.
By {4}, its back must be placed against the floor or the left wall.
We can always reflect the tiled rectangle, so assume a lies on its back,
its notch at the upper right. piece b,
immediately to the right of a on the floor,
cannot place its back or base against a, else the notch cannot be filled.

Suppose b stands up and faces left.
If the two notches do not coincide in height,
one or the other will create a gap that cannot be filled. Thus h-z = w-y.
It is possible that w = h and y = z,
but this square in a square will be handled in the next paragraph.
For now, assume w > h, hence y > z. This is illustrated by a 8×7 rectangle
with a 3×2 notch removed. The a-b gap has width y + z,
which is strictly less than h. It must be filled by a tab of width w-y or h-z (same thing).
Assume c lies on top of a, and the two are 180° rotations of each other.
We say that a and c are "interlocked".
A rectangular space now exists between c and the left wall, just above a.
Its width is w - 2y and its height is h-z.
Rewrite w - 2y as h-z - y, a width considerably smaller than h,
and even smaller than the tab h-z. Nothing can fill this space.
Thus c stands up, with its tab pointing down into the a-b gap.
If c faces left there is a gap between a and the overhang of c,
having height y-z. This is clearly unfillable, unless y = z (no gap),
but we're assuming y > z, so let's move on.
Let c face right and interlock with b.
The rectangular space between c and the left wall now has width w-y and height w - z.
A tab of width w-y can indeed slide into this space,
but in order to reach all the way down to a, w - z must be <= y or z.
If y+z is at least w then y+z exceeds h, which contradicts (y and z) < h/2.
Thus b does not stand up next to a.

Since b does not stand up next to a, it must lie down on the flor,
the horizontal reflection of a.
This presents a 2y×z gap which will be filled by the face or tab of c.
Suppose c is horizontal, hence 2y = w-y, or w = 3y.
If c points left then the space between c and the left wall has width y,
and cannot be filled. If c points right then this space has width 2y,
just like the a-b gap. Since 2y < h,
only a tab or face can slide into this space.
Yet the space has height h-z, which is longer than y or z.

Now c points down, its tab filling the double notch.
This implies 2y = h-z. The vertical gap between c and (a or b)
has height y - z, which implies y >= z.
Nothing fits into a gap of height y, much less y-z, so y equals z.
Combined with the last equation, y = z = h/3. That is, h = 3z.
If w = h, a situation that was postponed before, we have established the shape,
a 3×3 square minus a 1×1 square.
This is ruled out by trec @e0e0c0, hence w > h.

Place d on top of a, at the left wall, in the gap of width w-y - z and height w-y.
Since y and z are both smaller than w-y, d cannot point down or face down
without crashing into c or creating an unfillable gap.
d stands up and faces right.
Any other pieces between d and c must also stand up.
If there is an adjacent piece e with its back to d,
the d-e gap can only be filled with the tab of f,
as w-y > h-z, (remembering w > h and y = z),
and f creates holes against the left wall.
e faces d,
creating a double notch that is filled by f.
d and e mean w is at least 2h + z, so w-y is at least 2h.
The face of f won't fit in this gap.
Nor two tabs, since h-z is more than half of h.
Put the tab of f in this d-e gap.
If f faces left the space between f and the left wall, h - 2z = z,
is too small. If f faces right the gap is h-z,
so the tab of g might slide in, but then y >= w-y, which contradicts 2y < h.
Thus d is the lone vertical piece.

If c faces left then w-y = h + z, or w = h + 2y.
This establishes the shape, a 5×3 rectangle minus a 1×1 square,
which is handled as a separate theorem f8f8f8e0.
Thus c faces right, and w-y = h. This establishes the shape,
a 4×3 rectangle minus a 1×1 square. This polyomino has order 50.
That completes the analysis of the small notch, with (y and z) < h/2.

	6. Tall thin notch: y < h/2 and z > h/2.

Thanks to {2} and {4}, a lies on the floor, its notch at the upper right.
Put b on the floor next to a.
If b has its back to a, or its left end to a, that tall thin notch can't be filled.
Tab is not long enough; face is too wide.
Suppose b is the reflection of a,
and presents a double notch that will be filled by c.
Unfortunately the tab of c isn't long enough to do the job.
But c might lie face down, if 2y = w-y. That is, w = 3y.
If c points left then the space between c and the left wall has width y,
which can only be filled if h-z = y.
Slide d into this slot, facing right,
and let e fill the corner created by c and d,
having width w-z and height 2y.

If e points up we must compare w - z and h (which is y+z).
Sinze z > y, 3y - z < y + z.
Thus e extends beyond c, over b, producing a gap of height h-z.
An even longer gap is produced if e lies on its back.
Let f slide its tab between e and b.
We can't afford any gaps between e and f, so w - z + y is either w or h.
The former forces y = z (contrary to our assumptions),
and the latter implies 4y = h+z = y+z+z, or 3y = 2z.
This establishes the shape, a 6×5 rectangle minus a 2×3 rectangle,
which is ruled out by trec @fcfcf0f0f0.

If e points down into the c-d corner, and its tab does not cover all of c,
we find a ((w-z)-(h-z))×y gap.
If w = h we find the now-familiar shape e0e080 of order 28.
With w > h we have a gap to fill.
Even if f could fill this gap with its tab,
lying face down, it would crash into b.

Next, e might point down and face d, wrapping around c, whence w - z = z.
Thus 2z = 3y, building the same shape we saw before, fcfcf0f0f0.

That brings us to the last orientation of e, lying face down.
Since w-y > w - z, e still extends beyond c.
Once again we ask the tab of f to slide under without gaps,
forcing w-z + y = w-y, or 2y = z. This gives our order 28 shape again.
That takes care of c pointing left.

Next let c point right. Since 2y < h,
d places its face or tab in the gap above a.
If its tab is down, then 2y = h-z, and the tab cannot reach all the way down to a.
So d is the vertical reflection of a.
Let e fill the gap between c and the tab of d.
Thus 2z-h is either 2y or h-z.
Assume the former, hence z-y is half of h.
The gap between the tabs of d and e is z-y, or half of h.
Since 3y is at least h, 2y is more than half of h,
so let the tab of f fill the corner of d and e.
If f faces left we can't afford a gap between d and f, hence y = h-z.
This makes y ¼ of h and z ¾ of h, whence 3y < h, hence w < h,
which is impossible.
Thus f faces right and its tab fills the entire gap,
hence h-z = h/2, giving a shape of order 2.

Therefore e lies on its back across c, and 2z - h = h-z, or z = 2h/3.
Remember that y is at least h/3, else h < w.
If y is exactly h/3 we create a shape we've seen before, of order 28,
so assume y > h/3. Remember that y < h/2.
If f, above d, points up,
we have a gap of width w-h = 3y-h, which is smaller than y.
If filled by the tab of g, we have 3y = 4h/3, or 9y = 4h.
This establishes the shape, a 12×9 rectangle minus a 4×6 rectangle.
It also produces a thin gap of height 1 between e and g that cannot be filled.
Therefore, f lies back-to-back atop d.

f can't point left because of its tall thin gap, so f points right.
Place g above f.
If g stands up or lies on its back we have a gap of height z.
2y is too large, and h-z is too small,
so g is the vertical reflection of f. The double notch has height 2z.
If i stands up in this double notch we will not be able to fill the notch of
i, because of the tab of g, which is longer than h-z.
Nor can i face left, because 2y < 2z.
We must fill the double notch with two horizontal pieces,
reaffirming 2z = h + h-z. Once i and j are placed,
j extends above the top surface of g.
This is exactly the same pattern we saw 2h rows below.
By induction, pieces climb up the left wall forever.
That completes the case of b lying down and pointing towards a.

At this point b stands up and faces left.
Note that w-y >= h-y > h-z, so the notch of a is lower,
and must be filled first. Since w-y > y,
only the thin tab of c can fill the notch of a. In fact c and b interlock.
Thus y = h-z. Also, h-z + y = w-y, or w = 3y.
z can't be more than twice y, else h > w.
z is greater than y by the assumptions of this section.
When z = 2y we find e0e0c0 again.
Thus z is strictly between y and 2y.
That puts y between h/3 and h/2.

Piece d filss the space between c and the left wall, just above a.
h-z is smaller than 2y, and leavs a gap,
so pieces d and a are vertical reflections.
This gives a gap between c and the tab of d of height 2z-3y.
If there is no gap, we have 2z = 3y.
This establishes the shape, fcfcf0f0f0, which we saw before.
So there is a real gap, filled by the tab of e.
If 2z-3y = h-z = y, then z is twice y, which has already been handled.
This completes the case of b standing up.

When this result is combined with {5}, we can assume, hereinafter,
that y is at least h/2.

	7. y = h/2.

Assume w > h, else the shape has order 2.
That means w-y > y.
We can't put the face of a shape in a gap of width y.

Remember that {2} and {4} rule out certain orientations.
Let a lie on the floor and point right.
Put b on the floor next to a.
If b has its back or left end next to a, there is a y by z gap to fill.
Even if b faces a, we still have a gap of width y to fill.
Only the tab of c might fit into this gap.
If two tabs, then 2(h-z) = h/2, or 3h = 4z.
Now the tab of c isn't long enough to reach down into the notch of a.
If one tab, then h-z = h/2, or h = 2z. This has order 2.

b is the reflection of a, and presents a double notch of size h×z.
Suppose c fills this double notch, or at least the left side of it,
by lying face down, whence w-y <= h.
Equivalently, w - h <= y.
If c points left then the space between c and the left wall has width w-2y = w-h <= y.
The tab of d must precisely fill this gap.
To reach down to a, y is at least h-z, thus z >= h/2.
In fact z > h/2.
There is a gap of height z-y between d and c.
The tab of e isn't long enough to reach the notch of d.

Therefore, c points right, and w-y is precisely h.
Our shape is a square with a tab attached.
The space between c and the left wall now has width h, the side of the square.
If d fills this space, and is the vertical reflection of a,
there must be a gap between c and the tab of d, (since z cannot be half of h).
This gap has height 2z-h, which forces z > h/2.
The gap is filled by the tab of e, hence 2z-h = h-z, or 3z = 2h.
This establishes the shape, a 9×6 rectangle minus a 3×4 notch.
See theorems/ff+ff+fcfcfcfc.

If we still want c to point right, d must point up the left wall.
Let e fill the corner of c and d.
If e presents a flat side, any side, against d,
the notch of d cannot be filled.
A piece pointing down into this notch crashes into the left wall or leaves a tall thin gap with the left wall.
If e lies face down and points left,
if will perfectly wrap around d. This because h+z = h+z.
Tabs must not collide, so z > h/2.
This leaves a gap between d and e and once again a piece points its tab
down into the notch of d, and crashes into the left wall
or leaves a gap with the left wall.

Finally e lies back-to-back atop c, and points towards d.
If d and e are flush then z is half of h, which gives an order of 2.
Since the pieces are not flush, we have a gap above d or e,
of width z or y respectively, that cannot be filled.
That's it for e, and d, and c lying face down.

Since w > h, c cannot lie on its back inside the double notch,
and we can't fit two downward tabs precisely in the double notch (z would be half of h),
and one tab doesn't fill the entire gap,
so c stands up.
Where is the notch of c, relative to the height of a and b?
If the notch is lower than h, we have w-y + h-z < h, or y+z > w.
Thus y+z > h and z is bigger than y.
Piece d could lie face down in the notch of c, pointing over the tab of c -
we know there's room across c.
Yet this leaves a square gap of side z-(w-y).
It's a real gap, since y+z > w.
With w-y at least h/2, the face of e won't fit into this gap.
Only the tab of e can fill this gap.
Since 2z > y+z > w, e can't lie face down without crashing into  a or b (depending on which way c faces).
e is face up, and one tab fills the gap.
The gap between e and a or b is too long and narrow to be filled.
If you try to slide a piece in it crashes into e, or a or b.

We must use tabs to fill the notch of c.
One thin tab cannot fill the notch, since h-z is less than half of h.
If two thin tabs fill the notch, 2(h-z) = z, or 2h = 3z.
w floats between h and 7/6 of h.
one of the two pieces, facing away from the tab of c,
creates a gap of width z and height w-z.
Only a tab can slide in, and it isn't long enough to close the gap.
That completes the notch of c below the a-b line.

Suppose the notch of c is flush with its neighbor, hence w-y = z.
z is still bigger than y, so that w can be bigger than h.
If c faces right, the space between c and the left wall has width z,
and can only be filled by the vertical reflection of a.
Since 2z > y+z, there is a gap between the tabs of c and d,
which is h-z by z-y.
Only a tab can fit, and e can't face down, else it crashes into c.
This leaves a long narrow gap above c and b of height y that cannot be filled.
So c faces left, and the space between c and the left wall has width 2z.

Let d sit atop a, against the left wall.
If d lies on its back, the gap between the tabs of d and c has width z-y.
Only a downward pointing tab is thin enough to slide in.
e can't face left, or it crashes into d, so just one tab, with e facing right.
z-y = h-z. z is 3/4 of h.
This establishes the shape, f8e0e0e0, which we've seen before.

If d lies face down, d and c create an enclosed space that can't be filled.

If d points down, the gap between d and a can't be filled.

Finally d stands up along the left wall.
The gap between d and the tab of c has width 2z-h.
Only a tab fits, one tab, as e faces right.
Thus 2z-h = h-z, or z = 2h/3.
This establishes the shape, a 7×6 rectangle minus a 3×4 rectangle.
This is ruled out by trec @fefef0f0f0f0.

At this point, the notch of c rises above a and b.
In other words, w-y > z.

Let d, just to the left of c, lie down on top of a,
the vertical reflection of a,
and suppose c faces right.
We know w > y+z, and if y > z, w > 2z,
whence c won't fit.
z can't equal y, half of h,
so y < z, and the tab of d extends beyond the tab of c.
Place e in the gap between the two tabs.
This gap has height 2z - w, which is less than z-y.
Only the tab of e can fit.
e can't face down or it crashes into c.
Thus we have a long narrow gap between e and c+b that can't be filled.

So c faces left and d wraps around c, giving 2z = w-y.
If z < h/2, the tabs of c and d collide.
Thus z > h/2, and there is a gap between the tabs of d and c of width z-y.
Let the tab of e fill the corner where c and d meet.
If e faces left, there is a gap between d and e that cannot be filled.
So e faces right and interlocks with the tab of c, and z = 3h/4.
This establishes the shape, an 8×4 rectangle minus a 2×3 rectangle.
This is ruled out by trec @fffcfcfc.
That's the end of d lying down.

If d points down onto a, and c faces right, y+z = w; yet w > y+z.
If c faces left, y+z = w-y, and h-z = w-y, hence y+2z = h.
This establishes the shape, f8f8f8e0, which we've seen before.

Finally let d point up along the left wall.
If there is a gap between d and c above a, it is filled by the tab of e.
e can't face left or it perfectly interlocks with d, giving order 2.
If e faces right then the gap between d ane is filled by two pieces pointing down,
and the left piece crashes into the left wall.
There is no gap, and w-y = h.

Suppose c faces d, d standing z ssquares higher than c.
With w-y > z, only the thin tab can be used to fill the notch of c.
In fact we must use two of them, one facing left, and that forces y = z. Yet z can't equal h/2.
Thus c faces right.
d still stands z squares higher than c.
If z < y, the bracketed notch of d cannot be filled, hence z > y.
Let e fill the corner where c and d meet.
If e presents a straight left vertical edge, it brackets the notch of d,
which cannot be filled.
If e presents a straight horizontal edge, beyond the tab of c,
the notch of c cannot be filled.
The only way to save the situation is for e to point down and face left,
and interlock with d.
This gives y = z-y, which is impossible.
That's it for d, and c rising above the landscape.

We've placed the notch of c below, at, and above the a-b line,
and made no progress. Thus b does not point towards a.
Instead, b stands up and faces a.

If the notch of b is higher than the tab of a,
the gap of width h/2 cannot be filled.
One tab sets h-z = y.
Two tabs forces c to face left and hang over a,
which sets z = y, or makes a thin gap between a and c of height y-z, which could not be filled.

Suppose they are flush, hence h-z = w-y.
thus h-z >= h-y, and z <= y.
Since z can't equal y, z < y.
This in turn makes w > h.

The gap is y+z, which is less than h. Place c in the notch of a.
It can't stand up, and its tab won't precisely reach the notch of a,
so c lies face down.
If it points right, its tab crashes into b, which is standing up.
Thus c points left across a.
If c is a perfect fit in the gap we have w-y = y+z.
This establishes the shape, f8f8f8e0, which we have seen before.
whose disposition is unknown. If we need to supplement with the tab of d,
we have w-y + h-z = y+z, which forces 2z = w, and w becomes smaller than h.

Finally let the notch of b remain lower than the tab of a, whence w-y < h-z.
Clearly y has to be larger than z, to make up for the fact that w exceeds h.
Now w-y, which is larger than y, is larger than z,
so the face of c will not fit into the notch of b.
Nor will the tab, since h-z > z.
That takes care of b standing next to a.

Those are all the cases for this section.
With {5}, {6}, and {7} behind us,
we can assume y > h/2.

	8. y < h, c points down in the notch of a and faces left

Let's see how far we get with y between h/2 and h.
{2} and {4} are in effect, so put a in the corner, face up and pointing right,
and put b on the floor next to a.
Without regard to b, put the tab of c in the notch of a, with c facing left.
If y > z then there is a thin gap between c and a. It is z by y-z.
h-z is bigger than y-z, so no tabs in this gap.
If d faces c interlocked then w-y = y-z.
Yet with d standing on a, w-y >= h.
This is a contradiction, so there is no thin gap between a and c, and y = z.
The piece has a square bite taken out of it.

If c reaches the left wall we have w-y = y, giving a shape of order 2.
So we have a gap of w-2y by w-y to fill.

If the gap is less than h across,
neither tab nor face, of length y, can reach down to a, so w-2y is at least h.

All pieces between c and the left wall stand up.
If there are two or more, they create a gap at level h+w-y that can't be filled by a face, as the face of a below is longer.
If d and e stand front to back, the square gap can't be filled by one tab,
order 2, or two tabs, the leftmost piece crashing into the left wall.
If d and e face each other, two tabs imply order 2,
and one tab makes z = h/3.
By assumption, z is more than half of h.
Therefore d is entirely sufficient.
w-y = h+y.

Let d point up the left wall and place e on top of d.
If e is anything other than the reflection of d,
we have a square notch to fill, similar to the notch of a.
This can only be done with tabs, two tabs in fact,
but then the bottom tab isn't long enough to reach across c into d.
So e points down, and f fills the notch of d.
If f stands up its face must fill the double notch perfectly.
This sets w = 3y, yet the height of d is w-2y, setting h = y.
Thus f points right.
If f fills the gap perfectly then 2y = h.
There has to be more room, so slide the tab of g in between e and f.
Now 2y = h + h-y.
y is 2/3 of h.
This establishes the shape, a 7 by 3 rectangle minus a 2 by 2 square.
This is ruled out by trec @fef8f8.
That takes care of c facing left.

	9. y < h, c lies face down in the notch of a

Let c face down in the notch of a.
Since w-y is not y, it's not a perfect fit.
If w-y < y, and c points left, its tab crashes into the left wall.
If c points right, we wonder what to put in the gap between the tabs of a and c.

It can't be one tab, else z = h-z.
It can't be two tabs, else the face of the lower piece crashes into the floor.
If it is a face, then w-y <= z.
h-y <= z, and h-z <= y.
b can't point down unless h-z = y.
Looking across the tab of a, y = w-y + z.
w = 2y - z.
If b perfectly fills the gap, w-y = z, or w = y+z.
y+z = 2y -z.
z is half of y.
This is e0e080, order 28.
If two faces fill the gap, the top piece has the tab of c running toward its notch, whence z >y,
which contradicts y > half of h.
If a tab slides in between b and c, z = w-y + h-z.
thus z = w, which is impossible.
So this piece, call it d, points up, and fills the gap perfectly, whence w-y = z.
Looking at the tab of c, z >= y.
Suppose z > y, and there is a gap between the tabs.
w-y is z and that won't fit.
if one tab fits in then h-z + y is z.
h = 2z - y.
If two tabs then 2h = 3z - y.
h + w-y > y, so d extends well beyond the tab of a, leaving a gap with the floor.
Put a face in this gap, of height w-y, which is z,
and with z >= y, z is more than half of h, and higher than h-z.
The tab of b slides in, and is naturally the proper height.
Is it long enough?
We must exactly fill h+w-2y, or h+z-y.
In other words, h+z-2y = 0.
With one tab between c and d, h was 2z-y.
y = z, but then there is no gap between the tabs of c and d.
Two tabs:2h = 3z - y.
Again y = z.
Therefore there is no gap between the tabs of c and d, and y = z.
Remember that h + z -2y = 0, so h = y, which is impossible.
A face does not sit in the corner of a and c.
That takes care of w-y < y.

With w-y > y, c extends beyond the tab of a,
and b has to slide in along the floor.
If it is the face of b then h-z = w-y and w-y = y+z.
h = 2z + y.
z is less than a quarter of h, and certainly less than y.
c cannot point right; its tab would crash into b.
c points left, and the gap above a is w-2y by h-z.
Clearly a face won't fit, since the span of a is w-y.
With w-2y = z, a piece can't stand up.
The tab of d fills the gap, and h-z = w-2y.
Yet h-z = w-y, whence y = 0.
The face of b does not slide in under c;
it is the tab of b, which is of course the proper height.
2y is at least w-y.
If it is more, then one tab fits into the notch of b, giving 2y = w-y + h-z.

Let c point left, giving a gap of width w-2y above a.
With w-y <= 2y, w-2y <= y.
One tab fills this gap, thus w-2y = h-z.
If c does not completely fill the double notch then h-z = 2y - (w-y).
5y = 2w 
Go back to h-z = w - 2y and replace w = 5y/2, and h-z = y/2.
There is a gap between the tab of c and the face of d.
The tab of e fits this gap perfectly.
e lies atop c, and they are vertical reflections.
If there is no gap between the faces of e and d, then y = z.
y = z = 2h/3.
This is f8e0e0, order 270.
A gap between the faces is filled by a tab.
This gives another gap between faces, filled by a tab, and pieces go up and to the right forever.
Or, write y-z = h-z, whence h = y.

Keep c pointing left, but let it fill the double notch, whence w-y = 2y.
The tab of d still points down onto a, giving h-z = y.
y > z.
The corner of c and d is w-z by w-y.

Put e in this corner.
Let e lie face up atop c.
e extends z squares to the right of c.
Slide the tab of f into this gap.
f is face up, and if there is no gap between the faces then y = z.
That puts y at half of h, so there is a gap of width y-z.
y-z = h-z, or 2(h-z); these are dead ends.

Let e lie face down and find a gap of height z between c and the tab of e.
One tab can't fill this gap, else h-z = z.
Two tabs means f wraps perfectly around c, and h-z = z.

Let e point down onto c.
d and e consume h squares across c.
h = y+z < w = y+y+y.
There is a gap of height y to fill.
Two tabs means f wraps around c, as in the last paragraph.
One tab means f lies face up.
f extends h beyond c.
The gap between b and f is longer than y, and can't be filled.

e stands up in the corner of c and d.
d and e consume h+z squares across c.
This leaves 2y-2z squares of c.
Put f in the corner of c and e.
If f is face up the thin gap between b and f can't be filled.
If f is face down then add up z + h + w-y and subtract w, giving h+z-y.
This is 2z, so if g slides its tab between b and f, y = 2z.
y = 2h/3 and z = h/3.
This is fcfcf0, which fails.
If f points left and wraps around c, then 2z = h.
If f points down and wraps around c, then 2y - 2z = z.
Let f point down onto c, with its back to e.
The span across c is z + h + h-z, or 2h, or 2y+2z.
If f and c are flush then y = 2z.
This is fcfcf0 again.
As y is greater or less than 2z, we have a gap of height y to fill,
to the right of f or to the right of c.
Fill this with the tap of g pointing left.
It's tab is h-z high which is perfectly y.
If next to c then g is face up.
w+y is always larger than 2y+2z, so there is
a gap between f and g, and blocked above by the face of f, thus unfillable.
Put g against f and g can't lie face up,
or the long narrow gap between b and g can't be filled.
g wraps perfectly around c, but then z = h-z.
The last and only orientation for f is standing up along side e.
Compare z+h+h with w, the width of c.
If they are equal then 3z = y.
This puts y at 3/4 of h.
The shape is ff+ff+ff+fc, which fails.
Let f extend beyond c and slide the tab of g under f.
If there is no gap between f and g then z+h+h = w+y, or 3z = 2y.
This is ff+ff+ff+fcfc, which we've seen before.
So there is a gap, filled by the tab of i, but that makes f and c flush again.
Finally suppose f does not make it all the way to the end of c.
3z < y so z is pretty small.
Place g in the corner of c and f.
Face up, and the long gap above b can't be filled.
Same for face down and pointing right.
If g points left it wraps around c, and h-z = z.
Let g point down and face left and wrap around c.
Now z + h + h + z = w, or 4z = y.
This is a 12 by 5 rectangle minus a 4 by 1 rectangle.
In our notation this is ff{c0}ff{c0}ff{c0}ff{c0}ff.
treck can't tile rectangles with polyominoes more than 9 squares across,
however, the first quadrant diagonal test can handle pieces 16 squares across.
This one fails.
If you don't trust the computer, look at e and f.
If they aren't back to back there is a thin gap between them that can't be filled.
So e faces left but then there is a gap above d that can't be filled.
Let g point down and face right.
z + h + h + h-z > w and g extends beyond c, so the tab of i slides under the tab of g.
Again if g meets the face of i then c and f were flush in the first place.
There's a gap between g and i and blocked above by the face of g,
that can't be filled.
g can only stand up, like f and e.
z + h + h + h is of course > 3y and > w, so g goes well beyond c.
Slide the tab of i between b and g.
If the faces of g and i meet then 4z = y, which gives a shape we've seen before.
Leave enough room for the tab of j, and
z + h + h + h + h-z = 4y.
4h can't equal 4y.

Now let's unwind the stack.
That was the last orientation for g, the last orientation for f,
the last orientation for e, the only orientation for d.
and the end of c lying face down in the notch of a and pointing left.

Let c lie down and point right.
Remember that the face of c extends beyond a, and b slides its tab beneath c.
We took care of c having a short face, and b putting its face under c, before.

A gap between b and c is enclosed, so there is no gap. w-y = 2y.

Put d above a and note that d cannot lie face up.

Let d point down; if it fills the gap above a then h-z = w-y = 2y.
h-z < h and 2y > h so this doesn't work.
Nor can we put a piece next to d, so d does not point down.

Let d stand up atop a.
If d fills the gap then h = 2y, which doesn't work.
If e stands next to d then 2h <= 2y, which doesn't work.
e must point down, putting its back against d.
In the notch of d is a z by y gap to fill.
One tab sets h-z = z.
Two tabs causes the left piece to crash into the wall.

The last orientation for d is the vertical reflection of a.
If d wraps perfectly around c, then 2z = h.
This is order 2, so 2z > h, and there is an h-2z gap between c and the tab of d.
Put the tab of e in the gap, with e lying atop c.
2z = h + h-z, or 3z = 2h.
That's the second equation; we still don't know the ratio of w to h.

Put f in the corner of b and c.
If f points left and wraps around b, there is a gap of width 2y along the floor that can't be filled.
If f points down and wraps around b then y = z.
This is fcf0f0, with order 396.

Let f point down onto b.
h-z is h/3, which is less than y,
so there is a gap of height y between b and the face of f.
One tab sets y = h-z, whence y is too small, so put in two tabs.
y = 2(h-z), y is 2/3 of h, y = z, and we're back to fcf0f0.

Let f stand up.
f extends beyond b, and g lies on the floor next to be, under f, pointing right.
f can't extend y squares beyond b, or h >= 2y.
Let i stand next to f.
If they are face to back, there is a z by y notch to fill.
One tab sets h-z = z, and two tabs produces fcf0f0 again.
If they face each other there is a 2z by y gap to fill.
A piece standing up in the gap sets h = 2z.
A piece standing and a tab sets 2z = h + h-z, whence h = z.
A piece lying down sets y = 2z/3.
Since z = 2/3 of h, y is less than half of h.
Put a face in the gap and 2y = 2z.
A face and a tab means 2y + h-z = 2z.
This means 2y = 2h - h.
Two tabs sets h-z = z.
One tab sets h-z = 2z, whence z is only a third of h.
Those are all the choices, so pieces do not stand facing each other.
They must stand back to back,
and it follows that three pieces can never stand next to each other.
So f and i stand back to back.
If i is flush with the face of g then 2h = 3y. This sets y = z, which we already handled.
If i goes beyond the face of g there is a gap of height z,
which we can't fill with one tab, or two.
thus i doesn't quite reach across, and 2h < w.
Well something has to be flush with the face of g, or something has to wrap around g,
or we get that same gap that can't be filled.
If a piece wraps around the face of g then 3y = 2h+y or 2h+z. These give h <= y.
If a tab tries to make a flush edge with the face of g then 3y = 2h + h-z.
y = 7h/9.
This is a 21 by 9 rectangle minus a 7 by 6 rectangle.
Well that's beyond anything trec can handle.
We have to continue by hand.
There is a gap of height 13 between g and j.
It is 7 across on the bottom and 6 across on top.
Try some combinations and you'll see it cannot be filled.
So i doesn't stand next to f.
i can't be horizontal or it goes well past the face of g - unless it is face down and interlocks.
This sets h+y = 3y, which doesn't work.
So i is vertical, and points down.
If i faces left and wraps around g then h+z = 3y. y = 5h/9, which is just above half.
However, there is a thin gap between the tabs of g and i, height h/9, that can't be filled.
So i points down and faces right.
f and i span 4h/3.
This can't go past the face of g, and can't even be flush with
the face of g, since y would be 4/9 of h, which is less than half.
Back up, and let f point down.
f must face right, giving a gap of height y.
One tab or two, y is h/3 or 2h/3, we've seen this before.
f lies face up across b and g, and is flush with the face of g.
If f points left there is another gap of width y, no good.
So f points right.
Now put i in the notch of g.
If i rises above the tab of f we have another gap of width y.
Some exploring will convince you the only orientation for i is face down
pointing right, with j below i interlocked.
If j touches the right wall we have a gap of width y above j,
so things must continue.
g j and i look rather like a b and c.
Put k in the corner of i and j,
and if k is face up pointing right the pattern repeates.
Most of the other orientations lead to contradictions, as we saw with f.
k could wrap around the tab of i; that wasn't possible with f.
This sets h-z equal to z, or y, and those don't work.
Therefore k lies down and points left.
That is the orientation that stops the repeating pattern.
Put l below k pointing right.
Put m on the floor next to l.
A gap of y is not allowed, and m can't point down or face down to wrap around l,
so m points left.
Put n in the notch of l.
If n is face down pointing right, l n m looks like a b c, and we repeat.
n has to do something else.
Specifically, n has to stand up.
If it fills the gap then h = 2y.
If it joins the tab of o to fill the gap then 4h/3 = 2y.
This sets y = z, which we've seen before.

Unwind the stack, and d is not the reflection of a,
this was the last orientation for d, c does not point right,
and c cannot lie face down in the notch of a.

	10. y < h, b points right or faces right

Put b on the floor next to a.
If b faces right or points right there is a gap of width y.
c cannot lie face down in this gap, or point down facing left.
We have ruled those out.
If c points down facing right then it fills the gap, thus y = h-z.
z is less than half of h.
d, above a, can't be the vertical reflection of a, because 2z is not h, and certainly not w.
The face of c is y + h-z off the floor, or if you prefer, 2y off the floor.
If b faces right then 2y >= w, hence w-y <= y.
We need equality, so d can point its tab down onto a.
Now z+y is at least w, but z+y = h, so h = w.
The outline of our shape is a square.
There is a y-z gap between b and c.
A tab of thickness h-z = y won't fit.
Only a face might, if w-y = y-z. That is, h-y = y-z.
Thus 2z = y.
This is e0e080.
That's it for b facing right.

Let b point right, and as we saw above, c points down and faces right.
y + z is still h, and z is less than half of h.
d, above a, can't be the vertical reflection of a, because 2z is not h, and certainly not w.
The face of c is y + h-z off the floor, or if you prefer, 2y off the floor.
There is a y-z gap between b and c.
A tab of thickness h-z = y won't fit.
Only a face might, if w-y = y-z.
So the gap above a is y -z across.
d can't stand up in this gap, and we already ruled out the vertical reflection.
d points down, and y+z is at least w.
But y+z = h, so w = h.
We're back to e0e080.
That's it for b pointing right.

	11. y < h, b faces left

Let b face left.
Again, c points down into the notch of a and faces right.
Either c and b interlock, or the tab of c fills the combined gap of a and b.
Let's consider the latter case.
h-z = w-y,
and h-z = y+z.
z is less than a quarter of h.
d, above a, can't be the vertical reflection of a, because 2z is not h, and certainly not w.
With w-y < h, d can't stand atop a.
d points down onto a, which is consistent with h-z = w-y.
z+y is at least w.
However, z+y is less than h.
That takes care of the rather strange case of the tab of a flush with the face of b.

c and b interlock.
c fills the notch of a, so that h-z = y.
z is still less than y.
The face of c is y + h-z off the floor, or if you prefer, 2y off the floor.
The face of b fills this gap, so that w-y = 2y.
The gap above a is 2y across, which is more than h.
d, above a, can't be the vertical reflection of a, because 2z is not h, and certainly not w.
d can't point down because nothing can fill the gap between d and a.
d stands up, leaving a gap of 2y-h between d and c.
This gap is y-z by 2y.
Nothing is long and skinny enough to fill this gap.
That takes care of b facing left.

	12. y < h, b points left

The last case is b pointing left, creating a double notch that is 2y by z.
c does not lie face down in this gap, or point down and face left.
We have ruled those out.
c can't point down and face right because nothing fills the gap next to c.
Let c stand up, leaving a gap of 2y-h between c and b.
Its neighbor e cannot stand up, since 2h > 2y.
(I'm reserving d for the piece above a.)
A face or a tab fills the gap.
Suppose we put in the face of e, with e pointing left, which means c faces right.
e wraps around the face of c.
z = w-y, and z >= y.
w-y >= y.
The face of e consumes the tab of b and maybe more.
c, of width h consumes more than the tab of a.
They can't both fit.
So let e point right.
h + w-y = 2y.

Assume c faces right.
Across the a b gap, h > w-y.
Going up along the border of c and e, h > w-y.
There is a gap above c of width z.
Put f in the notch of c. This is a face or a tab.
Let f lie face down and point right.
Thus w-y = z.
If there is no gap between e and the tab of f then we have our third equation,
h = w-y + z, or h = 2z. That is order 2.
So there is a gap, and a face won't fit in, since w-y is already z.
It has to be the tab of a piece lying atop e.
2z = h + h-z.
ff+ff+f0f0f0f0, which fails.
Let f lie face down and point left.
If f fills the gap, as it did before, then z = w-y.
y + z >= h, and y >= h-z.
The tab of f pokes past the back of c.
The gap above a has width w-y,
which is smaller than y, and smaller than h.
It is z squares up to the tab of f.
With f poking in, nothing can fill this gap.
thus f does not fill the notch of c, and g slides in between f and e.
If the tab of g, then g faces right, and there are no other pieces in between.
w-y + h-z = z.
Combine this with the first equation and find y = z.
Fine, but y > h-z, and the tab of f still extends beyond c, and we still have the same problem above a.
Put the face of g between f and e,
and 2(w-y) = z.
If there is a gap between e and the tab of g, you might try to put a face in,
but then w-y + z = h + w-y.
If there is a gap between e and the tab of g, you might try to put a tab in,
but then z/2 + z = h + h-z, or 5z = 4h.
This is a new one, an 11 by 10 rectangle minus a 7 by 8 rectangle.
You can analyze it by trec, or note that the tab of f goes well beyond c
and hangs over a.
So there is no gap between e and g, and z/2 + z = h.
h-z = h/3, and the tab of f extends beyond c.
Therefore f puts its tab into the notch of c, rather than its face.
One tab won't work as z would be half of h.
Two tabs makes z 2/3 of h.
The face of f extends beyond c, and the gap above a cannot be filled.
c cannot stand facing right.

Let c stand up and face left.
Let d be the vertical reflection of a.
d wraps around the face of c, 2z = w-y, and z >= y.
w-Y >= 2y.
The face of e fills the whole gap, without room for c at all.

Let d point down onto a.
If the face of c rises above a then d must wrap around c.
y + z = w-y, but w-y < y.
If the face of c remains below the height of a, there is no way to fill the notch of d.
If the face of c is level with a then z = w-y.
The tab of d has to go all the way across, so that h-z = w-y + z.
This is our friend e0e080 again.

Let d stand up atop a.
With h > y > w-y, d goes beyond the face of a.
The face of c must be level with the height of a.
z = w-y.
If there is no gap between d and the tab of c then h = 2z, which is order 2.
No room for a face, so a tab, and just one tab of a piece facing right.
h + h-z = 2z.
trec @ff+ff+f0f0f0f0 fails.

A strange possibility is d lying down across a and c.
Again c is flush with the height of a, and z = w-y.
If d fits exactly then w = 2z.
This sets y = z = h.
If there is a gap then w < 2z, and y < z, and h < z.
That is the end of d, and c facing left, and e face down in b.

e points down into the notch of b and faces right.
h + h-z = 2y, and y >= z.
If there is no gap between b and the face of e then y = z = 2h/3.
If c faces left its face is not flush with the height of a, else w-y = z
and the shape has order 2.
Let d point down onto a.
h-z is no larger than w-y.
c must face right, the tab of d fills the gap above a,
h=z = w-y, h = w, and we have the pentomino e08080, which fails.
Let d be the reflection of a.
If c faces left then d wraps around the face of c, 2z = w-z, giving fcf0f0.
If c faces right then there is a gap between c and e, and the tab of d hangs above this gap so it can't be filled.
Since c and a are not flush, d cannot lie across a and c.
d stands atop a and faces right.
Since a and c are not flush, d cannot extend beyond the face of a.
w-y >= h.
That puts the face of c well above the height of a.
The gap above a is w-y across.
If h   = w-y we have f8e0e0, order 270.
Put f above a in the gap between d and c.
If f has its back to d then the z by z gap in the notch of d can't be filled.
f is face to face with d.
There is only one way to fill this double notch.
g points up and faces left; i points down and faces right; so that h + h-z = 2z.
At the left wall, w-z = 2z, but w-z is at least 2h.
That's it for f, and for d.
Therefore there is a gap between the face of b and the face of e.

No tabs in this gap, since h-z + z is h, which is larger than y.
Put the face of f in this gap, with f pointing down.
Across b, z = w-y.
If f fills the gap then y = 2z, giving fcfcfcf0f0, which fails.
If a second face fits in the gap we have y = 3z.
This yields ffffffffffc0c0, which fails.
Therefore the face of f fills the gap, with f pointing up.
y = z + w-y.
If the face of c is flush with the height of a, then w-y = z,
and we have the same three equations we saw before,
and the same piece fcfcfcf0f0.
The face of c is above or below a, and d, atop a, does not stand up or face up.
Let d lie face down, and let the face of c fill the double notch.
2z = w-y.
This is new, a 10 by 7 rectangle minus a 6 by 2 rectangle,
but the tabs of d and c collide.
If c faces right, the tab of d extends past the tab of c, since y > z-h.
The gap between c and e can't be filled.
Therefore d points down onto a.
If c faces right then w-y = z-h.
This implies y = h.
If c faces left, remember that c and a are not flush.
If c is below a we have gaps that can't be filled.
If c rises above a then w-y = z-h, and we have the same problem.
That's all for d, and filling the gap between b and e,
and e in the notch of b, and c standing up.

We're not quite done; c could lie face up in the double notch of a and b.
It won't be an exact fit, since y is not half of w.
If you add h, you have at least 2h, but the gap is 2y.
Put the face of d next to c in this gap.
If c points left then d points right.
If c points right then d can't point left or the piece has order 2.
Either way d points right, and its tab runs along the face of b.
With c and d we have our first equation: 2y = w + w-y. y = 2w/3.
Since y > w-y, the tab of d extends beyond the end of b.
In fact it extends y/2 or w/3 past b.

Put e on the floor next to b.
e can't point left, unless z is half of h.
e can't put its face under d, since w-y = h, and y/2 = h, making y > h.
e points right along the floor.
The tab of d is flush with the face of e.

Put f on the floor next to e.
Let f face or point right so that the gap in the notch of e has width y.
This is filled with faces or tabs.
Put g in the notch of e.
It can't point left because the tab of d is in the way, and it can't point right without creating a hole.
Suppose the tab of g fills the gap, so that h-z = y.
If g faces left, y >= z + h-z, which is impossible.
g faces right, and the face of g is 2y off the floor.
With w = 3y, f must point right.
With no gap between f and g, h = 2y. This sets 2z = h.
So there is a gap, and a tab won't fit.
Suppose the face of i fits in, with i pointing down.
Across the face of f we find w-y = z.
But y > w-y, so going down the face of f, the tab of i crashes into the tab of f.
Thus i points up, just one face in the gap, and 2y = h + w-y.
3y = w+h, and w = h.
This is our old friend e0e080.
So we need two tabs, g and i pointing down and back to back.
That has g facing left which we already ruled out.
That's the end of f facing or pointing right.

Let f face left.
If the face of f rises above e we have the same gap of y, with the same problems.
The case that is somewhat different is g pointing down and facing right,
and filling the gap of e,
but then w-y must be more than y, when it is only half of y.
The face of f below the tab of e doesn't work at all.
Let e and f be flush, giving a gap of width y+z, which is less than 2h.
h-z = w-y = y/2.
Put g in the notch of e.
As before, g can't lie face down, and can't point down and face left.
Let g point down facing right, whence i fits in the gap of g.
This could only be a tab, with y = h-z, thus y = w-y, which doesn't work.
Let g stand.
The gap is y+z, or 2(y/2) + z, or 2(h-z) + z, or h + h-z.
The tab or face of i, either one having width h-z, fills the gap between g and f.
i can't face left with g standing there.
i can't point left because g would face right, and z = w-y = h-z.
Let i point right.
With no gaps we have z = y.
This is e08080.
With at least one tab in between we have z >= y + h-z.
This is z >= w which doesn't work.
Therefore i points down and faces right.
If g faces right there is a z by y gap to fill.
If g faces left there is a z by z gap to fill.
If one tab fills the gap we have h-z = z.
Two tabs sets 2(h-z) = z, or z is 2/3 of h.
This is again e08080.
That's the end of g standing up in the notch of e.

Let g lie face up across e and f.
If g fits exactly then w = y+z.
This makes z half of y.
h-y/2 = y/2, and h = y.
If there's more room we need one or more tabs or faces,
but we already saw, when g stood up, there was just room for g and one more piece.
w is at least h, so g is square with h = w.
3y/2 - z = y/2.
y = z, and we're back to e08080.
That's the end of g, and f facing left.

Finally f points left, so that e and f look like a and b.
g, in the notch of e,doesn't face down or point down facing left.
If g points down and faces right then i points left and puts its tab in the notch of g.
h-z = y.
Across e and f, h-z + w = w + w-y, hence h-z = w-y.
w-y = y, which is a contradiction.
Let g stand in the notch of e.
g goes beyond e, but doesn't fill the entire gap.
If the tab of i completes it then h + h-z = 2y.
If g faces right there is a z by y gap to fill.
If g faces left there is a z by h-y/2 gap to fill.
One tab never works in this context.
Two tabs sets z = 2/3 of h.
y = z, and we have e08080 again.
One face sets w-y = z, or z = half of y.
z isn't long enough to fill the gap between g and i, so g faces left, and j, in the notch of g, points left.
travel up the face of g, and j, and find w-y + z, or y/2 + y/2, or y.
This is less than h, so j crashes into d.

With g still standing, i lies face down next to g.
If i points left then z = w-y = y/2.
Across g, z < y, so the tab of i crashes into the tab of g.
thus i points right.
h + w-y = 2y.
h is 3/2 of y, as is w.
Whether g faces left or right, there is a z by h-y/2 gap to fill.
One tab won't do, and two tabs creates e08080 again.
If one face fits in then z = w-y = y/2.
This is e0e080.
If two faces fit in then z = y/2 + y/2, and e08080 again.
If we have a face and a tab, z = h-z + w-y = h-z + y/2.
z = y, and it's e08080 again.
That's it for g standing up.

g lies down across e and f, so that e f and g look somewhat like a b and c.
Let i lie face down next to g.
i can't point left or it's order 2.
i points right, and extends beyond f.
In fact this looks just like b and d.
The pattern repeats, but it can't repeat forever,
so assume i points down into the corner of f and g.
This is an orientation we haven't yet considered for d.
It's coming, but when we consider that we won't have our first equation relating w and y.
Let i face left, which means g points right.
h-z = y.
Between the faces of g and i is a y-z gap to fill.
h-z is bigger than y-z, so even one tab is too much.
Two faces is y, also too much.
One face means y/2 = y-z.
This is e0e080.
i faces right, and completes the e-f double notch, so that h-z is half of y.
If there is no gap between the faces of f and i, then y = z.
This is e08080.
The gap is y-z, and since h-z is larger, even a tab won't fit.
A face of w-y sets z to half of y.
h-z is also half of y, h-z = z, order 2.
two faces would equal y, which is too much.
And that is all the possibilities for i, g, f, and e.

As promised, we must consider d pointing down into the corner of b and c.
Let d face left, whence c points right against the tab of d.
h-z = y.
The a-b double notch is 2y across, and c takes up more than half of it, w being greater than y.
The tab of d is h-z, which is y, and there isn't room for this tab.

Let d face right.
Its tab must complete the double notch, thus w + h-z = 2y.
If there is no gap between the faces of b and d then y = z.
w + h = 3y.
With z > h/2,the tab of c stays below the height of a.
There is a gap of width y to fill.
A tab is not enough.
A face can't fill the gap exactly, so it is not enough or too much.
Two faces makes 2w = 3y. Yet w + h = 3y, so w = h.
This is e08080.
Two tabs creats the same shape.
A tab and a face sets w + h = 3y, which is already implied by equations 1 and 2.
If c points left, and e and f fill the notch of c, there is a gap between a and e that can't be filled.
If c points right, h-z + z >= w.
This sets h = w, and we're back to e08080.
Therefore there is a gap between b and d.

This gap is y-z, too small for a tab.
If filled by a face then w-y = y-z, w + z = 2y.
Combine this with equation 1, and h = 2z.
Put in e pointing down and f pointing up.
To cover the face of b, 2z = w-y.
Going up the tab of d, 3z = y.
This creates the impossible situation of h < y.
That's all for d, and c, and b, and a.

Combine {7} through {12}, and we are done with y < h.
Henceforth, y >= h.

	13. y = h and h+z = w.

This shape has order 4.
a points down into the corner,
and b fills the notch of a and points right, into another corner, etc.
The result is a square, w + h-z on a side.

This is a class of shapes.
If h = 1, z can be any real number strictly between 0 and 1.
The square has area 4.
If z is irrational the result isn't even a polyomino, but still has order 4.
For z rational, scale the picture so that z and h are relatively prime integers.
Example: h = 5 and z = 3.
This is ffffe0e0e0.

	14. y=h, Standard Tab Lemmas.

One of the three equations is established at the outset, but there are
more possibilities, such as a piece pointing down onto the floor.
{4} is not in force.

w > h, i.e. the piece is not a square.

Suppose a and b stand up next to each other front to back, or face to face.
Put c face down in the notch of a.
Since z < y, c can't point left.
If a and b are face to face maybe there is room for c to point right,
2z could be larger than w,
but d must slide its face under the tab of c.
w-y = z, which was handled in {13}.
So nothing lies face down in this gap.
If a and b are front to back we only have room for one tab, whence z is half of h,
Or two tabs, whence z is 2/3 of h.
Continue on with a and b facing each other.
If c stands up then c can't fill the gap, else h = 2z.
Two pieces standing make 2h = 2z,
two pieces standing and anything else makes z > h.
So we have c and the tab of d, h + h-z = 2z.
Once again z is 2/3 of h.
Put c in the middle and a tab on either side, but c faces left or right,
and either way there is a z by y gap that would force z = 2h/3.
Across the double notch, 5/3 h can't equal 4/3 h.
If c points down into the notch of a and faces left,
c could fill the double notch, whence z = h/3.
Otherwise put d next to c. We already handled d vertical.
the only other option is d lying down across the gap.
This means w < 2z.
We know w is not y+z.
If we know w is more than y+z, it is more than 2z,
then we don't have to consider a piece lying down in the gap,
with tabs on one side, or the other, or both.

Three vertical pieces in a row imply a z by y gap, or a 2z by y gap.
If w is large enough, this in turn implies z is a third of h or two thirds of h.

Let a and b face right, with b lower than a.
In fact the tab of b could be just a hair above the face of a.
Still there is a gap of width z.
The face of c would imply w-y = z, which is ruled out by {13}.
We have, as we did above, two tabs, and z = 2h/3.
If b is higher than a, whence one wall of the gap is higher than y,
then two tabs can't fit in, because the face
of the rightmost piece crashes into the back of b.

Perpendicular tabs.
Let a be face up and point right anywhere on the board.
Let b point down with its tab on the end of the tab of a.
This gives a gap of width z between a and b.
If c is face down in this gap, then w-y + h-z = y,
or w-y = z, which is handled in {13}.
If b faces right we might try to put two tabs in the gap,
but the face of the right most piece crashes into the back of b.

Look again at a and b face to face, with w small enough where c might lie down inside.
If z is forced to 2h/3, which is not uncommon, the walls consume 2h/3,
and one tab consumes h/3. That leaves only h, and c must be longer than h.
So there are no tabls, and w = 4h/3.
This is f08080, which fails.
Be on the lookout for this situation.

One way to encounter this is to put e in the notch of c, standing up and facing left.
w <= 2z, so w-y < z.
The notch of e forms a gap of width z.
One tab is order 2, and two tabs trips our condition.
You might try to put the face of f in the corner of c and e.
The face can't fill the gap, w-y being less than z, but maybe a tab fills the rest.
w-y + h-z = z, w-z = z, and there is no room for tabs.
Squeezing in two tabs sets z = w-y + y-z + y-z, or w+y = 3z.
w <= 2z, so 2z+y <= 3z, which is impossible.

Let c point right followed by the tab of d.
By perpendicular tabs, d faces right.
Put e in the corner of c and d.
If e is face down and points left it has order 2.
If e is face down and points right, its tab, h above the a-b gap, crashes into d.
Let e stand up.
We already handled e facing left.
If e faces right we have the same gap of width z in the notch of e.
Let e point down into the corner of c and d.
The tab of e can't fill the entire gap, else h-z = y.
Two tabs would set z = h/2.
Therefore c doesn't point to a tab.
We have instead c pointing into the notch of b,
giving a y by z gap in the notch of c.
Let e stand up in this gap.
This gives a gap of width z in the notch of e, as it did before.
This was already discussed.
Put e face down in the notch of c.
If e points right it must fill the gap, whence w-y = y.
Let e point left and its tab must extend beyond the left edge of c.
There are no tabs to the left of c, and w = 2z.
One tab to the right of e sets w-z = y.
Two tabs sets w-y + 2(h-z) = y.
This reaffirms w = 2z.
A second face sets w = 3y/2.
This is fcf0f0f0, which fails.
A tab and a second face sets y = w-y + h-z + w-y.
2y + z = 2w = 4z.
This is f08080 again.
Two tabs and another face: y = 2(w-y + h-z).
2w = y + 2z = 4z. z is half of y which is order 2.
Start with a tab in the notch of c, but can't be 1 tab, or 2 tabs.
Nor a tab and a face, as that gives y = w - z.
Two tabs and a face reaffirms w = 2z, as we saw before.
No room for tabs to the left of c.
These are the combinations, and we cannot have any tabs left of c.
If c lies down in the gap, that is all,
and there are 2 tabs and a face in the notch of c.

	15. y = h and a points down.

Suppose a points down onto the floor, and b points into a.
This doesn't work by perpendicular tabs.
If we want a to point down, b points right, filling the notch of a.
Thanks to {13}, a and b are not flush.
Suppose the face of a extends beyond the face of b, hence z > w-y.
Only the face of c can fill the notch of b,
but this would again set w-y = z.
So the face of b is farther right, giving w-y > z.

Put c in the notch of b.
Start with the unlikely orientation, c points down and faces left.
y > z, so there is a gap.
Put the face of d in this gap, so that z + w-y = y.
Thus w-y = y-z.
There isn't room for d to stand on the face of b.

Let c face right.
This creates a gap of width w-y - z between a and c.
A face isn't long enough to reach down into this gap,
and is also too wide to fit.
Let d point down into the corner of a and b and face left.
y can't equal w-y, so e stands on top of a and interlocks with d.
This sets y = 2w/3.
w-y is half of y, so no room for a piece to stand atop the face of b.
There isn't even room for the face of a and the tab of d, z + h-z.
d can't slide in this way.
Let d point down but face right.
It has to fill the gap, so that w-y = z + h-z.
w-y = y, and that's order 2.
Let d stand up between a and c.
w-y = z+h.
c is lower then d by z, which is less than y.
If d faces right there is a gap of width z, and that brings our third equation, z = 2h/3.
This is fff8f8, which fails.
Let d face left.
Its face is flush with a, giving a h+z by y gap.
w > y+z, so nothing lies down in this gap.
A piece stands up against the left wall, giving a gap of width z, and z = 2h/3, and fff8f8 again.
Perhaps there are more pieces standing between d and c.
Look again at d facing left.
e stands atop a, and the tabs of f and g go in between e and d,
but w-y can't equal y, so e and f can't interlock, and this doesn't work.
d faces right, and e stands atop a.
Yes w-y > z but it could be less than y.
If it is then there is a gap of width z between the tabs of e and d.
This is filled by the tabs of two pieces pointing down, but the leftmost crashes into the left wall.
Thus w-y > y.
If the vertical piece to the right of d creates a gap of width z in the notch of d,
put the tabs of f and g in,
but the face of f crashes into the face of e.
d is face to face with a vertical piece, giving a notch of width 2z.
This could be filled by a piece standing up and a piece pointing down.
If the left piece ppoints down into the notch of d and faces left,
it crashes into the face of e as before.
f stands up and creates a small gap above the tab of d of width h-z.
It's natural to put the tab of i in, since it fits.
If i faces right there is a gap of width z in the notch of e,
two pieces fill it pointing down, and the leftmost crashes into the left wall.
If i faces left it must interlock with e.
w-y = 2y.
That doesn't leave room for two pieces to stand on the face of b.
Try to put a face in the gap, but w-y > z,
and z is 2/3 of h, so z > h-z. The face won't fit.
Now d and its neighbor might have just the tab of f in their double notch, thus z = h/3.
Let e stand atop a, and the face of e rises above d as it did before.
Above d is a gap of width h/3 or 2h/3.
Try to put a face in this gap.
Sinze w-y > z the piece can't point right.
But it can't point left else its tab crashes into the tab of e.
A single tab slides in, with the piece facing left.
This interlocks with e, and w-y = 2y.
There isn't enough fhroom on the face of b for two pieces to stand.
That ends c facing right.

Let c face left.
With w-y > z, the face of c rises above b.
There is a gap above b of width w-y-z, as there was before.
Smaller than w-y, we can't put a face in.
d can't point down into the corner of a and b and face left,
for the same reason as the previous paragraph.
d can't point down into the corner of a and b and face right,
for the same reason as the previous paragraph.
d can't stand up and face left,
for the same reason as the previous paragraph.
d stands in the corner of a and b and faces right.
We can't have another vertical piece between d and c,
for the same reason as the previous paragraph.
That means d is up against c.
d and c are reflections, but d stands z squares above c.
The notch of c is a gap of width z,
and the tabs of f and g point into this gap.
Travel up c and the tab of f, w-y + y.
Travel up the face of b and the face of d, z + w-y.
There is a hole between d and f that can't be filled.
That's it for c standing up.

Let c point right.
Since h > z, c rises above a.
There is a gap above b of width w-y-z, as there was before.
Smaller than w-y, we can't put a face in.
d can't point down into the corner of a and b and face left,
for the same reason as the previous paragraph.
d can't point down and fill the gap above b and face right,
for the same reason as the previous paragraph.
You might think d could point down and f could fill the notch of d
and point right and wrap around c,
but there isn't room for the face of f atop the face of b,
with a and d taking up territory.
d can't stand up and face left,
for the same reason as the previous paragraph.
d stands in the corner of a and b and faces right.
We can't have another vertical piece between d and c,
for the same reason as the previous paragraph.
That means d is up against c.
z + h = w-y.
w > 2y.
If c lies face up, a tab or a face cannot slide underneath c and reach b.
If c lies face down, its face goes beyond the tab of b.
The tab of f slides under c, and f and c interlock.
y + y = w-y.
w = 3y.
Yet w = h+z+y, whence y = z.
That's it for c pointing right.

Let c lie face down and interlock with b, its tab pointing left.
We need room for the tab of c, so w-y >= y+z.
c extends beyond b, creating a gap above the floor that is at least z wide, and h-z high.
A face won't fit, so slide the tab of f beneath c.
It is naturally the correct height.
w-y is greater than y + z, but is no more than 2y.
That leaves a gap above b between a and c that is no more than y-z.
This is too small for a face or a tab or anything.

Let c face down and point left and put its tab in the notch of b.
This is the last orientation.
This means z is less than half of h.
We have a w-y by h-2z gap along the floor.
w-y > z, so a face isn't long enough to reach b.
Slide a tab in, and h-z = h-2z, which is impossible.

With no more choices for c, or b, a does not point down.
We have a traditional corner with a lying down and pointing right.

	16. y = h and a points right.

Put a in the corner pointing right.
Put c in the notch of a.
Let c point down and face left.
Since y > z, there is a gap between a and c.
This can only be filled by the face of d.
y = w-y + z.
w-y = y - z.
There isn't room for d to stand on the face of a.

Let c point down and face right.
This creates a z by y gap between a and c.
Put e in the corner of a and c.
The face of e can't fill the gap, w-y = y.
The face of e can't go in the gap with e pointing down,
the tab of e would crash into the floor.
If the tab of e points left, there is a gap of height z that can only be filled with two more tabs.
The lower of these pieces collides with e.
e fills the gap and points right.
Assume w-y < z.
e presents a gap of height z that is filled by the tabs of f and g.
z = 2h/3.
If e is face down the face of f crashes into the floor.
If e is face up the face of f touches the floor,
but there is a gap between a and f below e that can't be filled.
w-y > z.
If e is face down, the tab of f slides under the face of e.
e and f must interlock, thus w-y + h-z = 2y.
w-y = y+z.
Put one or more pieces in the y+z by w-z gap above a.
If d is the reflection of a then w <= 2z, but w > y+z.
We've seen this gap before above a.
d can't point down, so it stands on a, and that leaves a gap of width z.
Two tabs go in, f and d interlock, and w-y = y.
Finally e is face up.
The gap beneath e is w-z by h-z.
This is longer than y or z, so nothing can fill it.
That completes c pointing down.

Let c stand up and face right.
Put e in the notch of c, lying face up.
This creates a w-z square gap between e and the floor.
b, on the floor next to a, can't be vertical, nor can it point toward a.
b points right, and there is a gap of height w-y-z between b and e.
f goes in this gap, and like b, f points right.
If f is face up, the notch of b presents a gap of height z.
Two tabs fill this gap and the lower piece crashes into the floor.
f is face down, the gap is 2z, perhaps filled by a tab and a blunt end.
z = 2h/3.
The lower piece doesn't point left, else its face crashes into the floor.
The lower piece isn't face up, else these pieces present a gap of height z,
filled by two more pieces, and there is a gap above the floor that can't be filled.
f is face down, and h slides its tab under f, meeting the tab of b.
y + y = w-y.
ff+fcfc, but there is a gap of height 1 between f and e.
So then, the gap formed by b and f is filled by the tab of g, and z = h/3.
Look between g and the floor.
w-z is at least 2y, so a face won't fit in.
Slide a tab in, which means g is face up.
w-y > y, so the tab can't reach all the way to b.
That takes care of e facing up.

Let e point left and put its tab in the notch of c.
This creates a y-z by z gap.
A tab is too big, so put the face of f in this gap.
y-z = w-y.
This creates a w by w - z - h gap above the floor.
Put b on the floor next to a; it must point right.
If e is directly on top of b we have our gap of height z,
and a piece crashes into the floor.
Put g pointing right between b and e, and it is like the previous paragraph.
ff+fcfc, but there isn't room for b g and f below e.

e can't point left with its face in the notch of c, since y > z.

Let e lie face down and point right.
If w-y < z there is a gap of height z in the notch of e.
This is filled by the tabs of f and g, and z = 2h/3 as usual.
If f is the lower piece, there is a gap between c and f of width w-y + y - z.
This is w-z, which is less than y.
The height of the gap, along a and c, is also w-z.
b can't stand up or lie down next to a.
Therefore w-y > z.
e extends beyond c, and there is a gap of height w-z between e and the floor.
As before, b lies on the floor next to a pointing right,
and f lies atop b, facing b.
the shape is forced to ff+fcfc.
This time it almost works.
g slides its tab between f and e.
But it's tab is length 3, and we need a tab of length 4.

Let e stand up in the notch of c, or perhaps, let f point down
into the notch of c facing left, with e standing next to f.
Now e extends 1 or 2 squares beyond c.
The gap is w-z high.
With w-y < w-z, b cannot be vertical.
Assume it points right as before.
g lies atop b as its reflection.
The piece is again ff+fcfc, and again it almost works.
The tab of i slides between g and e.
The tab has length 3, but we need a tab of length 1 or 2.
If the gap has width 2, two more tabs sslide in, and we have a gap of height 1.
This is filled by a tab, and creates a gap of width 1.
This is filled by a tab, and creates a gap of height 1.
This continues up and to the right forever.
The same would happen if our first gap between e and g had width 1.
So b points left, and g stands in the notch of b.
Naturally g faces c.
b and g are reflections of a and c.
In the double notch we have e and f, standing up and pointing down respectively.
z = 2h/3.
Below f is a gap of height w - z.
We've seen this troublesome gap before.
Put i at the bottom of this gap, and i is horizontal.
There isn't room to do this atop a, so f hangs right past g, and i is in the corner of b and g.
w-z cannot equal y, so still there is a gap between i and f.
Put j in this gap.
The gap is w-y-z in height.
This is smaller than w-y, so no face.
A tab fills the gap exactly, giving our third equation,
w-y-z = h-z.
w = 2y, order 2.
j points right, as our piece grows longer.
w is at least 2y + z.
d stands up atop a against the left wall.
This isn't enough so k stands next to d.
They stand face to face, and as we go up the left wall, the shape is forced to ff+fcfc.
w is y + y + z + one more square.
Put the tab of l in between j and f.
This gives a gap of width 2.
Put the tabs of m and n in this gap.
Between l and n is a gap of height 1.
Pieces travel up and to the right forever.
That takes care of e standing up in the notch of c.

Let f point down into the notch of c and face left.
Assume z > h/2, so that the face of f extends beyond c.
We saw this in the last paragraph, although in that case f was hanging right.
There is a gap of height w-z between a and f.
i goes in the corner of a and c, at the bottom of this gap, but i is horizontal, and there isn't room for i atop a.
So z < h/2.
That puts the gap of height w-z on the other side of c.
Whether f faces left or right, we have our familiar gap of height w-z.
b lies on the floor next to a.
Let b point right and place g face to face atop b.
Follow the previous logic and infer ff+fcfc.
That contradicts z < h/2.
So b points left toward a, and g stands in the notch of b, as the reflection of c.
f fills the c-g gap, and z = h/3.
Put e atop c and next to f.
In most orientations, e extends to the left of c and creates a gap of height w-z.
i, in the corner of a and c, is horizontal, and there isn't room.
So e wraps around c or is flush with c.
If e is flush by lying face down, then w-y is h/3 or 2h/3.
The shape is f0f080 or f8f8c0.
These have gaps of width 1 or 2 above a that can't be filled.
Let f face right and let e point down and face right. This is also flush.
2y > w. w-y < y. Nothing can fit above a.
Let f face right and let e point down and face left. This is also flush.
The gap between a and e has height w+y-z.
d stands up in this gap but still leaves a gap of y-z.
A tab won't fit so put a face in pointing up.
This is f8f8c0, which fails.
To wrap around, let e and c interlock. That means f faces left.
Along the left side of c, we are comparing w and y+z. They can't be equal.
The gap for d, in the corner of a and c, is w-(y+z) high.
This can only be the face of d.
z + y + w-y = w.
z = 0.
That completes f pointing down and facing left.

Let f point down into the notch of c and face right.
We already dealt with z < h/2.
z > h/2, and there is a gap of height y in the notch of f.
Put e in the corner of c and f.
e can't face left and point up without creating an unfillable hole.
If e faces left and points down there is a gap of width h-z between c and e.
But no room for a piece to stand beneath e.
Nor can a face reach up to e, since y > z.
From here we run through the same orientations as when f wasn't there.
e is horizontal, and there is a gap of height w-z along a and c.
b is on the floor and g is its reflection, so w-z is at least 2y.
ff+fcfc again.
Slide the tab of i between g and e.
Even if e is face down, we need a tab of length 5, and the tab has length 3.
That's the end of f pointing down.

Finally, e could point down and interlock with c.
Since w-z is not y, the tab of e doesn't reach the floor.
There is a gap of height w-z-y.
Let b face left in this gap.
w - z - y = w - y. z = 0.
Let b point left and let f stand up in the notch of b.
If f faces left it completes the gap.
w - y - z = w-y + h-z. h = 0.
Thus f faces right.
w < w-z, which doesn't work.
Nor can b face right.
Therefore b points right.
If e touches b then w-z = 2y.
The gap above a is y+z wide.
d stands atop a against the left wall and faces right, leaving a gap of width z.
We need two tabs, but c is too tall for these pieces to fit in.
Thus there is space between b and e.
f can't stand up or even face left because the gap isn't tall enough.
f can't point left by perpendicular tabs.
f lies atop b and is the reflection of b.
This implies ff+fcfc.
Traveling up to the notch of c is 7 squares on the left and 9 squares on the right.
That's it for e, and for c facing right.

Let c stand in the notch of a facing left.
Suppose w-y < z.
Two tabs go in the notch of c, but the face of a is so small,
that the left piece crashes into the left wall.
So w-y > z, and c rises above the height of a.

Put d above a and against the left wall.
d cannot be horizontal.
If d points down it interlocks with c.
By the face of c, w-y = z + y.
By the face of a, w-y = h-z.
z = -z, which is impossible.
d points up the left wall.
The face of d is z higher than the face of c.
If d and c touch, there is a gap of width z and height z on the left.
Two tabs in, but the left piece creates a hole with d that can't be filled.
Let e stand next to d.
These must be face to face.
w-y is now at least 2y, and that means d and e have to create ff+fcfc.
e touches c, putting two tabs in the notch of c, and the leftmost piece
crashes into the back of e.
That completes c vertical in the notch of a.

Put d face down atop a, the reflection of a. This can go down two paths,
but the most common is ff+fcfc, which we've seen before.
b is on the floor as the reflection of a,
c is in the double notch, and e puts its tab between c and d.
We have 9 squares across d, then 6 across e.
This will be our base as we climb the left wall.
Let f g and i stand up atop d.
These must face right left and right respectively.
Put j in the corner of e and i.
If j is vertical, one square higher than i,
the notch of i is a gap of width 2.
Put two tabs in, and the rightmost piece collides with,
or creates a hole with, j.
Let j point toward i and put k in the notch of j.
k is now 2 squares higher than i.
Pieces in the notch of i still cause trouble.
Let j point right and put k in the corner of i and j.
k is 4 squares higher than i.
k can't point down and wrap around i, or be vertical at all.
If k points right then tabs fit into the notch of i, and the left piece crashes into the piece that points down into the notch of g.
k points left, and l stands in its notch, and again the notch of i can't be filled.
That's it for 3 pieces standing atop d, so let f lie down on top of d.
Let f point left and put g in the notch of f.
Put i in the corner of f and g, i 2 squares higher than g.
If i is vertical the notch of g can't be filled by tabs without causing trouble.
Let i point left and put j in the notch of i.
If j stands up the notch of g is trouble.
Let j point down and wrap around g.
This seems to work, until you fill the gap of width 2 between j and i.
So i points right, j is in the corner of g and i, and j is 5 squares higher than g.
The only way to avoid the notch of g, of width 2, is to have j point left.
This creates a gap of width 5.
Try a couple of combinations and find this cannot be filled.
Therefore f points right.
If g is horizontal atop f it is face down and points right.
Put i and j in the double notch, and g and j look just like d and e.
The base repeats.
If g points down, and i in the notch of g, the notch of f, of height 2, is trouble.
Let g stand up atop f.
Put i in the corner of f and g.
If i points right or points left face up, the notch of f can't be filled.
Let i point left and interlock with f.
Put j in the corner of g and i, j 1 square higher than g.
j can't be vertical, or the notch of g is trouble.
If j points left, k stands in the notch of j,
2 squares higher than g, and still the notch of g is trouble.
j points right, and k is in the corner of g and j.
k creates a gap in the notch of g, or k points left, and l,
standing in the notch of k, establishes the same notch of g.
Thus i is vertical.
i is face to face with g.
Fill g and i, and a piece extends 1 square to the right of i.
This creates a gap of height 11.
Put j in the notch of f.
If j stands up, there is a gap of height 2.
Two tabs go in, and we have gaps that can't be filled.
Let j point left and let k stand up in the notch of j.
Put the tab of l in the gap of 1 above k.
This creates a gap of width 2 that can't be filled.
Therefore j points right.
Now we have a gap of height 8.
Another piece points right, giving a gap of height 5.
Another piece points right, giving a gap of height 2.
We can't put two tabs in this gap.
Let f stand up atop d, and let g lie face down, filling the rest of d.
i slides its tab under the tab of g.
g is now a gap of width 9.
Put j in the corner of f and g, 3 squares above f.
If j points down and interlocks with f, the resulting gap of width 8 can't be filled.
If j stands next to f, the notch of f is trouble.
If j points left, k goes in the notch of j, and the notch of f is trouble.
Thus j points right.
The faces of f and j are flush.
Put k in the notch of f.
If k lies face up it extends 1 square past the face of j.
This creates a gap of height 2 that can't be filled.
If k is face down the notch of k can't be filled
without creating a hole in the notch of j.
If k faces right the gap between k and the left wall can't be filled.
k faces left, and l interlocks with k going up the left wall.
There are still 5 squares along the face of j.
Put m in the notch of j,
and most of the time you find a gap of width 5 that can't be filled.
You could let l point left and interlock with j, but that gives a gap of width 2 that can't be filled.
That completes the analysis of ff+fcfc when d is face to face with a.

With d still atop a, and remembering that c is horizontal, there is one other path.
The tab of c fills the double notch of a and d, and z = h/3.
If a face slides under c, and c face down,
we have our third equation: w-y = h/3.
This is f0f080, order 4.
If a face slides under c, and c face up,
we have our third equation: w-y = 2h/3.
This is f8f8c0, which fails.
Therefore the tab of b slides under c, which means c is face up.
w-y is not y, so there is a gap between c and b.
This gap is less than y, so two tabs can't fit in.
One tab sets w-y + y-z = y, w-z = y, which is handled in {13}.
A face sets w-y + w-y = y.
This is ff+ff+ff+ff+e0e0, which fails.
The last possibility is a tab pointing down and a face pointing right.
w-y + h-z + w-y = y.
2w = 2y + z.
This is fefefefe8080, which fails.
That completes d and a face to face.

Let c point right, which means c rises above the height of a.
If c is face down, and w-y < z, the notch of c is a gap of height 2 that can't be filled.
If c is face up, and b is on the floor next to a, then w is at least 2y or y+z.
We are back with w > y+z.

We already handled d the reflection of a.
d is not face up.
Let d point down, whence h-z = w-y.
If d wraps around c then z + y = h.
w-y = y, order 2.
Put a tab or face in and z + y = h + h-z. 2z = h.
Put a tab and face in, which is theoretically possible,
and z + y = h + 2(h-z).
z is 2/3 of h.
This is f08080 again.
Therefore d stands up atop a.
w-y is not y, so there is a gap between d and c.
Put e next to d.
There is no room for e to lie down, so e stands next to d face to face.
w-y is at least 2y and certainly greater than y.
d and e push us to ff+fcfc.
c is face down and b interlocks.
When you fill the double notch of d and e, a piece extends one square to the
right of e, and that creates a gap of height 8.
We've seen before that this cannot be filled.
That completes c pointing right.

Let c put its tab in the notch of a, with z < h/2,
so that c rises above the height of a,
and the picture has some similarity with the previous paragraph.
Let d point down onto a, whence w-y = h-z.
y is greater than the tab of c, so there is always a gap.
Put a tab or face in, and z + y = 2(h-z).
z = h/3.
This is f8f8c0, which fails.
Put in a tab and a face, and z + y = 3(h-z).
z is half of h, order 2.
d stands up, w-y is not h, e stands next to d face to face,
w-y > y, and we have ff+fcfc again.
This contradicts z < h/2.

Let c put its tab in the notch of a, with z > h/2.
This time c has to be face up.
b slides a tab or face under c, and w-y < y.
The notch of c presents a gap of width y.
Let d stand up on top of a.
Since w-y < y, there isn't really room, so d hangs over the notch of c.
e stands in this notch, and its face fills the gap.
z = h-z + w-y.
2z = w.
If d touches the tab of e then h = w-y + z.
2h = 3z.
This is f08080.
So there is a gap between d and the tab of e.
Put the tab of f in this gap.
If f faces left then f and d interlock giving order 2.
If f faces right then the notch of d is a gap of width 2,
z = 2h/3, and we're back to f08080.
Put the face of f in the tgap.
With z < y, f must point left and wraps around d.
z = w-y.
Therefore, d does not stand up.
It can't be horizontal, so d points down, and h-z = w-y.
e stands in the notch of c.
e and d must interlock.
z + y = h-z + w-y.
w = y + 2z.
2z = h-z.
z = h/3.
This contradicts z > h/2.

The last case is the face of c in the notch of a, with a and c interlocked.
The tab of c can't crash into the wall, so w-y > y.
Yet w-y <= 2y, so that the tab or face of b can slide under c and reach a.
The gap above a is nonzero, and <= y.
Let d point down onto a, whence h-z = w-2y.
Since y > h-z, there is a vertical gap of height z.
A gap like this takes two tabs, but the face of the lower piece crashes into c.
Therefore d stands up.
The gap is as wide is it can be, namely y. c and d touch.
Since w-y = 2y, the tab of b slides under c and just touches a, with c in the notch of b.
With w-y > y, the face of d rises above c.
Put e in the corner of c and d.
e is h-z above d.
If e points up or faces right, the notch of d is a gap of width z,
2 tabs go in, and the face of the leftmost piece crashes into the left wall.
Since 2y is larger than y + h-z, the tab of e isn't long enough for e and d to interlock.
Thus e is horizontal.
Let e point left.
Since 2(h-z) < 2y, there is a gap of width 3 in the notch of e.
Put f in the corner of d and e.
f must be vertical.
If f faces right then the notch of d is again a gap of width 2, and causes trouble.
If f points down and faces left, trying to interlock with d,
the remaining gap in the notch of e has width z, and causes trouble.
f stands up and faces left.
F stands higher than d, so the notch of d is still a gap of width z.
Therefore e points right.
The face of d is z higher than e.
Put f in the corner of e and d.
Due to the notch of d, f cannot be vertical, nor can it point right.
Put f face down pointing left, trying to wrap around d,
but y > z, so the tab of f crashes into the tab of d.
f points left and is face up, with its tab against d.
h-z is not z, so f and d are not flush.
If f rises above the face of d then the notch of d is trouble.
So the tab of f is below the face of d, and z > h/2.
The notch of f is now a gap of width y.
Put g in the corner of f and d.
No orientation of g will work.

Unwind the stack through f, e, d, c, and a.
The case of y = h is complete.

	17. y>h, Standard Tab Lemmas.

Many of the lemmas of {14} are still in force,
although we don't have {13} to fall back on.

w > h, i.e. the piece is not a square.

Suppose a and b stand up next to each other front to back, or face to face.
Put c face down in this gap.
c can't extend over a wall, since z < y.
If a and b are face to face maybe there is still room for c,
2z could be larger than w, but d must slide its face under the tab of c.
w-y = z.
That's ok, but z < y, so the face doesn't reach c.
So nothing lies face down in this gap.
If a and b are front to back we only have room for one tab, whence z is half of h,
Or two tabs, whence z is 2/3 of h.
Continue on with a and b facing each other.
If c stands up then c can't fill the gap, else h = 2z.
Two pieces standing make 2h = 2z,
two pieces standing and anything else makes z > h.
So we have c and the tab of d, h + h-z = 2z.
Once again z is 2/3 of h.
Put c in the middle and a tab on either side, but c faces left or right,
and either way there is a z by y gap that would force z = 2h/3.
Across the double notch, 5/3 h can't equal 4/3 h.
If c points down into the notch of a and faces left,
c could fill the double notch, whence z = h/3.
Otherwise put d next to c. We already handled d vertical.
the only other option is d lying down across the gap.
This means w < 2z.
This doesn't work, and I'll get to that one below.
So we don't have to consider a piece lying down in the gap,
with tabs on one side, or the other, or both.

Three vertical pieces in a row imply a z by y gap, or a 2z by y gap.
This in turn implies z is a third of h or two thirds of h.

Let a and b face right, with b lower than a.
As long as the tab of b is more than z above the face of a,
we can't put the face of c into the notch of a.
We have, as we did above, two tabs, and z = 2h/3.
If b is higher than a, whence one wall of the gap is higher than y,
then two tabs can't fit in, because the face
of the rightmost piece crashes into the back of b.

Look again at a and b face to face, with w small enough where c might lie down inside.
There is not room for another piece to stand up, w+h compared to 2z.
So c might have tabs pointing down on one side or the other or both.
Let c point right.
Suppose e lies face down anywhere on the tab of c.
The tab of e rides z-h + z = h above the a-b gap.
Suppose e also points right.
The walls are higher than h, and the tab of any vertical piece next to c is higher than h.
The tab of e would crash into this wall.
So e points left.
This creats a hole unless c and e interlock.
Again the tab of e crashes into the left wall or a piece pointing down,
unless y < w-y.
e extends beyond the tab of c on the right.
If a face slides in by a piece standing up we have w+h across.
If a tab slides in we have w+w across.
Either way there isn't room.
So we can forget e lying down anywhere on the tab of c.

Suppose e lies face up on the tab of c.
e extends beyond the tab of c, and once again,
there isn't room for a piece to slide beneath.

If z is forced to 2h/3, which is not uncommon, the walls consume 2h/3,
and just one tab consumes h/3. That leaves only h, yet c must be longer than h.
So there are no tabls, and w = 4h/3.
The tab of c is y, is more than h.
Vertical pieces cover this gap.
Two tabs won't do, so one piece stands up and consumes h.
We need more, but one more tab is 4h/3, which is the entire width of c.
This fails.
Be on the lookout for this situation.

One way to encounter this is to put e in the notch of c, standing up and facing left.
w <= 2z, so w-y < z.
The notch of e forms a gap of width z.
One tab is order 2, and two tabs trips the previous paragraph.
You might try to put the face of f in the corner of c and e.
The face can't fill the gap, w-y being less than z, but maybe one or two tabs fills the rest.
Well now there is a gap of height w-y between the face of c and the tab of f.
Put g in this gap and g travels across the face of c for at least h squares.
With w-y < z, w-y < h, and g crashes into the left wall or any vertical piece next to c.
So e does not stand up and face left.

e in the notch of c and facing right isn't any better.
With y > h, there is some other piece f to the right of e.
They both can't stand up, since 2h > 2z, so f points down.
If f faces left we have order 2.
If f faces right the notch of e implies z = 2h/3.

Let e point down into the notch of c and face left.
Remember that w <= 2z, so w-y < z.
The flag hangs above the face of c and extends to the left of c,
while a left wall or piece rises above the face of c, and encloses a space that can't be filled.
So e faces right, but then we can't put f next to e.
Even if w is less than 2z, c can't lie down in this gap.
We are back to vertical pieces,
and z = h/3 or 2h/3.

	18. y = 2h, and w-y = h.

We have two of the three equations, so you'd think this one is easy,
but it's not trivial.

w-y = h, so it looks like a square with a pole attached.
The only parameter is the thickness of the pole.
Consider these values of z.
z = h/3: ff+ff+e0.
z = 2h/3: ff+e0e0.
z = h/4: ff{f0}ff{f0}ff{f0}f0.
z = 3h/4: ff{f0}f0f0f0.
z = 2h/5: ff{fe}ff{fe}ff{fe}f8f8.
z = 3h/5: ff{fe}ff{fe}f8f8f8.
These all fail.

Anything that leads to one of these values of z can be dismissed.
The first two are the most common.
Pieces can't stand face to face, or front to back, ever,
as that leads to z = h/3 or z = 2h/3.
In general, with w-y = h, any gap of width z,
even with short walls,  is filled with tabs and fails.
A gap of 2z can't be filled with one tab, two tabs, h,
or h with one tab: 2h-z = 2z.
We don't have to test for h and two tabs, since somebody is standing front to back.

Another forbidden gap is h+z or h+2z.
Subtract h and get z or 2z.
Thus a tab is at the left side of this gap.
Subtract h-z for the tab, and get 2z or 3z.
Continue on with 3z, which is still less than w.
If this is filled by a tab facing the other way, then z = h/4.
If a third piece points right then h-z + h = 3z, 2h = 4z, order 2.
So the second piece stands up or points right, but that can't completely fill the gap of 3z.
The third piece can't be a tab pointing down, or the notch of the middle piece is a gap of width z.
The third piece points right, and h-z + h + h = 3z.
3h = 4z.

The next forbidden gap is 2h+z, still less than w.
Subtract h and get h+z, forbidden.
Subtract h-z and get h+2z, also forbidden.

Next consider 2z-h.
If it is positive, it is smaller than h.
Set this to h-z or 2(h-z) and get shapes that are handled.

A gap of h won't work if the walls are higher than h.

A gap of width 2h won't work if one wall is higher than h and the other wall is higher than z.
A tab leaves a gap of h+z.
Two pieces fill the gap.
Both pieces stand up, and we find a gap of z or 2z.

Consider a gap of width 2h where the left wall is higher than h  and the right wall is h-z.
The left piece stands up but the right piece can't.
It points right, hence z > h-z.
The gap is 2z-h, which is forbidden.

Put a on the floor standing up and facing right, and put b next to a.
b cannot be vertical, else the notch of a is a gap of width z.
Let b point left, and put c in the corner of b and a.
c cannot be horizontal, but if it is vertical we have the notch of u again.
Let b point right and put c in the notch of b.
In most orientations, c rises above b, and gives a gap of width h+z.
c cannot point left and interlock with b, since y > h+z.
c puts its tab in the notch of b, with c below the face of b.
Put d in the corner of c and b, and you create the gap of width h+z again.
Therefore a piece does not stand up on the floor.
Nor does a piece stand up in a gap, unless it can face the wall of the gap.

Consider a gap of width 2h + 2z.
If the first piece lies down, subtract 3h and find 2z-h, a forbidden gap.
If the first piece stands up or lies face down, subtract h and find a forbidden gap.
Pieces don't stand at the ends, so they don't stand at all.
Pieces don't lie face down at the ends, so they don't lie face down at all.
It's all tabs, and one piece llying down, since two tabs won't fill the gap.
Let c lie down in the middle, with 1 or 2 tabs on each side.
We can't have 2 tabs on both sides, since c can't point into a tab.
c consumes 3h.
We are comparing 2z-h, with 2(h-z), or 3(h-z).
These all make shapes that have been dismissed.

Consider a gap of width 3h+z or 3h+2z.
If the first piece lies down, subtract 3h and find a forbidden gap.
If the first piece stands up or lies face down, subtract h and find a forbidden gap.
Pieces don't stand at the ends, so they don't stand at all.
Pieces don't lie face down at the ends, so they don't lie face down at all.
It's all tabs, and one piece llying down, since two tabs won't fill the gap.
Let c lie down in the middle, with 1 or 2 tabs on each side.
We can't have 2 tabs on both sides, since c can't point into a tab.
c consumes the 3h.
We are comparing z, or 2z, with 2(h-z), or 3(h-z).
These all make shapes that have been dismissed.

Consider a gap of width 4h+z or 4h+2z.
If the first piece lies down, subtract 3h and find a forbidden gap.
If the first piece stands up or lies face down, subtract h and find a forbidden gap.
Pieces don't stand at the ends, so they don't stand at all.
Pieces don't lie face down at the ends, so they don't lie face down at all.
It's all tabs, and one piece llying down, since two tabs won't fill the gap,
and two pieces lying down is 6h, which is greater than 4h+2z.
Let c lie down in the middle, with 1 or 2 tabs on each side.
We can't have 2 tabs on both sides, since c can't point into a tab.
c consumes 3h.
We are comparing h+z, or h+2z, with 2(h-z), or 3(h-z).
These all make shapes that have been dismissed.

Let a point down to the floor, and put b to the right of a, pointing left.
If a faces right, nothing fits in the corner of b and a.
a faces left, or a could be the left wall.
Put c and d in the tab of b.
c faces right and d points right.
e is on the floor next to b, the reflection of b.
Put f in the notch of e.
If f stands up, the gap is 3h+z or 3h+2z, forbidden.
If f points down, the same thing happens.
Therefore f is horizontal.
Let f point left with its tab against e.
Verify that f cannot be face down.
The tab of f can't reach the height of e.
Let g stand up in the corner of f and e.
This gives the same bad gap of 3h+z.
The same happens if g points down into f.
g is horizontal, and that means g points left and wraps around d.
The remaining gap across c and d is now h+z, still forbidden.
Therefore f points right.
If f is face down we can't fill the y by h gap between the flor and f.
f is face up.
Put g in the notch of f.
If g rises above the face of f, the gap is 4h+z, which is forbidden.
The tab of g can't equal z, and two tabs can't equal z.
Something rises above f, and creates the gap of width 4h+z.
Thus b cannot point towards a.

The corner is now an awkward situation.
a can't point down or point left.
But a can't face right, or lie face up.
The corner doesn't work, and the piece doesn't tile a rectangle.

	19. The Phase Shift Lemma.

The floor on the left is r higher than the floor on the right, where r < w-y, and r < y.
In practice, r is often z, or h-z, or h, so r < y is automatic,
and r < w-y can often be demonstrated.

Assume k on the left and l on the right are both vertical.
Let l point down and face left, hanging over k.
This requires an interlock.
r + w-y = y.
We assume this is not the case, w-y is more than the gap, or doesn't quite fill the gap.
Because of situations to the right, assume l does not point down and face right.
Let k point down and face right, hanging over l.
This requires an interlock.
r + y = w-y.
We assume this is not the case, w-y is more than the gap, or doesn't quite fill the gap.
Because of situations to the left, assume k does not point down and face left.
These pieces stand up.
l cannot face left, due to the notch of l.
l has its back to k.
If we know m stands next to l, as we often do, m cannot face right.
Two tabs would fit in the notch of l, and the leftmost piece would crash into
the back of k, or hang over the notch of k.
m faces l, and we have standard tabs, z = h/3 or z = 2h/3.
If z = h/3 then k faces left, it's notch is too thin to fill.
We'll return to this later.
Let z = 2h/3 and continue.
s can't point down into the notch of l and face left, just as it couldn't before.
Let k face right, and let the tabs of u and v fill the notch of k.
The face of v hangs over the tab of l.
However we fill the double notch of l and m,
the gap of height r between l and the face of v can't be filled.
Thus k and l are back to back.

If we know j stands next to k, as we often do, j cannot face left.
The face of v hangs over the tab of l as it did before.
However we fill the double notch of l and m, the gap of height r can't be filled.
j faces k, and still, the tab of v does not point down into the notch of k.
v stands in the notch of k, facing left or right,
just as s stands in the notch of l, facing left or right.
Let s face left.
Since w-y is not y, s is not flush with the tab of l.
If s is below l, two more tabs fill the notch of s,
and the hole above the tab of l can't be filled.
s rises above l, as it would if it were facing right.
Put x above l between k and s.
If x is face down, which is pretty unlikely, its tab, longer than h,
crashes into v.
So x points down.
x can't face right without crashing into s or making a hole with s.
x points left and hangs over the notch of k.
Since r < y, there is a gap between k and the face of x.
This gap remains no matter how we fill the notch of j and k.
Phase shifted stand up pairs, with thin tabs, can't exist.

Assume the same phase shift, with a pair on each side, and thick tabs,
that is, z = h/3.
The tab of s is in l and m, and s faces right.
The tab of s1 is in j and k.
Put the tab of t between l and s.
If t faces left, the gap between t and s1 can't be filled.
t faces right, but that requires y >= w-y.
(Actually y > w-y, since they can't be equal.)
If y < w-y, phase shifted stand up pairs can't exist.

Next assume y - (w-y) is not w-y.
Put o in the corner of s and t, whence o is horizontal.
Assume there is another pair to the right of m. We often know this.
Let u put its tab into this pair.
v fits between s and u, but v is vertical, and crashes into o.
If y not equal 2(w-y), we can't have one pair on the left and two pair on the right.

Put t1 above k between s1 and t.
Since r < w-y, t1 can't face right.
t1 faces left, the reflection of t standing r higher.
Put o1 in the corner of s1 and t1.
Like o, o1 is horizontal.
Assume there is another pair to the left of j. We often know this.
Apply the reasoning in the previous paragraph, and obtain a contradiction.
If y not equal 2(w-y), we can't have one pair on the right and two pair on the left.

Finally, assume y = 2(w-y) and continue.
o stands up and interlocks with t.
s and o form a wall.
If there are two pair on the left, we can conclude the same thing about o1.
s1, t1, and o1 are the reflections of s, t, and o, but r higher.
There is a gap of width h above t, between t1 and o.
p stands up in this gap.
Then, p1 stands up above t1, between o1 and p.
p1 and p stand back to back.
Go back to u pointing down into the second pair on the right.
v fits between s and u.
If u faces left, then v points down, and the face of v hangs over u.
Assume there is a third pair on the right, which is not unusual.
c, in the corner of u and v, stands up and interlocks with v.
So v and c look like t and o.
d stands on top of v, between o and c.
If d faces right, the gap across the face of p and the tab of o has width h.
The walls have height y.
Something stands in this gap, but it can't face right or left.
So d faces left, and the gap is now h+z.
This is filled by two tabs.
Let the left piece be q.
The face of q coveres half of the tab of p.
The gap between p1 and q has width z, and cannot be filled.
Therefore u faces right, and v stands up.
v faces right.
Between u and the next piece pointing down into the next pair is c.
From the face of u, across v, and possibly the face of c
if c stands up and faces left, is a gap of width h+z or h+2z.
The former is filled with the tabs of d and e.
The latter is filled with the tab of d and e standing up.
So the face of d covers half of the tab of v.
The gap above v between o and d has width z, and can't be filled.
Unwind, and two pair on the left, and three pair on the right, is not workable.

Suppose there are two pair on the right and three on the left.
By symmetry, q1 points down into the notch of p1, and the face of q1
covers half of the tab of p1.
p1 presents a z by r block.
w-y > r, and in practice r is at least z, so w-y > z.
The span of z can never be satisfied.
Let x point left and face down with its tab in the corner of p and p1.
Only 2z of the tab is consumed.
2z + w-y is certainly not w-y + w-y.
Nothing fits in the corner of p and x.
2 tabs canot consume r.
It can only be one tab facing up.
If r is not 2z, this is impossible.
If r is not 2z, two pair on the right, and three pair on the left, is not workable.

Here is another variation: the back of k, and t1, and p1, is the left wall.
If there are 3 or more pair standing, we find a gap of width z
between d and the left wall that can't be filled.

	20. a points down, and b points into a.

Let a point down onto the floor facing right, and let b point left into a.
c, in the corner of a and b, has to face left and fill the gap.
This makes w-y < y.
Specifically, h-z + w-y = y.
This is our first equation.

The gap between c and b is y - h,
or w - y - z.
Since h is less than y, this gap is nonzero.
w-y is strictly between z and y.
A face will never fit into a gap of width z.
w-y-z is less than w-y, so no faces fit in the c b gap.
We have one or more pieces standing up, and perhaps a piece pointing down in the notch of b.
Let d be the piece in the notch of b, and put e in the corner of b and d.
Even if d faces right, the face of d rises above b, so there is a corner to fill.

Let e lie face up.
The gap between the floor and e is y by h.
f fills this gap by pointing right.
Since w-y < y, the notch of f is a gap of height z.
Two tabs fit in and the bottom piece collides with the floor.

Let e point left and face down.
The gap between b and e has width h-z.
This has to be the face of f, whence w-y = h-z.
This implies w-y and h-z are each half of y.
c consumes h across the tab of b, which is more than h-z, and more than half of y.
There is no room for even a tab, no room for d.

The last horizontal orientation for e is face down and pointing right.
The gap between the floor and e is y by h+z.
h+z < y+z, which is less than w, so nothing stands up in this gap.
Put f on the floor next to b pointing right.
The gap between f and e is w-y by z.
This is filled by two tabs, and there is a hole in the notch of f that can't be filled.
Therefore e is vertical.

With y > h, e cannot point down and face left and wrap around b.

With w > y+z, e cannot point down and face left and wrap around d, d facing left.
If d faces right, e and d trap a hole that can't be filled.

Let e point down and face right.
e is z higher than d.
d does not hang over b.
d stands up, and y is at least 2h.
But this isn't enough.
Whether d faces c or e, two tabs fill its notch,
and the rightmost piece crashes into the back of e.
Something is between c and d, and y is at least 3h.
Since w-y + h-z = y, w-y is more than 2h.
This is certainly more than h-z.
Even though e is z higher than d, a face cannot perfectly cover the tab of d and point right.
Let s stand to the left of d, face to face with d.
Put i and j in the double notch, one pointing up and one pointing down.
If i is on the right, it can't point down, or it crashes into e.
i stands up, and j, to the left of i, points down and faces left.
With w-y < y, the notch of i has width z, and two tabs fill the notch of i.
Whether i faces left or right, the rightmost piece hangs over the tab of d.
This creates a hole above the tab of d that can't be filled.
Therefore one tab fills the double notch of d and s.
z = h/3.
Remember that w-y > h-z, so the tab of e does not reach the right edge of b.
Put f on the floor next to b, and note that f cannot be vertical.
That would lead to pieces standing up atop b, the first one interlocked with e.
Let f point left and put g in the corner of f and b.
g cannot be vertical, for the same reasons that f could not be vertical.
Yet g cannot lie face down either, with w-y > y.
Therefore f points right.
The gap between b and e is stil y in height, and more than w-y across.
Put g in the corner of b and e.
Let g lie face down and point right.
The notch of g has height z, and is filled with two tabs.
This leaves a hole in the notch of f that can't be filled.
Let g point left and interlock with f.
h-z + y = 2(w-y).
h-z + w-y + y = 3(w-y).
2y = 3(w-y).
w-y is 2/3 of y and h-z is 1/3 of y.
y is 3 times h-z, but it is at least 3h. This is a contradiction.
Let g lie face up.
Even if the tab of e wasn't there, g would extend beyond the face of f.
The notch of f is a gap of height z.
Two tabs won't work with the floor ahead of f.
g can't stand up under e, or interlock with e (order 2).
That takes care of e pointing down.

e stands up atop b.
Let e face left.
If d points down and faces right then e and d interlock.
y = z + w-y.
h-z + w-y = z + w-y.
h = 2z, order 2.
So d stands up.
Let d face right.
e and d are reflections, but e stands z squares above d.
Two tabs fill the notch of d, but this creates a hole above the notch of e.
Let d face left.
Two tabs fill the notch of e,
and the face of the left piece hangs over and above and past the tab of d.
However we fill the notch of d, or the double notch of d and s,
pieces will collide, or leave a hole above the tab of d that can't be filled.
Therefore e faces right.

The back of e is against d, just as it was when e pointed down.
The same reasoning tells us w-y > 2h, and z = h/3.
Put f on the floor to the right of b.
If f is vertical in any way, there is a gap across b of width w-y - h.
Pieces stand up across the face of b, with perhaps one tab next to f.
w-y is a multiple of h, or a multiple of h + 2h/3.
y is a multiple of h.
Subtract the two, and find a multiple of h, or a multiple of h + h/3.
However, the difference is h-z, which is 2h/3.
This is a contradiction, so f is horizontal.
Let f point toward b. This creates a gap of width y.
Put g in the corner of f and b.
In any orientation of g, we have the same gap across the face of b, and the same contradiction.
Therefore f points right.
Put g in the notch of f.
Let g face right.
Put i in the corner of f and g.
Since w > y+z, i can't point down and face right.
There is no tab.
z + z is even smaller than y + z, so i does not lie face down and point right.
Looking back at a, w is longer than w-y + w-y, so i can't lie down across b and f.
Pieces stand up all the way across b and f.
w-y is a multiple of h, or a multiple of h + half of h.
We can't subtract this from y, a multiple of h, and get 2h/3.
Let g point down and face left.
This time there are definitely no tabs, and the same contradiction.
Let g stand up and face left.
Since y > w-y, i can't point down, face right, and interlock with g.
Since y > z, i can't lie face down and put its tab across the face of g.
Pieces stand up and it's the same contradiction.
Let g point left and interlock with f, so its tab runs across f and onto b.
Now we have to be a bit more specific.
y is an odd multiple of h.
w-y is an even multiple plus h/3.
2(w-y), as in b + f, is an even multiple of h + 2h/3, as realized by a tab pointing down.
This time the tab runs across.
Between d and g, we need an odd multiple of h plus a tab pointing down.
Starting with e, the pieces face right, left, right, left, etc, so that the last piece faces right.
This is followed by a piece pointing down to realize the tab.
The thin gap between these two pieces can't be filled.
Let g point left, and put its tab in the notch of f.
If g is face down the thin gap above the floor can't be filled.
So g is face up.
If i is the reflection of f, enclosing the tab of g,
we are back to b, which has to be a multiple of h plus a third of h, which is impossible.
To avoid our combinatorial contradiction, i must point down and face right.
The vertical gap along i is w-y + h/3.
Needless to say, a face won't work.
j, in the corner of g and i, is horizontal.
The fact that g is face up makes this impossible.
The last orientation for g is pointing right.
If g is face down there is a thin gap between f and g that can't be filled.
g is face up, and rises 2h/3 above f.
i can't lie face down and put its tab across g.
To avoid our contradiction, i points down and face right.
This gives a gap of height y - (h-z), or w-y, which seems promising.
Put the face of j in this gap, and put k in the notch of g.
In every orientation of k, the face of g presents a surface of w-y.
The first h is consumed by j.
From here we need a multiple of h + h/3, which is not possible.
To get around this, j lies down atop g, and is the reflection of g.
Horizontal pieces stack up as they climb the tab of i, until we run into the face of i.
Starting with j, we have a multiple of h.
Below j is 2/3 of h.
At the face of i we might have a tab, another 2/3 of h.
This can't come out to a perfect multiple of h.

Unwind through j, i, g, f, e, d, and c; and b cannot point into the tab of a.

	21. a points down, and b points away from a.

Let a point down to the floor facing right, and put b next to a pointing right.
Since y > h, there is a gap between b and a.

Put c in the notch of b.
Start with c facing right.
The span across b is w-y, and nothing can lie down atop b between a and c.
The face of d fits in the notch of a, giving our first equation, y = h + w-y.
Thanks to d, w-y is at least h.
If c points down, there is a z by y gap above the tab of b.
Put e in the corner of b and c.
e can't be vertical.
Let e point left.
e must be face up, else there is a gap between b and e that can't be filled.
f, in the corner of e and c, has onlyh one possible orientation, standing up and interlocked with c.
h-z + w-y = y, but this contradicts equation 1.
e points right.
Let e be face up.
The tab of f slides under e.
There is a gap of width z between e and f.
This is two tabs, and z = 2h/3.
If the left of these is g, then e and g surround a region that can't be filled.
We might try to stand i up in the corner of e and g, and interlock with g,
but no, there is a z by z hole between the faces of i and g.
So e lies face down.
The tab of b is y across.
c and e are h-z + w-y across.
This comes up short, so there is a gap of height z to fill.
Put two tabs in, and the bottom piece crashes into the floor.
That's it for e, and c pointing down.

Let c stand up.
Again d is in the corner of b and a.
Put e in the corner of b and c.
Let e be vertical, whence z is h/3 or 2h/3.
Suppose e and b are flush.
y = 2h, w-y = h, and that was section {18}.
Thus w-y > h, and y > 2h, and the tab of b goes on.
Let s stand between d and c.
Whether s faces left or right, we have a gap of width z, and z = 2h/3.
The right most piece that fills the notch of s hangs z squares above the tab of c.
Once we fill the notch of c, or the double notch of c and e, this gap above the tab of c cannot be filled.
s faces left, and t stands next to s facing right.
This starts a pattern where pieces stand in face to face pairs.
Thus w-y = qh, where q is odd, y = (q+1)h, and w = (2q+1)h.
Look at the ways you can fill the notch of c, or the double notch of c and e,
with z = 2h/3, i.e. the thinner tabs.
The left piece crashes into d,
or it faces the tab of c and two more tabs fill in and the left piece hangs above the tab of c,
or it has its back to the tab of c making a thin gap with d above the tab of c and another piece hangs over this gap.
None of these work, so z = h/3.
Put the tab of f in the double notch of c and e.
If f faces left there is a thin gap between d and f above c, so f faces right.
Put the tab of g between d and f.
Put the tab of t in the double notch of d and s.
If g faces left the area above d cannot be filled.
g faces right, and the gap between the top of f and the face of g has height h.
Put i in this gap pointing right.
Put k in the corner of b and e, and assume k is horizontal.
The tab of b is (q+1)h, but c and e consume 2h.
This leaves (q-1)h, so even if k is face down we still have to slide the tab of v beneath.
But w + h + h is longer than 2y, so the tab of v won't reach.
Therefore k stands up.
q is at least 3, so the tab of b continues, and using the same reasoning,
l stands up next to k.
They are face to face, and the tab of m fits in the double notch.
n points its tab down between f and m, but then it crashes into i.
That takes care of c facing right.

Let c face left.
Still the face of d fills the gap between b and a.
If c points down, there is a gap between b and c that is h-z higher than the a b gap.
Nothing fills this gap, so c points up.
If w-y < z, the face of c does not reach the height of b.
d extends past the face of b and hangs over the face of c, and the notch of c can't be filled.
Let w-y = z.
The cap across b and c is 2z, which can't be filled perfectly by d.
The thin gap between d and c is 2z-h wide.
We can only put in one tab, thus z = 2h/3.
This is fec0c0, which fails.
Thus w-y > z, and c rises above the height of b.
d stands z above c, and if it's back is against c,
we can't fill the notch of c of width z.
The same for any other piece with its back to c.
If s faces c, its notch is z higher than the notch of c,
and we can't fill the notch of c with two tabs without creating a hole above s.
Let s point down and interlock with c.
This means y+z = w-y, but w-y < y.
Therefore c is not vertical.

Assume c points left and interlocks with b, its tab running along the face of b.
y is not w-y, so y is less.
If there is space between b and the face of a,
it is filled with the face of d as before.
But this makes w-y < y.
Thus the face of a rests on b, and y = h, which was handled in earlier sections.

Keep c pointing left, and put its tab in the notch of b.
Let d lie down atop b, the reflection of b.
y is at least 2h.
The thin tab doesn't work here, so z = h/3.
If c is face down, a tab won't fit beneath, so a face must.
w-y = z, and z > w-y.
this is impossible, so c is face up.
Again, a face below c implies w-y = 2z, and z > w-y, which is impossible.
So the tab of e slides under c.
The gap between c and e is y - (w-y), which is nonzero.
Put the face of i atop c, with i pointing left across d.
The only way we can avoid a gap above d between a and i is if the face of a touches i.
y = 2h and w-y = z.
This is fefe80, order 60.
Otherwise there's a gap, and nothing lies down in this gap, as the tab of i is too thick.
Suppose the face of a still rests on d, so that y = 2h.
The smallest thing that might fit in the gap above d is a tab. This sets w-y = h, {18}.
Put in a piece standing up, and w-y = 4h/3.
This is ff{c0}ff{c0}f0, which fails.
Put in two tabs, and w-y = 5h/3.
This is ff{e0}ff{e0}f8, which fails.
Put in anything more and w-y >= y, which is either order 2, or contradicts e sliding under c.
Therefore y > 2h.
Pieces stand up across d, and the leftmost interlocks with a,
giving y = 2h + w-y.
The gap between c and e is 2h wide.
Let f lie face down in this gap.
This gives w-y = 2h, an 18 by 3 rectangle minus a 12 by 1 rectangle.
trec can't handle this, so let's continue by hand.
j and k stand up atop d, back to back.
Put l in the corner of i and k.
l can't be vertical due to thin gaps, so it lies face up across i.
Let l point left, and put m in the corner of l and k.
m is not horizontal, so m stands 4 squares higher than k.
This creates thin gaps, so l points right.
m, on top of l, is 5 squares higher than k.
There is always a thin gap above the face of k that can't be filled.
Therefore f does not lie down and interlock with e.
f and g stand up in the notch of e, face to face or back to back.
w-y is at least h, for the piece that interlocks with a, and if it is h
we have ff{ff}ff{ff}e0, which fails.
There is more on top of d.
Suppose the parade of vertical pieces atop d ends in a tab at i.
Climb this tab, and there are at least two horizontal pieces on top of i.
These lie face to face, and a tab goes in the double notch,
and that piece crashes into f.
So all the pieces on top of d, from a to i, stand up, and the inner pieces
are in face to face pairs.
w-y, and y, and w, are multiples of h.
We saw what goes wrong when k stands next to i and faces right.
The piece next to i, call it k, faces left.
There are at least 3 pieces atop d, and w-y is at least 3h.
w-y, and y, are odd multiples of h.
k and f form walls, with i as the floor.
Even if f faces left, it rises at least h above i,
then recessed by z and continues up for another y squares.
Let l lie face up atop i.
Whether l points left or right, there is a gap of width y.
An odd number of pieces stand up in this gap, the inner pieces face to face.
If l points right and f faces left, the thin gap next to f can't be filled.
So l points into the back of f or k,
which rises at least y+z above the tab of l.
The piece next to the wall can't face the wall, without creating a thin gap.
Pieces are in pairs, starting at the wall, and ending in a piece in the notch of l that faces toward the face of l.
An odd number of pieces stand on the face of l.
Whether it faces left or right, the piece standing on the face of l,
next to the tab of l, creates a thin gap with the piece that stands in the notch of l.
Therefore l does not lie down atop i.
An evenn number of pieces stand on top of i, and f and g are face to face.
Let l and m be the first pair in this parade.
The tab of n points down between the tabs of l and m.
Next we have o and p, and the tab of q pointing down.
There is a vertical piece between n and q, but we'll get to that later.
Let s stand next to k, and put the tab of t between s and k.
Remember that l stands 2h/3 above k.
If t faces right there is a thin gap between t and l.
t faces left, and the tab of u fits between t and l.
If u faces right there is a gap above the tab of l that can't be filled.
u faces left, and the tab of v points down onto the tab of l, between u and n.
v faces right.
The gap between n and the face of v has height 2h.
Two horizontal pieces fill this gap, pointing right.
The vertical piece between n and q crashes into these horizontal pieces.
This is a contradiction, and it unwinds all the way back to i.
i cannot lie face down on top of c and wrap around d.

Assume i, in the corner of c an d, is horizontal.
f, in the corner of c and e, cannot be vertical, or it crashes into i.
f interlocks with e, giving 2(w-y) = y.
i is face up.
whenever f interlocks with e, g lies down under f pointing right.
The tab of f is flush with the face of g.
If the face of a meets d, we have our third equation, y = 2h.
This is ff+ff+e0 again.
So there is a gap between d and the face of a.
Let i point left, and let j point right and wrap around the tab of i.
There is a gap of width y above d, from a to j.
This is filled by pieces standing up, including the leftmost,
that interlocks with a. 2h + w-y = y.
This is our 18 by 3 rectangle again.
Four pieces stand up atop d, facing left right left right.
Let k be the last of these, next to j.
Put l in the corner of j and k, and l is 3 higher than k.
Because k faces right, l cannot be vertical.
If l points left, we have a single square in the face of k that we can't surround.
l points right, and is flush with the face of k, giving a span of width 7.
Put m in the notch of k; it cannot be horizontal.
That leavs a span of width 5 or 4.
Put n next to m; it cannot be horizontal.
So n stands next to m, leaving a span of width 1 2 or 3.
3 occurs when m and n are both tabs down.
But o can't stand next to n, nor can o be horizontal across l.
A span of 1, a single square, can't be surrounded.
A span of 2 is covered by the tab of o.
m and o point down, and n stands up in between.
Whether n faces left or right, we have a thin gap that can't be filled.
Therefore j does not wrap around i.
No matter the orientation of i,pieces are vertical all along d.
Remember that the bottom of i is h/3 below the top of d.

Suppose the left piece fills the (nonzero) gap between d and the face of a.
If f points right, we have our piece of width 18 again.
Six pieces march along d, ending in k, which faces right.
i cannot be vertical; it is horizontal, which is consistent with f pointing right.
To avoid thin gaps, l lies down on i, face to face, both pointing right.
This leaves a single square in the face of k that can't be surrounded.
Therefore f and g stand up in the notch of e, and i is vertical.
We might not have our shape of width 18 any more, but still vertical pieces march along d.
The last one, k, meets i.
i cannot point down and face left, as there will be a gap between k and i.
Consider the special case of w-y = z. This is our third equation.
This is ffff80, which fails.
Let i face left.
Since w-y is not z, d is not flush with the face of i.
Whether the face of i is above or below, pieces can't march off the end of d.
With k standing next to i, the notch of i is a thin gap that can't be filled.
Thus i faces right.
If k points down, it faces right, and its face hangs over the top of i.
This is the unusual case of w-y < z.
Only another face could fit in this gap, thus 2(w-y) = z.
This is a 14 by 6 rectangle minus a 13 by 2 rectangle.
ff{fc}ff{fc}ff{fc}ff{fc}8080, and it fails.
Pieces stand up along d, and w is a multiple of h.
The last piece can't face the back of i, so the number of pieces atop d is odd.
w is an odd multiple of h, and w-y is a multiple of h plus half of h.
If f faces left, it won't be flush with c.
Starting with i, vertical pieces march along c, and stop at the end of c.
I cannot point down.
I points up; it's last orientation with something in the notch of a.
Pieces stand in pairs, facing right left right left righ,
and ending in a piece that faces right.
This is not compatible with f, whether f faces right or left.
Unwind, and there is no gap between d and the face of a.
y = 2h.

If i is face up, or for any reason f points right,
we have our third equation 2(w-y) = y.
This is ff+ff+e0 again.
So i is vertical, and f is vertical.
Remember that y = 2h, and the gap between c and e is 2h - (w-y).
If f points down it consumes 2z, if f stands up it consumes 3z, or h.
If that isn't enough, g consumes 2z or 3z.
No room for both to stand up.
If they consume 5z, w-y = z.
This is fefe80, which we saw before.
With 3z, or h, we have ff+ff+e0, which we saw before.
With 4z, w-y = 2z.
This is ffffc0, which fails.
Finally we could have 2z, just the tab of f.
This is ff{c0}ff{c0}f0, which we saw before.
that completes d meeting the face of a.
It also completes d lying face down atop b.

Remember where we are, c puts its tab in the notch of b.
Let d lie face up on top of b, hanging over the tab of c.
If c is face down it crashes into the floor.
c is face up, and the hole between c and d can't be filled.
Therefore d stands up and interlocks with a.
y = h + w-y.
If w-y < h then d extends beyond the face of b, and hangs over the tab of c.
If c is face down it crashes into the floor.
If c is face up, then only the face of e could fill the gap between c and d.
z = h-z + w-y.
z = y - z.
If d reaches the tab of e, then h = w-y + z.
this is f88080, which fails.
If there is a tall thin gap between d and e it can only be filled by one tab.
h + h-z = w-y + z.
This is ffc0c0c0, which fails.
w-y is at least h.

Let w-y = h, so that d and b are flush.
A face consumes h, just like a piece standing up.
We still have y = h + w-y, our first equation.
This was handled in section {18}.

w-y > h.
Again, c is face up, and the tab of g slides under c, leaving a gap of h.
e stands up in this gap.
Whether e faces left or right, it rises above c.
The tab of c rises above b, or is below b, but is not flush with b.
Either way pieces march up to, but not past, the edge of the face of b.
These pieces stand up, except the last, which could point down and face right.
Assume k does this, and put l in the corner of c and b or k.
l can't lie down, so it stands up and interlocks with k.
But c consumes less than h of the tab of k, whence w-y will not be enough to reach the face of k.
All pieces atop b stand up.
y and w are multiples of h.
Use the same logic and suppose l points down onto the tab of c and faces left.
k faces right and interlocks with l.
After the face of k, the tab of l still has h remaining,
and would touch the floor, crashing through the tabs of c and b.
Thus l stands up, just as k stands up.
Remember that c and b are not flush.
l is lower than k, or higher than k, by less than h.
With multiple pieces standing on b, and l standing up,
there will be a notch of width z, or a double notch of width 2z, somewhere.
z is h/3 or 2h/3.
Tabs are thick or thin.
The lower piece cannot face the higher piece; the gap of z could not be filled.
Suppose the higher piece faces the lower piece,
or, pieces are back to back,
tabs are thin, and n points its tab into the notch of the higher piece and faces the lower piece,
since n can't put its tab in the notch of the lower piece and face the higher piece.
To illustrate, say k and l face right.
The tabs of m and n fill the notch of k, and the face of n hangs over l.
This is a gap of height 2z-h, or h-2z if l is higher, and k and l face left.
One or two tabs fills the gap.
h-2z = h-z - impossible.
h-2z = 2(h-z) - also impossible.
2z-h = h-z, 2h = 3z, confirming the thin tabs.
2z-h = 2(h-z), 3h = 4z, inconsistent.
k is higher, and the tab of o fills the gap.
This gap exists whether k faces right or left, and the position of o is the same.
o hangs all the way across c, and then h-z farther.
If o is face down then nothing fits in the corner of l and o.
o is face up.
Still, put p in the corner of l and o.
If p points down there is a hole.
If p points left the remaining gap along the tab of l is y - something smaller than h.
Nothing can fit in the corner of l and p.
Thus p points right.
q, below p, can't point down and interlock with l, else its tab crashes into c.
It points right, and all the pieces point right going down the tab of l,
until we reach the face of l.
From there, pieces point right, until the bottom piece interlocks with c.
The tab of that piece crashes into e.
Therefore k and l stand back to back, and if tabs are thin,
the tab of n does not point into the notch of either piece and face the other.
Let s stand to the left of k.
If s faces left, we have thin tabs and n facing right toward l, which we ruled out.
s faces k, giving a double notch.
Suppose tabs are thin.
i stands in the notch of k pointing up.
the tabs of m and n fit into i, whether i faces right or left.
There is a gap of height w-y between the tab of k and the face of n.
With thin tabs, k stands h/3 higher than l.
Any way we choose to fill this gap between k and n,leaves a gap of height h/3 above the tab of l.
This is filled by the tab of o pointing left, as it was before.
Below this is p pointing right.
q, below p, can't point down and interlock with l, else its tab crashes into c.
It points right, and all the pieces point right going down the tab of l,
until we reach the face of l.
From there, pieces point right, until the bottom piece interlocks with c.
this crashes into e, and gives the same contradiction.
Therefore tabs are not thin.
z = h/3.
The tab of c rises above b, and l is higher than k by h/3.
Pieces atop b stand in face to face pairs.
Since k and d face left, there is s next to k facing right.
w-y is an odd multiple of h, and y is an even multiple of h.
Pieces stand up and march along the tab of c in pairs, starting with l.
More pieces stand up and march along the face of c, which is z higher than the tab.
The first piece faces right, and they alternate, so that the last also faces right.
The last stands h higher than e.
Whether e faces left or right, there are thin gaps that can't be filled.
That ends c pointing left.

Put c in the notch of b and let c point right and lie face down.
The face of c is not flush with the tab of b.
suppose w-y < y.
This leaves a gap of height z between b and c.
Nothing can fill this gap, so w-y > y.
The tab of g runs under the face of c to touch b.
The gap of height z between g and c can't be filled,
unless w-y = 2y.
d, in the corner of b and a, is face down, the reflection of b.
This sets z = 2h/3.
e slides its tab between c and d.
Pairs of pieces point right and climb the tab of a.
y is a multiple of h, as is w.
Let i be the last piece that points right, in the notch of a.
Let j point left, in the notch of i.
The face of j rises h/3 above i.
The gap across i is w-z.
This is α.
Put k in the corner of a and i.
k is not horizontal, nor can k point down.
k stands up.
Pairs of pieces march along i, until something happens.
A piece never lies face down and meets j,
since a multiple of h cannot be a multiple of h - z.
The parade of pieces standing up cannot meet j for the same reason.
The last piece, call it l, points down and faces right.
The gap of l has height y-z.
This is β.
Put m in the corner of j and l.
With w-y > y, m is not vertical, and future pieces won't be vertical.
With w-y > y, m does not point left and face down.
m points right.
A parade of pieces points right and climbs the tab of l.
They can't end at the face of l, since a multiple of h is not a multiple of h - z.
The last piece, n, points left.
This creates β, and the pattern goes up and to the right forever.

Let c point right, face up.
Let d lie face down on b, the reflection of b.
This sets z = 2h/3, standard thin tabs.
The tab of e slides between c and d, as e lies face up atop c.
The tabs of i and j fill the notch of c.
The face of i touches the floor, and the hole between b and i can't be filled.
Therefore d stands up and interlocks with a.
y = h + w-y.
Since d rests on b, w-y is at least h.
w-y is not h-z, so a face cannot fit under c.
Therefore, the tab of g slides beneath c, and meets b.
The gap between c and g is 2y-w, or y - (w-y), or h.
If w-y = h we have section {18}.
Thus w-y is somewhere between h and y.
More pieces stand atop b.
Call the right most k, and suppose k points down.
Put l in the corner of c and k.
If l stands up, trying to interlock, there is a hole between l and k.
l is horizontal, and we must fill the notch of c, or the double notch of c and l.
The gap between the tab of c and the face of g can't be filled.
Therefore k stands up.
Every piece on b stands up, and w-y, and y, and w, are multiples of h.
We already saw l is not horizontal.
If l points down, then m lies across the top of c and creates the same problems.
Thus l stands up, h-z higher than k.
Other pieces stand up on top of c, as many as stand on top of b.
Because l stands higher than k, k cannot face right.
d and k, and perhaps others in between, create notches of width z, or 2z,
giving standard tabs, either thick or thin.
Go back to the gap between c and g of width h.
w-y > h, so a face won't fit.
Whether tabs are thick or thin, tabs won't work.
Thus e stands up in this gap.
Whether e faces left or right, it rises above c.
In fact it rises above the face of c.
Put f in the corner of c and e.
Verify that f stands up.
With e lower than f, e faces right.
Since pieces stand on the face of c, nothing can lie down and interlock with c.
A parade of pieces stands on the tab of c, from e all the way to the face of c.
Let s be the rightmost piece on the face of c,
and let t be the leftmost piece on the tab of c.
Verify that t and s cannot point down.
Everybody stands up.
Since t is lower than s, it faces away from s.
Suppose s also faces right, whence the tabs of m and n fill the notch,
and the face of n hangs above t,
or, s faces left, and tabs are thin, and still the tab of n points
into the notch of s and the face of n hangs above t.
The gap has height z.
Two tabs fill this gap.
At least 3 pieces stand on the tab of c, and with horizontal pieces running
overhead, There isn't room for pieces to point down and fill these notches.
s and t are back to back.
If r, next to s, faces left,
the face of n hangs over t, which we have ruled out.
r ande s stand face to face.
If tabs are thin, i and j fill the double notch.
Let i be rightmost, whence i stands up.
With w-y < y, the tabs of m and n fill the notch of i.
The gap between the tab of s and the face of n has height w-y.
Any way we choose to fill this gap between s and n,leaves a gap of height z above the tab of t.
This is filled by tabs pointing left, as it was before,
and leads to the same contradiction.
Therefore tabs are not thin.
z = h/3.
PIeces never stand face to back.
They group together in pairs.
d and k both face left, so something is between.
w-y is at least 3h, and y is at least 4h.
Furthermore, w-y is an odd multiple of h.
Since s faces left, l faces left.
l is only h-z higher than k, which also faces left.
The thin gap between k and l can't be filled.
That is the end of c pointing right.

All orientations of c have been explored.
a does not point down, with b pointing right.
Combine this with {20}, and a piece never points down onto the floor.
This is analogous to {4}.

	22. w-y = h.

As per {2}, {18}, {20}, and {21}, y is not 2h,
and a piece does not lie down or point down onto the floor.

Let a face right, and let b point left to a.
a presents a z by z block which is difficult to surround.
With w-y = h, we can only satisfy z with the tabs of c and d pointing down.
Put e in the corner of b and a.
No orientation works, thus a and b are not face to tab.

Let a face left, and let b point left to a.
Put c in the corner of b and a.
c is not horizontal.
Since w-y > h-z, c does not point down and face left.
Let c point down and face right.
d, in the corner of b and c, has one possible orientation, face down and pointing right.
This sets y = h + h-z.
The tab of e fills the h-z gap between d and the face of c.
e lies back to back on d.
Put f under the tab of d.
f presents a z by z block.
We saw before, this requires two tabs, on the top or the side of the block,
whence z = 2h/3.
This is fee0e0, which fails.

Let c stand up and face left, creating a gap of width z in the notch of c.
This is filled by the tabs of d and e, and z = 2h/3.
The tab of f pointing right fills the gap between a and the face of d.
If f is face down, g, in the corner of a and f, has to point left
and interlock with f. This is fee0e0 again.
Thus f is face up.
The tab of g is not long enough for g to point right and face up.
If g points right and faces down, nothing fits in the corner of a and g.
Therefore g points left.
The gap from the face of a to g has height y-h, and the gap from c to the face of b has width y-h.
Put i below g.
If i points right, its tab completes the gap,
but then we can't fill the space between the floor and i,
or there is more gap, and nothing fits in the corner of a and i.
Thus i points left.
This continus down the tab of a, to the face of a.
y is a multiple of h, more than 2h.
Let k be the bottom piece in this parade.
Put l on the floor below k pointing left.
If k is face down we can't fill the notch of k.
With k face up, we might fill the notch of l with two tabs,
but the bottom piece crashes into the floor.

Let c stand up and face right, the last orientation.
Put d next to c.
y is not 2h, so d does not lie face down.
Let d point down, whence if must face right.
If d completes the gap we have fee0e0 again.
Otherwise e completes the gap by lying face down.
y = h + h-z + h, and of course, z = 2h/3.
This is ff{c0}e0e0, which fails.
So d stands up.
The gap between d and the face of b is y-2h.
We have standard tabs, thick or thin.
Pieces stand in a parade across the tab of b, until the last piece,
call it k, meets the face of b.
If k is face down pointing right, l fits under the tab of k,
but we can't put tabs in the notch of l.
With k vertical, put l in the corner of b and k.
If l is horizontal, we can't fill the space between the floor and l.
l is vertical, and k can't point down.
l rides z higher than k, so k can't face right.
c faces right, and somewhere we have our first face to face pair.
If tabs are thick, it has to be c and d,
and it's face to face pairs thereafter, ending in k.
If tabs are thin, assume d and e are face to face, just for illustration.
i and j fill the double notch, one standing up and the other pointing down.
For illustration, let i stand up on the left, and let j point down on the right.
With w-y < y, let the tabs of m and n fill the notch of i.
The piece left of d, if there is one, can't face d,
and the piece right of e, if there is one, can't face e.
The next piece over has to face the d e complex.
All pieces are in face to face pairs, and y is an even multiple of h.
Remember that l is vertical.
With z < w-y, l can't point down and face left.
If l stands up and faces left, its notch can't be filled
without crashing into the pieces above k.
l has its back to k.
If tabs are thin, the pieces in the notch of k crash into l,
or create a thin gap above the tab of k that can't be filled.
Tabs are thick, and z = h/3.
Put s in the double notch of k and its partner.
s faces left.
Put the tab of t between s and l, and assume t faces left.
The gap between s and the face of t is y-h.
Put u in the corner of s and t.
Since y is not 2h, u can't stand up and interlock with t.
u is therefore horizontal.
There is more than one pair standing on the tab of b.
The next pair also has a piece sticking up, and something stands between that piece and s.
That piece crashes into u.
Therefore t faces right.
The gap between l and the face of t is y-z.
Put m on the flor next to b and verify that m is not vertical.
Let m point left.
If l points down, b presents a z by z block that cannot be surrounded.
Let l stand up and face right.
This presents a z by h+z block.
No collection of pieces equals z.
There is one way to make h+z, two tabs, but that doesn't work in this case.
Therefore m points right.
Let l point down.
This gives a h+z by z block.
Two tabs cover the h+z span, but that isn't possible with the face of l.
Therefore l points up and faces right.
Put n in the corner of m and l, an h by h corner.
It can't be the tab of n, nor can n be face up, or face right.
n is face down or face left.
The double notch is filled by the tab of o.
Let n stand up face to face with l.
The gap between t and o can't be filled.
Thus n points right.
If anything rises above l, the gap above l, next to t, can't be filled.
Put p in the notch of l.
p is not vertical.
p is face up.
Put q in the corner of p and l, and q is not vertical.
p and q point right, with the tab of r between.
o is face up, so that the tab of u can slide underneath.
v is horizontal, between o and r.
x is horizontal, between u and v, next to o.
y is not 2h, so there is a hole between u and x.
Unwind all the way back to c facing right.

A piece on the floor cannot point to a piece standing up.
If b points left, a is horizontal,
and if a points left it can't point to the left wall,
so something to the left of a is horizontal.
This continues until two pieces point to each other.

Put a in the corner, pointing right.
Put b next to a on the floor, also pointing right.
Put c on the face of a.
Because of the face of b, c is not horizontal.
Let c point down.
The face of a presents a z by z block.
Try to cover a span of z with two tabs, but the face of b, or the face of c, makes that impossible.
Therefore c stands up.
This gives a z by h+z block.
We can't put two tabs in the notch of c, because of the left wall.
Put d in the notch of a.
d has no viable orientations, except perhaps pointing down and interlocked with c.
y = h+z, our second equation.
The gap between the tab of d and the face of b is y - (h-z).
Put e in the corner of a and d.
Since h + z cannot equal h + h-z, e does not lie face down.
Let e point down, and let the face of f finish the gap.
The tabs of d and e have the thickness of z, we have thin tabs,
those tabs fill the notch of b, and a piece crashes into the floor.
Thus e stands up.
The gap between e and the face of b is 2z-h.
This has to be the tab of f, and z = 2h/3.
This is ffe0e0, which fails.
Therefore, b does not point right.

We are left with a pointing right and b pointing left.
Again, put c on the face of a.
The only horizontal orientation is c face down, the reflection of a.
This doesn't work with thin tabs, so z = h/3.
Put the tab of d between a and c, and put e in the corner of b and d.
Since y is not 2h, e is not face down.
If e points down and fills the gap, we have ffffe0, which fails.
IF two tabs fill the gap, we have ff{c0}ff{c0}e0, which fails.
Thus e stands up, and y > 2h.
Nothing can lie face down and interlock with b, since we couldn't fill the space on the floor next to b.
Pieces are vertical from e along the tab of b to the face of b.
Let k be the last of these.
If k points down and faces right, put l in the corner of b and k.
l is horizontal, and we can't fill the space between the floor and l.
All pieces stand up, and y is a multiple of h.
l still can't be horizontal, hanging over the floor.
l is vertical, z higher than k, and k cannot face l without creating a thin gap.
k puts its back to l, and now, l puts its back to k.
Suppose e faces left.
The tabs of f and g fill the gap above d and e.
Put i in the corner of c and f.
Remember that i can't point to the left wall.
The only orientation is i pointing right as it lies across c.
Nothing fits in the corner of i and f.
Thus e faces right.
Pieces are in face to face pairs, and y is an odd multiple of h.
If there is just one pair, e and k, we have ff{f0}ff{f0}e0, which fails.
There are at least two pair, and two pieces sticking up from these double
notches, and one piece sticking up between those.
This resurrects the same logic we saw when b pointed to the back of a.
t puts its tab in the corner of k and l, faces right, and hangs over l.
The gap between l and the face of t is y-z.
Put m on the flor next to b and verify that m is not vertical.
Let m point left.
If l points down, b presents a z by z block that cannot be surrounded.
Let l stand up and face right.
This presents a z by h+z block.
No collection of pieces equals z.
There is one way to make h+z, two tabs, but that doesn't work in this case.
Therefore m points right.
Let l point down.
This gives a h+z by z block.
Two tabs cover the h+z span, but that isn't possible with the face of l.
Therefore l points up and faces right.
Put n in the corner of m and l, an h by h corner.
It can't be the tab of n, nor can n be face up, or face right.
n is face down or face left.
The double notch is filled by the tab of o.
Let n stand up face to face with l.
The gap between t and o can't be filled.
Thus n points right.
If anything rises above l, the gap above l, next to t, can't be filled.
Put p in the notch of l.
p is not vertical.
p is face up.
Put q in the corner of p and l, and q is not vertical.
p and q point right, with the tab of r between.
o is face up, so that the tab of u can slide underneath.
v is horizontal, between o and r.
x is horizontal, between u and v, next to o.
y is not 2h, so there is a hole between u and x.
Unwind all the way back to c pointing right.
That's it for c horizontal.

If c points down, the face of a presents a z by z block that can't be surrounded.
Thus c stands up, giving a z by h+z block.
We can't put two tabs in the notch of c, because of the left wall.
Put d in the notch of a.
As before, let d point down and interlock with c.
y = h+z, our second equation.
The gap between the tab of d and the face of b is 2y - (h-z).
This is h + 3z.
Put e in the corner of a and d.
The gap is larger than h, so e does not lie face down.
A tab won't fill the gap, so if e points down,
then the tab of e and the face of f fill the gap.
h + h-z = h + 3z, h = 4z.
This is ff+ff+ff+f0, which fails.
e stands up with its back to d.
We already saw that h does not complete the gap, so there's more.
There is 3z remaining.
f can't point down because of the face of e.
If f completes the gap  then h = 3z, thick tabs again.
This is fefee0, which fails.
f stands up next to e.
We have standard tabs.
The remaining gap is 3z-h.
We saw this was nonzero, so tabs are thin, and 3z-h is the same as h.
This is ffe0e0, which we saw before.
d does not interlock with c, and in fact, d is not vertical.
d is face up, and 2y > w.
Assume d points left, and put e in the corner of d and a, or d and c.
e cannot be horizontal.
But with the notches of c and e at different levels, e cannot be vertical either,
unless, perhaps, e points down and interlocks with c.
y > h, so the tab of e descends below c, and z > h/2.
z + h = y + h-z.
y = 2z.
2y = 4z.
2y - w = 2z-h.
The gap from d to the face of b is 2z-h.
This is less than h, so one tab or two.
z is 2/3 or 3/4 of h.
These are fee0e0, and ff{c0}f0f0f0, which fail.
That's it for e, hence d points right.
The face of c presents a z by z block.
We can't cover the top of this block exactly, so the tabs of e and f  complete the face of c.
z = 2h/3.
The gap from the tab of c to the face of f has width y+z.
Put g in the notch of c.
g is not horizontal.
g does not face left.
If g points down, we can't put anything in the corner of c and g.
Thus g stands up and faces right.
The gap from g to the face of f is y-h/3.
A parade of pieces from g to the face of f is vertical.
In fact the next piece, i, is vertical.
Remember that tabs are thin.
If i faces right, two tabs go in the notch of g,
and the gap between g and the left wall can't be filled.
i is face to face with g.
However we fill the double notch of g and i, the gap between g and the left wall can't be filled.
Unwind from i all the way back to a.

Combine with {18},
and a piece with y > h and w-y = h does not tile a rectangle.

	23. a is face up and b points right.

Put a on the floor facing right, and put b next to a pointing right.
By {22}, a and b are not flush.
Let a be lower than b, that is, w-y < h.
The notch of a is a gap of width z.
Suppose c lies face down in this gap with its tab
resting on and extending past the face of b.
w-y + z = h.
Now the notch of b is a gap of height z.
With y > h, a face isn't going to fit in below the tab of c and reach the face of b.
We have two tabs, and the bottom piece crashes into the floor.
So perhaps c hangs above the face of b.
Put in the tab of d, and d is face up.
Once again two tabs in the notch of b, and the bottom piece crashes into the floor.
Therefore the tabs of c and d satisfy the notch of a, and z = 2h/3.
The gap from the face of b to the face of d is w-h.
Put e in the corner of b and d.
If e is vertical it interlockes with d.
w-h = w-y, yet y > h.
If e is face up, two tabs fill the notch of b, which doesn't work.
The only orientation for e is face down, the reflection of b.
As per c and d, tabs are thin.
Fill the notches of b and e, and something crashes into the floor,
or leaves a hole next to the tab of b.
Unwind, and conclude that w-y > h.

The face of a presents a z by w-y-h block.
w-y can't cover z, so suppose the tabs of c and d point down and cover z.
The gap from b to the face of d is w-h, as it was before.
Put e in the corner of b and a.
If e is vertical it interlockes with d.
w-h = w-y, yet y > h.
If e is face up, two tabs fill the notch of b, which doesn't work.
The only orientation for e is face down, the reflection of b.
As per c and d, tabs are thin.
Fill the notches of b and e, and something crashes into the floor,
or leaves a hole next to the tab of b.
We cannot satisfy the span of width z across the face of a.

Try something exotic, let c point down and interlock with a.
w-y >= h+y.
w is at least 3h.
Assume c touches b. Then w-y = h+y, which is still more than 2h.
Let d point left and interlock with b.
The gap between c and d has width z.
We can't put two tabs in due to the back of c.
Put e in the corner of b and c.
No matter how e is oriented, the b d interlock will no longer be possible.
If e is horizontal, we get in trouble putting two tabs in the notch of b.
So e is vertical.
The next piece is vertical, and the next, until we reach, precisely, the end of the face of b.
There are at least 3 pieces atop b, so we have standard tabs.
Let k be the last piece on the face of b, and put l in the notch of b.
If l is face up, then another tab slides under l, and 2y is at least w, yet w-2y = h.
l can't point left and face down, whether tabs are thick or thin.
Let l point right, face down.
The face of l extends h beyond the tab of b.
Slide a tab under l and find a hole in the notch of l.
Therefore l is vertical.
With w-y > y, l does not point down and face left and interlock with k.
Suppose l points down and faces right.
Put m in the corner of b and l.
m is not vertical, or face up, or face down pointing left.
Let m point right with its face on the tab of b.
Put the tab of n under m.
2y = w-y + h-z.
2y = h+y + h-z.
y+z = 2h.
Try this with z = h/3 and z = 2h/3.
This is ff{f8}ff{f8}ff, or ff{e0}fefe, which fail.
Therefore l stands up.
If k points down then l interlocks with k.
y+z = w-y.
Yet y+z = h+y, a contradiction.
k stands up, and w-y is a multiple of h, plus the tab of c.
With k higher than l, l faces right.
Try the orientations of m that we tried before.
When m points right, face down, we now have 2y = h + w-y = 2h+y, so that y = 2h.
Try this with z = h/3 and z = 2h/3.
This is ff{fe}ff{fe}ff+, or ff{fe}ff+ff+, which fail.
m is vertical.
Apply the phase shift lemma.
With w-y > y, these phase shifted pairs can't exist.
Unwind all the way back to c.
If c interlocks with a, its tab does not touch b.

Put d in the corner of b and a.
If d is vertical, it faces left, and meets c,
whence h + w-y + y = w-y.
That is impossible, so d is horizontal.
The only possibility is face down, the reflection of b.
Thin tabs causes trouble with the floor, so tabs are thick, and z = h/3.
Put the tab of e between b and d, whence e is face up,
and put the tab of f under e.
Now 2y >= w,
yet w-2y >= h.
c does not interlock with a.

Pieces above the face of b must somehow become flush with the face of a.
These pieces are all horizontal.
The first piece atop b, call it c, is face down, the reflection of b.
Thin tabs causes trouble with the floor, so tabs are thick, and z = h/3.
Put the tab of d between b and c, d face up, and the tab of e under d.
y > w-y.
Put f in the corner of d and c.
Suppose f points left, face down, and wraps around c.
The gap between a and f, across c, is w-y, or w-y+z if a and c are flush.
The tab of f is 2z thick, so nothing ever lies down in this gap.
Consider a and c flush, whence w-y = 2h.
The gap is 2h+z.
This can only be filled by two tabs and a piece standing up.
These three vertical pieces always create thin gaps that can't be filled.
Thus the face of a rises above c.
Put g in the corner of c and a.
g is vertical.
Since y > w-y, g and a do not interlock.
However g stands, the notch of a cannot be filled.
Therefore f does not wrap around c.
Every other orientation creats a gap of width w across the back of c, or w+z if a and c are flush.
Let f point down and face left.
The gap has height y-z.
Put g in the corner of c and f.
Suppose g standsa up and interlocks with f.
y - (w-y) = z.
The gap between d and e has width z, and can't be filled.
g is horizontal.
Assume g points right, and put i in the corner of g and f.
The only orientation for i is standing up and interlocked with f.
z + h-z + w-y = y.
The gap between d and e has width h.
That seems good, j can stand up in this gap,
but then the gap between f and j has width z and can't be filled.
Therefore g ppoints left.
Again put i in the corner of g and f.
If i and f interlock, the gap between d and e has width h+z.
This is two tabs pointing down, and still a gap of width z next to f.
Thus i points right and is the reflection of g.
A tab slides in between g and i, and that horizontal piece crashes into a.
Let f point up and face left.
Put g in the corner of c and f.
g is z higher than f.
g is not vertical, due to the notch of f.
If g points right, i, in the corner of g and f, is vertical, and that doesn't work either.
g points left as before.
i, in the corner of g and f, can't be vertical.
g and i lie face to face, and create the same contradiction as before.
Lef f face right.
Now the back of f creates a straight wall of height w-z.
Put v in the corner of e and d.
Verify that v is not vertical, due to the notch of f and/or the notch of v.
v is horizontal, and that means the face of v fills the gap.
2(w-y) = y.
Put g in the corner of c and f.
If g points down, i, in the corner of c and g, has no valid orientations.
Let g stand up and face left.
i, in the corner of c and g, can only stand up facing g.
This continues, as pairs of pieces stand up atop c.
Let k be the leftmost in this parade.
This is the only piece that might point down.
If a and c are flush, we have our third equation, w-y = 2h.
This is the 18 by 3 rectangle minus the 12 by 1 rectangle.
We've run across this before.
There are six pieces standing on d.
k has to face right, and that leaves a gap of width z between a and k.
So a rises above c.
With y > w-y, k does not point down and interlock with a.
k stands up, and w is a multiple of h.
Whether k faces left or right, the notch of a can't be filled.
Unwind back to f, which can no longer be vertical.

v is, as it was before, face down in the gap between d and e,
and our second equation, y = 2(w-y), still holds.
f is face up along d and the back of v.
Suppose a and c are flush, giving our 18 by 3 rectangle again.
Let f point left, and let g lie face down on d and wrap around f.
The gap from a to g has width 13.
This is three pieces standing and two tabs.
The tabs are at either end.
Somewhere there is a gap of width z that can't be filled.
If g is not in this position the gap from a to f has width 19.
This is five pieces standing and two tabs.
The tabs are at either end.
Somewhere there is a gap of width z that can't be filled.
Thus a rises above c.

Put g in the corner of c and a.
Because of the notch of a, g can't be vertical.
g is face up, and the face of a rises at least as high as g.
Put u on the floor under v pointing right.
Let g point right and put i in the notch of g.
i can't interlock with g, else the tab of i crashes in to a.
i can't point down and face left, else nothing fits in the corner of g and i.
If i faces right, or points right, put k in the corner of g and i.
k is vertical.
k begins a parade of vertical pieces standing on the face of g.
If a rises above g, we can't fill the notch of a.
a and g are flush.
This is a 27 by 3 rectangle minus an 18 by 1 rectangle.
The gap across the face of a and the face of g is 10.
This is two pieces standing face to face and two tabs.
k points down and faces right.
The gap along k has height 16.
This could be filled by 4 pieces pointing right and two tabs.
But the piece lying above i can't point left.
Let something interlock with k, so the gap is now 7.
This is a piece pointing right and 2 tabs, which doesn't work for the same reason.
The last orientation for i is pointing left.
If k is still vertical, the gap along k is now 17.
This is 5 pieces pointing right and a tab.
Since the number of pieces is odd, there is a thin gap that can't be filled.
If something interlocks with k, the gap is now 8.
This is a pair of pieces pointing right and a tab.
Call the pair l and m, with the tab of n between.
i is face down.
f points left.
The remaining gap along the tab of f is 9 by 4 or 5, depending on whether n faces up or down.
Well n has to face up, and o interlocks with f.
o extends beyond f and hangs over v.
p is between v and o, and points right.
If p is face down, the gap from u to v has height h+z.
This is two tabs, which doesn't work with the floor.
p is face up, and q is in the notch of u pointing right.
q creates a thin gap, whether it is face up or face down.
Therefore, k has to do something new, and it can.
k lies face down atop g, and its tab runs along the tab of i.
w-y is at least 4h.
This is a second pair climbing up the face of a.
If there is a third pair, we have the phase shift lemma.
If not, some of the machinery from that lemma should be familiar.
e v and u is what we use to call t o and p.
Let i face down, whence f points left.
Put j in the corner of i and f.
If there was a third pair climbing the face of a, j would have to be horizontal,
and we know that causes trouble.
Let's do it anyways.
j interlocks with f.
q fits next to f between j and v.
If q is face up, we can't put anything between u and q without making a thin gap.
q is face down, and two tabs slide in.
The bottom piece has a gap of height z with the floor,
just as the left piece had a gap of width z against p1 in the phase shift lemma.
Sure enough, j is vertical, and we're not going to have a third pair.
There is a gap along i of width w-y between k and j.
This is filled by a parade of pieces standing up.
Suppose this parade ends in a tab.
Nothing can stand on k and interlock.
There is at least one pair of pieces on top of k pointing left.
Another piece puts its tab in the double notch, and that piece crashes into a.
Therefore, w-y is a multiple of h.
w is a multiple of h.
Pieces stand up along the back of k, and end at the edge of k.
Or, x lies on top of k, and pieces stand up along the tab and face of x, and endat the edge of x.
The notch of a can't be filled.
Next let i face up, which means f points right.
This also recapitulates the phase shift lemma.
Put j in the corner of i and l.
Let j be horizontal, as a third pair would force.
From the face of f, along i, and possibly the face of j
if j points right and faces down, is a gap of width h+z or h+2z.
The former is filled with the tabs of q and r.
The latter is filled with the tab of q and r pointing right.
So the face of q covers half of the tab of f.
The gap between v and q has height z and can't be filled.
As expected, j is vertical.
If two horizontal pieces stand up on top of k, there is a double notch,
and the piece that fills that notch crashes into a or j.
At most one piece lies atop k, and we will call that piece x.
Assume x is not there.
Pieces stand up and march along the back of k.
They can't end at the edge of k, else the notch of a can't be filled.
They continue on and fill the notch of a.
w is a multiple of h + 2z.
w is a multiple of 3z, plus 2z.
w-y is a multiple of z, plus 2/3 of z.
This is a contradiction, so x is present.
At the face of x, where we have a phase shift of z, a piece cannot point down,
because we can't perform the necessary interlock.
Thus pieces march along from j, to the left, along the tab or face of x.
This is a multiple of h.
Pieces continue and then stop at the end of x.
The notch of a can't be filled.
Unwind through j, k, i, and g pointing right.

g points left, and that marks the top of the face of a.
That is our third equation.
The shape is a 24 by 3 rectangle minus a 16 by 1 rectangle.
The gap across a and g is 17.
This is 5 pieces and a tab.
The tab is at the left, across a and g, then two pairs, then k standing up and facing right.
Put l in the corner of g and k.
Due to the notch of k, l is not vertical.
l extends 16 beyond the end of g.
If f points left, the region between f and l can't be filled.
f points right, and is z below g.
At this point l puts its face on the face of g and points right,
so that the gap between f and l has height 2z.
The tab of m goes in this gap, but whether m faces up or down,
the notch of f can't be filled.

Hereinafter, we don't have to consider a piece facing right on the floor,
followed by a piece pointing right.

I'll continue this theorem as time permits, or you can continue my work.
Please review this theorem and send along any corrections.
If you wish, clean it up, improve the explanations, and add pictures for clarity.

