/*********************************************************************
Pack the 107 simply connected heptominoes into a really long stripe.
*********************************************************************/

#include <stdio.h>
#include <stdlib.h>
#include <ctype.h>

#define DEBUG 0
#define PERFORM 0

/*********************************************************************
First solution under the current algorithm.
21.3 seconds

BbbeiiikkkmFFFFFCCssdddDDxxJJJJJubbbOOOOAAwwPPPvvvEEEEEEkkLLLLjjwwwwqDDDDpuuuuxxxWzzzQQnnMMMMJYYYYVVVRRGGGG
BhbeeeiiikmFmmKFKCCsssddDDxxxJJuuubbbbAOOAAwwPnvnvvvEXqqkkkkLLjjjjwwqqqqDppppuxWWWWWzQQQnnMooJYYKYVVRRRIGdG
BhbbbeikkkmmmKKKKKCCsddllDDDxxRuzuurAAAAOvAAwPnnnhXXXXXqqqkVLttjttlwqWWqDDpUpuxxfWHHzQQnnMMoJJJJKVVrRRIIGdd
BhhbaeecccfffgIIIIICslllppRRRRRzzrrrAEPPPvAwwPnTnhhhhXqqSVVVVVtttillllWWUUUUUuxffffHzzSmntoooJKKKKrrrrBIIId
ByhaaaccOcfgfgjjjIILLlpppooRozzzrrBrAEPPNvvvvPQTTTTThhSSSSSgVCiiiieellWWMUssEEffTTFHHHSmmttoYXXXZKrUUrBINNd
ByhhyaacOffgggjLLLLLClpHpHooozaaaBBBEEPPNvQQQQQDTZZZZcSccggggCCGiiGeeeeWMssssETTTFFHSSSmtttYYYXXZZZUUUBBNdd
ByyyyaOOOOOgjjjCCCCCCHHHHHoaaaaBBBEEENNNNNQDDDDDDZZZccccggCCCCGGGGGeMMMMMsEEEETTFFFFSSmmmtYYYXXZZZUUBBBNNNN
*********************************************************************/

/* power of 2 for efficiency */
static char board[109][16];

static char shapes[][16] = {
{1,0,1,0,2,0,3,0,4,0,5,0,6}, // row 7
{1,1,0,2,0,3,0,4,0,5,0,6,0},
{2,0,1,0,2,0,3,0,4,0,5,1,5}, // row 6
{2,0,1,0,2,0,3,0,4,0,5,1,0},
{2,1,0,1,1,1,2,1,3,1,4,1,5},
{2,1,0,1,-1,1,-2,1,-3,1,-4,1,-5},
{2,0,1,1,0,2,0,3,0,4,0,5,0},
{2,1,0,2,0,3,0,4,0,5,0,5,1},
{2,1,0,2,0,3,0,4,0,5,0,5,-1},
{2,0,1,1,1,2,1,3,1,4,1,5,1},
{3,0,1,0,2,0,3,0,4,0,5,1,4},
{3,0,1,0,2,0,3,0,4,0,5,1,1},
{3,1,0,1,1,1,2,1,3,1,4,1,-1},
{3,1,0,1,-1,1,-2,1,-3,1,-4,1,1},
{3,1,0,2,0,3,0,4,0,5,0,1,1},
{3,1,0,2,0,3,0,4,0,5,0,4,1},
{3,1,0,2,0,3,0,4,0,5,0,1,-1},
{3,1,0,2,0,3,0,4,0,5,0,4,-1},
{4,0,1,0,2,0,3,0,4,0,5,1,3},
{4,0,1,0,2,0,3,0,4,0,5,1,2},
{4,1,0,1,1,1,2,1,3,1,-1,1,-2},
{4,1,0,1,-1,1,-2,1,-3,1,1,1,2},
{4,1,0,2,0,3,0,4,0,5,0,2,1},
{4,1,0,2,0,3,0,4,0,5,0,3,1},
{4,1,0,2,0,3,0,4,0,5,0,2,-1},
{4,1,0,2,0,3,0,4,0,5,0,3,-1},
{5,0,1,0,2,0,3,0,4,1,0,1,4}, // row 5 side 1 stray 1
{5,1,0,1,1,1,2,1,3,1,4,0,4},
{5,0,1,1,0,2,0,3,0,4,0,4,1},
{5,0,1,1,1,2,1,3,1,4,1,4,0},
{6,0,1,0,2,0,3,0,4,1,0,1,3},
{6,0,1,0,2,0,3,0,4,1,1,1,4},
{6,1,0,1,1,1,2,1,3,1,4,0,3},
{6,1,0,1,1,1,2,1,3,1,-1,0,3},
{6,0,1,1,0,2,0,3,0,4,0,3,1},
{6,1,0,2,0,3,0,4,0,1,1,4,1},
{6,1,0,2,0,3,0,4,0,1,-1,4,-1},
{6,0,1,1,1,2,1,3,1,4,1,3,0},
{7,0,1,0,2,0,3,0,4,1,0,1,2},
{7,0,1,0,2,0,3,0,4,1,2,1,4},
{7,1,0,1,1,1,2,1,3,1,4,0,2},
{7,1,0,1,1,1,2,1,-1,1,-2,0,2},
{7,0,1,1,0,2,0,3,0,4,0,2,1},
{7,1,0,2,0,3,0,4,0,2,1,4,1},
{7,1,0,2,0,3,0,4,0,2,-1,4,-1},
{7,0,1,1,1,2,1,3,1,4,1,2,0},
{8,0,1,0,2,0,3,0,4,1,0,1,1},
{8,0,1,0,2,0,3,0,4,1,3,1,4},
{8,1,0,1,1,1,2,1,3,1,4,0,1},
{8,1,0,1,1,1,-1,1,-2,1,-3,0,1},
{8,0,1,1,0,2,0,3,0,4,0,1,1},
{8,1,0,2,0,3,0,4,0,3,1,4,1},
{8,1,0,2,0,3,0,4,0,3,-1,4,-1},
{8,0,1,1,1,2,1,3,1,4,1,1,0},
{9,0,1,0,2,0,3,0,4,1,1,1,2},
{9,0,1,0,2,0,3,0,4,1,2,1,3},
{9,1,0,1,1,1,2,1,3,1,-1,0,1},
{9,1,0,1,1,1,2,1,-1,1,-2,0,1},
{9,1,0,2,0,3,0,4,0,1,1,2,1},
{9,1,0,2,0,3,0,4,0,2,1,3,1},
{9,1,0,2,0,3,0,4,0,2,-1,3,-1},
{9,1,0,2,0,3,0,4,0,1,-1,2,-1},
{10,0,1,0,2,0,3,0,4,1,1,1,3},
{10,1,0,1,1,1,2,1,3,1,-1,0,2},
{10,1,0,2,0,3,0,4,0,1,1,3,1},
{10,1,0,2,0,3,0,4,0,1,-1,3,-1},
{11,0,1,0,2,0,3,0,4,1,0,1,-1},
{11,0,1,0,2,0,3,0,4,1,4,1,5},
{11,0,1,1,1,1,2,1,3,1,4,1,5},
{11,0,1,1,0,1,-1,1,-2,1,-3,1,-4},
{11,1,0,1,1,2,1,3,1,4,1,5,1},
{11,1,0,1,-1,2,-1,3,-1,4,-1,5,-1},
{11,1,0,2,0,3,0,4,0,4,1,5,1},
{11,1,0,2,0,3,0,4,0,4,-1,5,-1},
{12,0,1,0,2,0,3,0,4,1,0,2,0}, // row 5 side 1 stray 2
{12,0,1,0,2,0,3,0,4,1,4,2,4},
{12,1,0,2,0,2,1,2,2,2,3,2,4},
{12,1,0,2,0,2,-1,2,-2,2,-3,2,-4},
{12,1,0,2,0,3,0,4,0,4,1,4,2},
{12,1,0,2,0,3,0,4,0,4,-1,4,-2},
{12,1,0,2,0,3,0,4,0,0,1,0,2},
{12,0,1,0,2,1,2,2,2,3,2,4,2},
{13,0,1,0,2,0,3,0,4,1,1,2,1},
{13,0,1,0,2,0,3,0,4,1,3,2,3},
{13,1,0,2,0,2,1,2,2,2,3,2,-1},
{13,1,0,2,0,2,-1,2,-2,2,-3,2,1},
{13,1,0,2,0,3,0,4,0,3,1,3,2},
{13,1,0,2,0,3,0,4,0,3,-1,3,-2},
{13,1,0,2,0,3,0,4,0,1,1,1,2},
{13,1,0,2,0,3,0,4,0,1,-1,1,-2},
{14,0,1,0,2,0,3,0,4,1,2,2,2},
{14,1,0,2,0,2,1,2,2,2,-1,2,-2},
{14,1,0,2,0,3,0,4,0,2,1,2,2},
{14,1,0,2,0,3,0,4,0,2,-1,2,-2},
{15,0,1,0,2,1,1,2,1,3,1,4,1}, // row 5 side 2 stray 1
{15,1,0,2,0,3,0,4,0,4,1,4,-1},
{15,1,0,1,1,1,2,1,3,1,4,2,0},
{15,1,0,1,-1,1,-2,1,-3,1,-4,2,0},
{16,0,1,1,1,2,1,3,1,4,1,4,2},
{16,0,1,1,0,2,0,3,0,4,0,4,-1},
{16,1,0,1,1,1,2,1,3,1,4,2,4},
{16,1,0,1,-1,1,-2,1,-3,1,-4,2,-4},
{17,0,1,1,1,2,1,3,1,4,1,3,2},
{17,0,1,1,0,2,0,3,0,4,0,3,-1},
{17,1,0,2,0,3,0,4,0,4,1,1,-1},
{17,1,0,2,0,3,0,4,0,4,-1,1,1},
{17,1,0,1,1,1,2,1,3,1,4,2,3},
{17,1,0,1,-1,1,-2,1,-3,1,-4,2,-3},
{17,1,0,1,1,1,2,1,3,1,-1,2,3},
{17,1,0,1,1,1,-1,1,-2,1,-3,2,-3},
{18,0,1,1,1,2,1,3,1,4,1,2,2},
{18,0,1,1,0,2,0,3,0,4,0,2,-1},
{18,1,0,2,0,3,0,4,0,4,1,2,-1},
{18,1,0,2,0,3,0,4,0,4,-1,2,1},
{18,1,0,1,1,1,2,1,3,1,4,2,2},
{18,1,0,1,-1,1,-2,1,-3,1,-4,2,-2},
{18,1,0,1,1,1,2,1,-1,1,-2,2,2},
{18,1,0,1,1,1,2,1,-1,1,-2,2,-2},
{19,0,1,1,1,2,1,3,1,4,1,1,2},
{19,0,1,1,0,2,0,3,0,4,0,1,-1},
{19,1,0,2,0,3,0,4,0,4,1,3,-1},
{19,1,0,2,0,3,0,4,0,4,-1,3,1},
{19,1,0,1,1,1,2,1,3,1,4,2,1},
{19,1,0,1,-1,1,-2,1,-3,1,-4,2,-1},
{19,1,0,1,1,1,-1,1,-2,1,-3,2,1},
{19,1,0,1,1,1,2,1,3,1,-1,2,-1},
{20,1,-1,1,0,1,1,1,2,1,3,2,2},
{20,1,-1,1,-2,1,-3,1,0,1,1,2,-2},
{20,1,0,2,0,3,0,4,0,1,1,3,-1},
{20,1,0,2,0,3,0,4,0,3,1,1,-1},
{21,1,-1,1,0,1,1,1,2,1,3,2,1},
{21,1,-1,1,-2,1,0,1,1,1,2,2,1},
{21,1,-1,1,-2,1,-3,1,0,1,1,2,-1},
{21,1,-1,1,-2,1,0,1,1,1,2,2,-1},
{21,1,0,2,0,3,0,4,0,1,1,2,-1},
{21,1,0,2,0,3,0,4,0,2,1,1,-1},
{21,1,0,2,0,3,0,4,0,2,1,3,-1},
{21,1,0,2,0,3,0,4,0,2,-1,3,1},
{22,1,-1,1,-2,1,0,1,1,1,2,2,0},
{22,1,0,2,0,3,0,4,0,2,1,2,-1},
{23,1,-1,1,0,1,1,1,2,1,3,2,0},
{23,1,-1,1,-2,1,-3,1,0,1,1,2,0},
{23,1,0,2,0,3,0,4,0,3,1,3,-1},
{23,1,0,2,0,3,0,4,0,1,1,1,-1},
{24,0,1,0,2,0,3,1,0,1,1,1,3}, // row 4 side 1 stray 1
{24,0,1,0,2,0,3,1,0,1,2,1,3},
{24,1,0,1,1,1,2,1,3,0,1,0,3},
{24,1,0,1,1,1,2,1,3,0,2,0,3},
{24,1,0,2,0,3,0,0,1,1,1,3,1},
{24,1,0,2,0,3,0,0,1,2,1,3,1},
{24,0,1,1,1,2,1,3,1,1,0,3,0},
{24,0,1,1,1,2,1,3,1,2,0,3,0},
{25,0,1,0,2,0,3,1,0,1,1,1,2},
{25,0,1,0,2,0,3,1,1,1,2,1,3},
{25,1,0,1,1,1,2,1,3,0,1,0,2},
{25,1,0,1,1,1,2,1,-1,0,1,0,2},
{25,1,0,2,0,3,0,0,1,1,1,2,1},
{25,1,0,2,0,3,0,1,1,2,1,3,1},
{25,0,1,1,1,2,1,3,1,1,0,2,0},
{25,1,0,2,0,3,0,1,-1,2,-1,3,-1},
{26,0,1,0,2,0,3,1,0,1,-1,1,-2},
{26,0,1,0,2,0,3,1,3,1,4,1,5},
{26,0,1,0,2,1,2,1,3,1,4,1,5},
{26,0,1,0,2,1,0,1,-1,1,-2,1,-3},
{26,1,0,2,0,3,0,3,1,4,1,5,1},
{26,1,0,2,0,3,0,3,-1,4,-1,5,-1},
{26,1,0,2,0,2,1,3,1,4,1,5,1},
{26,1,0,2,0,2,-1,3,-1,4,-1,5,-1},
{27,0,1,0,2,0,3,1,0,1,-1,1,1},
{27,0,1,0,2,0,3,1,2,1,3,1,4},
{27,0,1,0,2,1,1,1,2,1,3,1,4},
{27,0,1,0,2,1,1,1,0,1,-1,1,-2},
{27,1,0,2,0,3,0,2,1,3,1,4,1},
{27,1,0,2,0,3,0,2,-1,3,-1,4,-1},
{27,1,0,2,0,1,1,2,1,3,1,4,1},
{27,1,0,2,0,1,-1,2,-1,3,-1,4,-1},
{28,0,1,0,2,0,3,1,0,1,-1,1,2},
{28,0,1,0,2,0,3,1,1,1,3,1,4},
{28,0,1,1,1,1,2,1,3,1,4,0,3},
{28,1,0,1,1,1,2,1,-1,0,2,0,3},
{28,1,0,2,0,3,0,1,1,3,1,4,1},
{28,1,0,2,0,3,0,1,-1,3,-1,4,-1},
{28,1,0,1,1,2,1,3,1,4,1,3,0},
{28,1,0,1,-1,2,-1,3,-1,4,-1,3,0},
{29,0,1,0,2,0,3,1,0,1,-1,1,3},
{29,0,1,0,2,0,3,1,0,1,3,1,4},
{29,0,1,1,1,1,2,1,3,1,4,0,4},
{29,1,0,1,1,1,2,1,3,0,3,0,4},
{29,1,0,2,0,3,0,0,1,3,1,4,1},
{29,0,1,1,1,2,1,3,1,3,0,4,0},
{29,1,0,1,1,2,1,3,1,4,1,4,0},
{29,1,0,1,-1,2,-1,3,-1,4,-1,4,0},
{30,1,0,1,1,1,2,1,3,2,0,2,-1}, // row 4 side 2 stray 1
{30,1,0,1,-1,1,-2,1,-3,2,0,2,1},
{30,0,1,1,0,1,-1,1,-2,1,-3,2,0},
{30,0,1,1,1,1,2,1,3,1,4,2,1},
{30,1,0,1,1,1,2,2,1,3,1,4,1},
{30,1,0,1,-1,1,-2,2,-1,3,-1,4,-1},
{30,1,0,2,0,3,0,3,1,3,-1,4,1},
{30,1,0,2,0,3,0,3,1,3,-1,4,-1},
{31,1,0,1,1,1,2,1,-1,2,-1,2,-2},
{31,1,0,1,-1,1,-2,1,1,2,1,2,2},
{31,0,1,1,0,1,-1,1,-2,1,-3,2,-1},
{31,0,1,1,1,1,2,1,3,1,4,2,2},
{31,1,0,1,1,2,1,3,1,4,1,2,2},
{31,1,0,1,-1,2,-1,3,-1,4,-1,2,-2},
{31,1,0,2,0,3,0,2,-1,3,1,4,1},
{31,1,0,2,0,3,0,2,1,3,-1,4,-1},
{32,1,0,1,1,1,-1,1,-2,2,-2,2,-3},
{32,1,0,1,-1,1,1,1,2,2,2,2,3},
{32,0,1,1,0,1,-1,1,-2,1,-3,2,-2},
{32,0,1,1,1,1,2,1,3,1,4,2,3},
{32,1,0,1,1,2,1,3,1,4,1,3,2},
{32,1,0,1,-1,2,-1,3,-1,4,-1,3,-2},
{32,1,0,2,0,3,0,1,-1,3,1,4,1},
{32,1,0,2,0,3,0,1,1,3,-1,4,-1},
{33,1,0,1,-1,1,-2,1,-3,2,-3,2,-4},
{33,1,0,1,1,1,2,1,3,2,3,2,4},
{33,0,1,1,0,1,-1,1,-2,1,-3,2,-3},
{33,0,1,1,1,1,2,1,3,1,4,2,4},
{33,1,0,1,1,2,1,3,1,4,1,4,2},
{33,1,0,1,-1,2,-1,3,-1,4,-1,4,-2},
{33,0,1,1,1,2,1,3,1,3,2,4,2},
{33,1,0,2,0,3,0,0,1,3,-1,4,-1},
{34,0,1,1,0,1,1,1,2,1,3,2,0},
{34,0,1,1,0,1,1,1,-1,1,-2,2,1},
{34,1,0,1,1,1,2,1,3,2,0,2,1},
{34,1,0,1,-1,1,-2,1,-3,2,0,2,-1},
{34,0,1,1,1,2,1,3,1,1,0,0,2},
{34,0,1,1,1,2,1,3,1,0,2,1,2},
{34,1,0,2,0,3,0,2,1,3,1,3,-1},
{34,1,0,2,0,3,0,3,1,2,-1,3,-1},
{35,0,1,1,0,1,1,1,2,1,3,2,1},
{35,0,1,1,0,1,1,1,-1,1,-2,2,0},
{35,1,0,1,1,1,2,1,-1,2,0,2,-1},
{35,1,0,1,-1,1,-2,1,1,2,0,2,1},
{35,0,1,1,1,2,1,3,1,1,0,1,2},
{35,1,0,2,0,3,0,0,1,1,1,1,-1},
{35,1,0,2,0,3,0,2,1,3,1,2,-1},
{35,1,0,2,0,3,0,2,1,2,-1,3,-1},
{36,0,1,1,0,1,1,1,2,1,3,2,2},
{36,0,1,1,0,1,1,1,-1,1,-2,2,-1},
{36,1,0,1,1,1,-1,1,-2,2,-1,2,-2},
{36,1,0,1,-1,1,1,1,2,2,1,2,2},
{36,0,1,1,1,2,1,3,1,1,0,2,2},
{36,1,0,2,0,3,0,0,1,1,1,2,-1},
{36,1,0,2,0,3,0,2,1,3,1,1,-1},
{36,1,0,2,0,3,0,1,1,2,-1,3,-1},
{37,0,1,1,0,1,1,1,2,1,3,2,3},
{37,0,1,1,0,1,1,1,-1,1,-2,2,-2},
{37,1,0,1,-1,1,-2,1,-3,2,-2,2,-3},
{37,1,0,1,1,1,2,1,3,2,2,2,3},
{37,0,1,1,1,2,1,3,1,1,0,3,2},
{37,1,0,2,0,3,0,0,1,1,1,3,-1},
{37,0,1,1,1,2,1,3,1,2,2,3,2},
{37,1,0,2,0,3,0,0,1,2,-1,3,-1},
{38,1,0,1,1,1,2,1,3,2,0,0,2},
{38,1,0,1,1,1,2,1,-1,2,2,0,2},
{38,1,0,1,1,1,2,1,3,2,0,2,2},
{38,1,0,1,-1,1,-2,1,-3,2,0,2,-2},
{38,0,1,1,1,2,1,3,1,2,0,0,2},
{38,0,1,1,1,2,1,3,1,0,2,2,2},
{38,1,0,2,0,3,0,1,1,3,1,3,-1},
{38,1,0,2,0,3,0,3,1,1,-1,3,-1},
{39,1,0,1,1,1,2,1,3,2,1,0,2},
{39,1,0,1,1,1,2,1,-1,2,1,0,2},
{39,1,0,1,1,1,2,1,-1,2,1,2,-1},
{39,1,0,1,-1,1,-2,1,1,2,-1,2,1},
{39,0,1,1,1,2,1,3,1,2,0,1,2},
{39,1,0,2,0,3,0,0,1,2,1,1,-1},
{39,1,0,2,0,3,0,1,1,3,1,2,-1},
{39,1,0,2,0,3,0,2,1,1,-1,3,-1},
{40,1,0,1,1,1,2,1,3,2,2,0,2},
{40,1,0,1,1,1,2,1,-1,2,0,0,2},
{40,1,0,1,1,1,-1,1,-2,2,0,2,-2},
{40,1,0,1,-1,1,1,1,2,2,0,2,2},
{40,0,1,1,1,2,1,3,1,2,0,2,2},
{40,1,0,2,0,3,0,0,1,2,1,2,-1},
{40,1,0,2,0,3,0,1,1,3,1,1,-1},
{40,1,0,2,0,3,0,1,1,1,-1,3,-1},
{41,1,0,1,1,1,2,1,3,2,3,0,2},
{41,1,0,1,1,1,2,1,-1,2,-1,0,2},
{41,1,0,1,-1,1,-2,1,-3,2,-1,2,-3},
{41,1,0,1,1,1,2,1,3,2,1,2,3},
{41,0,1,1,1,2,1,3,1,2,0,3,2},
{41,1,0,2,0,3,0,0,1,2,1,3,-1},
{41,0,1,1,1,2,1,3,1,1,2,3,2},
{41,1,0,2,0,3,0,0,1,1,-1,3,-1},
{42,1,0,1,1,1,2,1,3,2,0,0,3},
{42,1,0,1,1,1,2,1,3,2,3,0,3},
{42,1,0,1,1,1,2,1,3,2,0,2,3},
{42,1,0,1,-1,1,-2,1,-3,2,0,2,-3},
{42,0,1,1,1,2,1,3,1,3,0,0,2},
{42,0,1,1,1,2,1,3,1,3,2,0,2},
{42,1,0,2,0,3,0,0,1,3,1,3,-1},
{42,0,1,1,1,2,1,3,1,3,0,3,2},
{43,1,0,1,1,1,2,1,3,2,1,0,3},
{43,1,0,1,1,1,2,1,3,2,2,0,3},
{43,1,0,1,1,1,2,1,-1,2,2,2,-1},
{43,1,0,1,-1,1,-2,1,1,2,-2,2,1},
{43,0,1,1,1,2,1,3,1,3,0,1,2},
{43,1,0,2,0,3,0,0,1,3,1,1,-1},
{43,1,0,2,0,3,0,0,1,3,1,2,-1},
{43,0,1,1,1,2,1,3,1,2,2,3,0},
{44,0,1,1,0,1,1,1,2,1,-1,2,-1},
{44,0,1,1,0,1,1,1,2,1,-1,2,2},
{44,1,0,1,1,1,2,1,3,2,1,2,2},
{44,1,0,1,-1,1,-2,1,-3,2,-1,2,-2},
{44,1,0,2,0,3,0,0,1,1,-1,2,-1},
{44,0,1,1,1,2,1,3,1,1,2,2,2},
{44,1,0,2,0,3,0,1,1,2,1,3,-1},
{44,1,0,2,0,3,0,1,-1,2,-1,3,1},
{45,0,1,1,0,1,1,1,2,1,-1,2,0},
{45,0,1,1,0,1,1,1,2,1,-1,2,1},
{45,1,0,1,1,1,2,1,-1,2,0,2,1},
{45,1,0,1,-1,1,-2,1,1,2,0,2,-1},
{45,1,0,2,0,3,0,1,1,1,-1,2,-1},
{45,1,0,2,0,3,0,1,1,2,1,1,-1},
{45,1,0,2,0,3,0,1,1,2,1,2,-1},
{45,1,0,2,0,3,0,1,-1,2,-1,2,1},
{46,0,1,0,2,0,3,1,0,2,0,3,0}, // row 4 side 1 stray 3
{46,0,1,0,2,0,3,1,3,2,3,3,3},
{46,1,0,2,0,3,0,3,1,3,2,3,3},
{46,1,0,2,0,3,0,3,-1,3,-2,3,-3},
{47,0,1,0,2,0,3,1,1,2,1,3,1},
{47,0,1,0,2,0,3,1,2,2,2,3,2},
{47,1,0,2,0,3,0,3,1,3,2,3,-1},
{47,1,0,2,0,3,0,3,1,3,-1,3,-2},
{47,1,0,2,0,3,0,1,1,1,2,1,3},
{47,1,0,2,0,3,0,1,-1,1,-2,1,-3},
{47,1,0,2,0,3,0,2,1,2,2,2,3},
{47,1,0,2,0,3,0,2,-1,2,-2,2,-3},
{48,0,1,0,2,0,3,1,0,2,0,1,1}, // row 4 side 2 stray 2
{48,0,1,0,2,0,3,1,3,2,3,1,2},
{48,1,0,2,0,3,0,0,1,0,2,1,1},
{48,0,1,0,2,1,2,2,2,3,2,1,1},
{48,1,0,2,0,2,1,2,2,2,3,1,1},
{48,1,0,2,0,2,-1,2,-2,2,-3,1,-1},
{48,1,0,2,0,3,0,3,1,3,2,2,1},
{48,1,0,2,0,3,0,3,-1,3,-2,2,-1},
{49,0,1,0,2,0,3,1,0,2,0,1,2},
{49,0,1,0,2,0,3,1,3,2,3,1,1},
{49,1,0,2,0,3,0,0,1,0,2,2,1},
{49,0,1,0,2,1,2,2,2,3,2,2,1},
{49,1,0,2,0,2,1,2,2,2,3,1,2},
{49,1,0,2,0,2,-1,2,-2,2,-3,1,-2},
{49,1,0,2,0,3,0,3,1,3,2,1,1},
{49,1,0,2,0,3,0,3,-1,3,-2,1,-1},
{50,0,1,0,2,0,3,1,0,2,0,1,3},
{50,0,1,0,2,0,3,1,3,2,3,1,0},
{50,1,0,2,0,3,0,0,1,0,2,3,1},
{50,0,1,0,2,1,2,2,2,3,2,3,1},
{50,1,0,2,0,2,1,2,2,2,3,1,3},
{50,1,0,2,0,2,-1,2,-2,2,-3,1,-3},
{50,1,0,2,0,3,0,3,1,3,2,0,1},
{50,0,1,1,1,2,1,3,1,3,0,3,-1},
{51,1,0,1,1,1,2,1,3,2,3,3,3},
{51,1,0,1,-1,1,-2,1,-3,2,-3,3,-3},
{51,1,0,2,0,2,1,2,2,2,3,3,3},
{51,1,0,2,0,2,-1,2,-2,2,-3,3,-3},
{51,0,1,0,2,1,0,2,0,3,0,3,-1},
{51,0,1,0,2,1,2,2,2,3,2,3,3},
{51,0,1,1,0,2,0,3,0,3,-1,3,-2},
{51,0,1,1,1,2,1,3,1,3,2,3,3},
{52,1,0,1,1,1,2,1,-1,2,2,3,2},
{52,1,0,1,-1,1,-2,1,1,2,-2,3,-2},
{52,1,0,2,0,2,1,2,2,2,3,3,2},
{52,1,0,2,0,2,-1,2,-2,2,-3,3,-2},
{52,0,1,0,2,1,0,2,0,3,0,2,-1},
{52,0,1,0,2,1,2,2,2,3,2,2,3},
{52,1,0,2,0,3,0,3,-1,3,-2,1,1},
{52,1,0,2,0,3,0,3,1,3,2,1,-1},
{53,1,0,1,1,1,-1,1,-2,2,1,3,1},
{53,1,0,1,-1,1,1,1,2,2,-1,3,-1},
{53,1,0,2,0,2,1,2,2,2,3,3,1},
{53,1,0,2,0,2,-1,2,-2,2,-3,3,-1},
{53,0,1,0,2,1,0,2,0,3,0,1,-1},
{53,0,1,0,2,1,2,2,2,3,2,1,3},
{53,1,0,2,0,3,0,3,-1,3,-2,2,1},
{53,1,0,2,0,3,0,3,1,3,2,2,-1},
{54,0,1,0,2,0,3,1,0,2,0,1,-1},
{54,0,1,0,2,0,3,1,3,2,3,1,4},
{54,1,0,2,0,2,1,2,2,2,3,1,-1},
{54,1,0,2,0,2,-1,2,-2,2,-3,1,1},
{54,1,0,2,0,3,0,3,1,3,2,4,1},
{54,1,0,2,0,3,0,3,-1,3,-2,4,-1},
{54,1,-1,1,0,1,1,2,-1,3,-1,4,-1},
{54,1,-1,1,0,1,1,2,1,3,1,4,1},
{55,0,1,0,2,0,3,1,0,2,0,2,-1},
{55,0,1,0,2,0,3,1,3,2,3,2,4},
{55,0,1,1,1,2,1,2,2,2,3,2,4},
{55,1,0,2,0,2,-1,2,-2,2,-3,0,1},
{55,1,0,2,0,3,0,3,1,3,2,4,2},
{55,1,0,2,0,3,0,3,-1,3,-2,4,-2},
{55,1,0,1,1,1,2,2,2,3,2,4,2},
{55,1,0,1,-1,1,-2,2,-2,3,-2,4,-2},
{56,0,1,0,2,0,3,1,0,2,0,2,1},
{56,0,1,0,2,0,3,1,3,2,3,2,2},
{56,1,0,2,0,2,1,2,2,2,3,0,1},
{56,0,1,1,1,2,1,2,0,2,-1,2,-2},
{56,1,0,2,0,3,0,3,1,3,2,2,2},
{56,1,0,2,0,3,0,3,-1,3,-2,2,-2},
{56,0,1,0,2,1,0,2,0,3,0,1,2},
{56,0,1,0,2,1,2,2,2,3,2,1,0},
{57,0,1,0,2,0,3,1,1,2,1,1,2},
{57,0,1,0,2,0,3,1,2,2,2,1,1},
{57,1,0,2,0,2,1,2,2,2,-1,1,1},
{57,1,0,2,0,2,1,2,-1,2,-2,1,-1},
{57,1,0,2,0,3,0,1,1,1,2,2,1},
{57,1,0,2,0,3,0,1,-1,1,-2,2,-1},
{57,1,0,2,0,3,0,2,1,2,2,1,1},
{57,1,0,2,0,3,0,2,-1,2,-2,1,-1},
{58,0,1,0,2,0,3,1,1,2,1,1,3},
{58,0,1,0,2,0,3,1,2,2,2,1,0},
{58,1,0,2,0,2,1,2,2,2,-1,1,2},
{58,1,0,2,0,2,1,2,-1,2,-2,1,-2},
{58,1,0,2,0,3,0,1,1,1,2,3,1},
{58,1,0,2,0,3,0,1,-1,1,-2,3,-1},
{58,1,0,2,0,3,0,2,1,2,2,0,1},
{58,0,1,1,1,2,1,3,1,2,0,2,-1},
{59,1,0,1,-1,1,-2,1,-3,2,-2,3,-2},
{59,1,0,1,1,1,2,1,3,2,2,3,2},
{59,1,0,2,0,2,1,2,2,2,-1,3,2},
{59,1,0,2,0,2,1,2,-1,2,-2,3,-2},
{59,1,0,2,0,3,0,1,1,1,2,3,-1},
{59,1,0,2,0,3,0,1,-1,1,-2,3,1},
{59,0,1,1,0,2,0,3,0,2,-1,2,-2},
{59,0,1,1,1,2,1,3,1,2,2,2,3},
{60,1,0,1,-1,1,-2,1,1,2,-1,3,-1},
{60,1,0,1,1,1,2,1,-1,2,1,3,1},
{60,1,0,2,0,2,1,2,2,2,-1,3,1},
{60,1,0,2,0,2,1,2,-1,2,-2,3,-1},
{60,1,0,2,0,3,0,1,1,1,2,2,-1},
{60,1,0,2,0,3,0,1,-1,1,-2,2,1},
{60,1,0,2,0,3,0,2,-1,2,-2,1,1},
{60,1,0,2,0,3,0,2,1,2,2,1,-1},
{61,1,0,1,-1,1,1,1,2,2,0,3,0},
{61,1,0,1,1,1,-1,1,-2,2,0,3,0},
{61,1,0,2,0,3,0,2,1,2,2,2,-1},
{61,1,0,2,0,3,0,2,1,2,-1,2,-2},
{62,1,0,1,1,1,2,1,3,2,1,3,1},
{62,1,0,1,-1,1,-2,1,-3,2,-1,3,-1},
{62,1,0,2,0,2,1,2,2,2,-1,3,-1},
{62,1,0,2,0,2,1,2,-1,2,-2,3,1},
{62,0,1,1,1,2,1,3,1,1,2,1,3},
{62,1,0,2,0,3,0,1,-1,1,-2,0,1},
{62,1,0,2,0,3,0,2,-1,2,-2,3,1},
{62,1,0,2,0,3,0,2,1,2,2,3,-1},
{63,0,1,0,2,0,3,1,1,2,1,1,0},
{63,0,1,0,2,0,3,1,2,2,2,1,3},
{63,1,0,2,0,2,1,2,2,2,-1,1,-1},
{63,1,0,2,0,2,1,2,-1,2,-2,1,1},
{63,1,0,2,0,3,0,1,1,1,2,0,1},
{63,0,1,1,1,2,1,3,1,1,0,1,-1},
{63,1,0,2,0,3,0,2,1,2,2,3,1},
{63,1,0,2,0,3,0,2,-1,2,-2,3,-1},
{64,0,1,0,2,0,3,1,1,2,1,2,0},
{64,0,1,0,2,0,3,1,2,2,2,2,3},
{64,0,1,1,1,2,1,2,2,2,3,2,0},
{64,1,0,2,0,2,1,2,-1,2,-2,0,1},
{64,1,0,2,0,3,0,1,1,1,2,0,2},
{64,1,0,1,1,1,2,0,2,2,2,3,2},
{64,1,0,2,0,3,0,2,1,2,2,3,2},
{64,1,0,2,0,3,0,2,-1,2,-2,3,-2},
{65,0,1,0,2,0,3,1,1,2,1,2,2},
{65,0,1,0,2,0,3,1,2,2,2,2,1},
{65,1,0,2,0,2,1,2,2,2,-1,0,1},
{65,0,1,1,1,2,1,2,0,2,-1,2,2},
{65,1,0,2,0,3,0,1,1,1,2,2,2},
{65,1,0,2,0,3,0,1,-1,1,-2,2,-2},
{65,1,0,2,0,3,0,2,1,2,2,1,2},
{65,1,0,2,0,3,0,2,-1,2,-2,1,-2},
{66,0,1,0,2,0,3,1,0,1,-1,2,-1},
{66,0,1,0,2,0,3,1,3,1,4,2,4},
{66,1,0,1,1,2,1,2,2,2,3,2,4},
{66,1,0,1,-1,2,-1,2,-2,2,-3,2,-4},
{66,1,0,2,0,3,0,3,1,4,1,4,2},
{66,1,0,2,0,3,0,3,-1,4,-1,4,-2},
{66,0,1,1,0,1,-1,2,-1,3,-1,4,-1},
{66,0,1,1,1,1,2,2,2,3,2,4,2},
{67,0,1,0,2,1,0,1,1,1,2,2,0}, // 2 by 3 rectangle
{67,0,1,0,2,1,0,1,1,1,2,2,2},
{67,1,0,1,1,1,2,2,0,2,1,2,2},
{67,1,0,1,-1,1,-2,2,0,2,-1,2,-2},
{67,0,1,1,0,1,1,2,0,2,1,0,2},
{67,0,1,0,2,1,1,1,2,2,1,2,2},
{67,0,1,1,0,1,1,2,0,2,1,2,2},
{67,0,1,1,0,1,1,2,0,2,1,2,-1},
{68,0,1,0,2,1,0,1,1,1,2,2,1},
{68,1,0,1,1,1,-1,2,0,2,1,2,-1},
{68,0,1,1,0,1,1,2,0,2,1,1,2},
{68,0,1,1,0,1,1,2,0,2,1,1,-1},
{69,0,1,1,-1,1,0,1,1,2,-1,2,0}, // square square
{69,0,1,1,0,1,1,1,2,2,1,2,2},
{70,0,1,1,0,1,1,2,1,2,2,2,3}, // square
{70,0,1,1,0,1,1,2,0,2,-1,2,-2},
{70,0,1,0,2,1,2,1,3,2,2,2,3},
{70,0,1,0,2,1,0,1,-1,2,0,2,-1},
{70,0,1,1,0,1,1,1,2,2,2,3,2},
{70,0,1,1,0,1,1,1,-1,2,-1,3,-1},
{70,1,0,2,0,2,1,2,2,3,1,3,2},
{70,1,0,2,0,2,-1,2,-2,3,-1,3,-2},
{71,0,1,1,0,1,1,2,1,2,2,3,2},
{71,0,1,1,0,1,1,2,0,2,-1,3,-1},
{71,1,0,1,1,2,1,2,2,3,1,3,2},
{71,1,0,1,-1,2,-1,2,-2,3,-1,3,-2},
{71,0,1,1,0,1,1,1,2,2,2,2,3},
{71,0,1,1,0,1,1,1,-1,2,-1,2,-2},
{71,0,1,1,0,1,-1,1,-2,2,-1,2,-2},
{71,0,1,1,1,1,2,1,3,2,2,2,3},
{72,0,1,1,0,1,1,2,1,2,2,1,-1},
{72,0,1,1,0,1,1,2,0,2,-1,1,2},
{72,0,1,1,0,1,-1,2,0,2,-1,1,-2},
{72,0,1,1,1,1,2,2,1,2,2,1,3},
{72,1,0,1,1,1,2,2,1,2,2,3,1},
{72,1,0,1,-1,1,-2,2,-1,2,-2,3,-1},
{72,1,0,1,1,2,0,2,1,2,-1,3,-1},
{72,1,0,1,-1,2,0,2,-1,2,1,3,1},
{73,0,1,0,2,1,1,1,2,2,2,2,3},
{73,0,1,1,0,1,1,2,0,2,-1,0,2},
{73,0,1,1,0,1,-1,2,0,2,-1,2,-2},
{73,0,1,1,1,1,2,2,1,2,2,2,3},
{73,1,0,1,1,1,2,2,1,2,2,3,2},
{73,1,0,1,-1,1,-2,2,-1,2,-2,3,-2},
{73,1,0,1,1,2,0,2,1,2,2,3,2},
{73,1,0,1,-1,2,0,2,-1,2,-2,3,-2},
{74,1,0,1,1,2,0,2,1,3,1,3,2},
{74,1,0,1,-1,2,0,2,-1,3,-1,3,-2},
{74,0,1,1,1,1,2,2,1,2,2,3,2},
{74,0,1,1,0,1,-1,2,0,2,-1,3,-1},
{74,0,1,0,2,1,1,1,2,1,3,2,3},
{74,0,1,0,2,1,0,1,1,1,-1,2,-1},
{74,1,0,1,1,1,2,2,1,2,2,2,3},
{74,1,0,1,-1,1,-2,2,-1,2,-2,2,-3},
{75,0,1,1,0,1,1,0,2,2,1,2,2},
{75,0,1,0,2,1,1,1,2,2,1,2,0},
{75,0,1,1,1,1,2,2,1,2,2,2,0},
{75,0,1,1,0,1,-1,2,0,2,-1,2,1},
{75,0,1,1,0,1,1,1,2,2,0,2,2},
{75,0,1,1,-1,1,0,1,1,2,1,2,-1},
{75,1,0,1,1,1,2,0,2,2,0,2,1},
{75,1,0,1,1,1,2,0,2,2,2,2,1},
{76,1,0,1,-1,2,0,2,-1,2,-2,3,-1},
{76,1,0,1,1,2,0,2,1,2,2,3,1},
{76,1,0,1,-1,2,0,2,-1,1,1,3,-1},
{76,1,0,1,1,2,0,2,1,1,-1,3,1},
{76,1,0,1,-1,2,0,2,-1,1,1,2,-2},
{76,1,0,1,1,2,0,2,1,1,-1,2,2},
{76,0,1,0,2,1,1,1,2,1,3,2,2},
{76,0,1,1,0,1,1,0,2,2,0,1,-1},
{77,0,1,1,0,1,1,0,2,2,1,1,-1},
{77,0,1,0,2,1,1,1,2,2,1,1,3},
{77,1,0,1,-1,2,0,2,-1,2,1,1,-2},
{77,1,0,1,1,2,0,2,1,2,-1,1,2},
{77,1,0,2,0,1,1,2,1,1,2,3,1},
{77,1,0,2,0,1,-1,2,-1,1,-2,3,-1},
{77,1,0,1,-1,2,0,2,-1,2,1,3,-1},
{77,1,0,1,1,2,0,2,1,2,-1,3,1},
{78,1,-1,1,0,1,1,2,-1,3,-1,2,-2}, // off chair
{78,1,-1,1,0,1,1,2,1,3,1,2,2},
{78,1,0,2,0,2,1,2,2,3,1,1,-1},
{78,1,0,2,0,2,-1,2,-2,3,-1,1,1},
{79,1,-1,1,0,1,1,2,-1,3,-1,3,-2},
{79,1,-1,1,0,1,1,2,1,3,1,3,2},
{79,1,0,1,-1,1,-2,2,-2,3,-2,2,-3},
{79,1,0,1,1,1,2,2,2,3,2,2,3},
{79,0,1,1,0,2,0,2,-1,2,-2,3,-1},
{79,0,1,1,1,2,1,2,2,2,3,3,2},
{79,1,0,2,0,1,-1,2,1,2,2,3,2},
{79,1,0,2,0,1,1,2,-1,2,-2,3,-2},
{80,1,-1,1,0,1,1,2,-1,3,-1,3,0},
{80,1,-1,1,0,1,1,2,1,3,1,3,0},
{80,1,0,0,1,0,2,1,2,2,2,1,3},
{80,0,1,0,2,1,2,1,0,2,0,1,-1},
{80,0,1,1,0,2,0,2,1,2,2,3,1},
{80,0,1,1,1,2,1,2,0,2,-1,3,0},
{80,1,0,2,0,1,-1,2,1,2,2,1,2},
{80,1,0,2,0,1,1,2,-1,2,-2,1,-2},
{81,1,-1,1,0,1,1,2,-1,3,-1,2,1},
{81,1,-1,1,0,1,1,2,1,3,1,2,-1},
{81,0,1,0,2,1,2,2,2,1,3,2,1},
{81,0,1,0,2,1,0,2,0,1,-1,2,1},
{81,0,1,1,0,2,0,2,1,2,2,1,-1},
{81,0,1,1,1,2,1,2,0,2,-1,1,2},
{81,1,0,2,0,2,1,2,2,1,2,3,1},
{81,1,0,2,0,2,-1,2,-2,1,-2,3,-1},
{82,0,1,1,1,2,1,2,2,2,3,3,3},
{82,0,1,1,0,2,0,2,-1,2,-2,3,-2},
{82,1,0,1,1,1,2,2,2,3,2,3,3},
{82,1,0,1,-1,1,-2,2,-2,3,-2,3,-3},
{83,0,1,1,1,2,1,2,2,2,3,1,3},
{83,0,1,1,0,2,0,2,-1,2,-2,1,-2},
{83,0,1,0,2,1,2,2,2,2,3,1,0},
{83,0,1,0,2,1,2,1,0,2,0,2,-1},
{83,0,1,1,0,2,0,2,1,2,2,3,2},
{83,0,1,1,1,2,1,2,0,2,-1,3,-1},
{83,1,0,1,1,1,2,2,2,3,2,3,1},
{83,1,0,1,-1,1,-2,2,-2,3,-2,3,-1},
{84,0,1,0,2,1,1,2,1,2,2,2,3},
{84,0,1,0,2,1,1,2,1,2,0,2,-1},
{84,1,0,2,0,2,1,2,2,1,2,3,2},
{84,1,0,2,0,2,-1,2,-2,3,-2,1,-2},
{84,0,1,0,2,1,0,2,0,2,-1,2,1},
{84,0,1,0,2,1,2,2,2,2,3,2,1},
{84,1,0,2,0,1,1,1,2,2,2,3,2},
{84,1,0,2,0,1,-1,1,-2,2,-2,3,-2},
{85,0,1,1,0,2,0,2,1,2,2,1,2},
{85,0,1,1,1,2,1,2,0,2,-1,1,-1},
{85,1,0,0,1,0,2,1,2,2,2,2,1},
{85,0,1,0,2,1,2,1,0,2,0,2,1},
{86,1,0,2,0,2,1,2,2,1,-1,1,-2},
{86,1,0,2,0,1,1,1,2,2,-1,2,-2},
{86,0,1,0,2,1,0,2,0,1,-1,1,-2},
{86,0,1,0,2,1,2,2,2,1,3,1,4},
{86,1,0,2,0,2,1,2,2,3,1,4,1},
{86,1,0,2,0,2,-1,2,-2,3,-1,4,-1},
{86,1,0,2,0,2,-1,2,1,3,1,4,1},
{86,1,0,2,0,2,-1,2,1,3,-1,4,-1},
{87,0,1,0,2,1,2,2,2,2,3,2,4},
{87,0,1,0,2,1,0,2,0,2,-1,2,-2},
{87,1,0,2,0,2,1,2,2,3,2,4,2},
{87,1,0,2,0,2,-1,2,-2,3,-2,4,-2},
{88,0,1,0,2,1,0,2,0,2,1,2,2},
{88,0,1,0,2,1,2,2,2,2,1,2,0},
{88,0,1,0,2,1,2,2,2,1,0,2,0},
{88,1,0,2,0,2,1,2,2,1,2,0,2},
{89,0,1,0,2,1,2,2,2,2,3,3,3},
{89,0,1,0,2,1,0,2,0,2,-1,3,-1},
{89,0,1,1,0,1,-1,1,-2,2,-2,3,-2},
{89,0,1,1,1,1,2,1,3,2,3,3,3},
{89,1,0,2,0,2,1,2,2,3,2,3,3},
{89,1,0,2,0,2,-1,2,-2,3,-2,3,-3},
{89,1,0,1,1,2,1,3,1,3,2,3,3},
{89,1,0,1,-1,2,-1,3,-1,3,-2,3,-3},
{90,0,1,0,2,1,2,2,2,2,1,3,1},
{90,0,1,0,2,1,0,2,0,2,1,3,1},
{90,0,1,0,2,1,2,2,2,1,0,1,-1},
{90,0,1,0,2,1,0,2,0,1,2,1,3},
{90,1,0,2,0,2,1,2,2,1,2,1,3},
{90,1,0,2,0,2,-1,2,-2,1,-2,1,-3},
{90,1,0,1,-1,2,-1,3,-1,3,0,3,1},
{90,1,0,1,1,2,1,3,1,3,0,3,-1},
{91,0,1,0,2,1,1,2,0,2,1,2,2}, // off T
{91,1,0,2,0,1,1,0,2,1,2,2,2},
{92,1,0,1,1,1,2,2,1,3,1,3,0},
{92,1,0,1,-1,1,-2,2,-1,3,-1,3,0},
{92,0,1,1,1,2,1,2,0,2,2,3,0},
{92,0,1,1,0,2,0,2,-1,2,1,3,1},
{92,0,1,1,1,2,1,1,2,1,3,0,3},
{92,1,0,1,1,1,2,0,2,2,2,0,3},
{92,1,0,1,1,1,2,2,2,2,0,2,-1},
{92,1,0,1,-1,1,-2,2,-2,2,0,2,1},
{93,1,0,1,1,1,2,2,1,3,1,3,2},
{93,1,0,1,-1,1,-2,2,-1,3,-1,3,-2},
{93,0,1,1,1,2,1,2,0,2,2,3,2},
{93,0,1,1,0,2,0,2,-1,2,1,3,-1},
{93,0,1,1,1,2,1,1,2,1,3,2,3},
{93,0,1,1,0,2,0,1,-1,1,-2,2,-2},
{93,1,0,1,1,1,2,0,2,2,0,2,-1},
{93,1,0,1,1,1,2,0,2,2,2,2,3},
{94,1,0,1,1,1,2,0,2,2,1,3,1},
{94,1,0,2,-1,2,0,2,1,3,-1,3,1},
{94,0,1,1,1,2,1,2,0,1,2,1,3},
{94,0,1,1,0,2,0,2,1,1,-1,1,-2},
{95,0,1,0,2,1,1,2,1,2,2,3,2},
{95,0,1,0,2,1,1,2,1,2,0,3,0},
{95,1,0,1,1,2,1,3,1,3,0,3,2},
{95,1,0,1,-1,2,-1,3,-1,3,0,3,-2},
{95,1,0,2,0,1,1,1,2,0,2,0,3},
{95,0,1,1,1,1,2,1,3,0,3,2,3},
{95,1,0,2,0,1,1,1,2,2,2,2,3},
{95,1,0,2,0,1,-1,1,-2,2,-2,2,-3},
{96,0,1,1,1,1,2,1,3,2,2,3,2},
{96,0,1,1,0,1,-1,1,-2,2,-1,3,-1},
{96,1,0,2,0,2,-1,2,1,3,1,3,2},
{96,1,0,2,0,2,-1,2,1,3,-1,3,-2},
{96,1,0,1,1,1,2,2,0,2,-1,3,-1},
{96,1,0,2,0,1,-1,1,-2,2,1,3,1},
{96,1,0,1,1,2,1,3,1,2,2,2,3},
{96,1,0,1,-1,2,-1,3,-1,2,-2,2,-3},
{97,0,1,1,1,1,2,1,3,0,3,0,4}, // off C
{97,0,1,0,2,1,0,1,-1,1,2,1,3},
{97,1,0,1,1,2,1,3,1,3,0,4,0},
{97,1,0,1,-1,2,-1,3,-1,3,0,4,0},
{98,0,1,1,1,1,2,1,3,2,2,0,3},
{98,1,0,1,1,1,2,2,1,0,2,0,3},
{98,1,-1,1,0,1,1,2,-1,2,1,2,2},
{98,1,-1,1,0,1,1,2,-1,2,-2,2,1},
{98,0,1,1,1,2,1,1,2,2,0,3,0},
{98,0,1,1,0,2,0,2,1,3,1,1,-1},
{98,1,0,1,1,2,1,3,1,2,2,3,0},
{98,1,0,1,-1,2,-1,3,-1,2,-2,3,0},
{99,1,0,1,1,1,2,0,2,0,3,0,4},
{99,0,1,0,2,1,2,1,3,1,4,0,4},
{99,0,1,0,2,1,2,1,0,1,-1,1,-2},
{99,0,1,0,2,1,0,1,2,1,3,1,4},
{99,0,1,1,0,2,0,2,1,3,1,4,1},
{99,0,1,1,1,2,1,2,0,3,0,4,0},
{99,1,0,2,0,2,1,3,1,4,1,4,0},
{99,1,0,2,0,2,-1,3,-1,4,-1,4,0},
{100,0,1,0,2,1,0,1,2,1,3,2,3},
{100,0,1,0,2,1,0,1,2,1,-1,2,-1},
{100,1,0,1,1,2,1,2,2,2,3,1,3},
{100,1,0,1,-1,2,-1,2,-2,2,-3,1,-3},
{100,0,1,1,0,2,0,2,1,3,1,3,2},
{100,0,1,1,1,2,1,2,0,3,0,3,-1},
{100,0,1,1,1,1,2,2,2,3,2,3,1},
{100,0,1,1,0,1,-1,2,-1,3,-1,3,0},
{101,0,1,1,1,1,2,1,3,2,3,2,4}, // off zigzag
{101,0,1,1,0,1,-1,1,-2,2,-2,2,-3},
{101,1,0,1,1,2,1,3,1,3,2,4,2},
{101,1,0,1,-1,2,-1,3,-1,3,-2,4,-2},
{102,0,1,0,2,1,2,1,3,1,4,2,4},
{102,0,1,0,2,1,0,1,-1,1,-2,2,-2},
{102,1,0,1,1,1,2,2,2,2,3,2,4},
{102,1,0,1,-1,1,-2,2,-2,2,-3,2,-4},
{102,0,1,1,1,2,1,2,2,3,2,4,2},
{102,0,1,1,0,2,0,2,-1,3,-1,4,-1},
{102,1,0,2,0,2,1,3,1,4,1,4,2},
{102,1,0,2,0,2,-1,3,-1,4,-1,4,-2},
{103,1,0,1,1,2,1,2,2,2,3,3,3},
{103,1,0,1,-1,2,-1,2,-2,2,-3,3,-3},
{103,1,0,1,1,1,2,2,2,2,3,3,3},
{103,1,0,1,-1,1,-2,2,-2,2,-3,3,-3},
{103,0,1,1,1,2,1,2,2,3,2,3,3},
{103,0,1,1,0,2,0,2,-1,3,-1,3,-2},
{103,0,1,1,0,1,-1,2,-1,3,-1,3,-2},
{103,0,1,1,1,1,2,2,2,3,2,3,3},
{104,1,-1,1,0,1,1,2,1,2,2,3,2}, // off faucet
{104,1,-1,1,0,1,1,2,-1,2,-2,3,-2},
{104,1,0,1,1,2,1,2,2,3,2,2,3},
{104,1,0,1,-1,2,-1,2,-2,3,-2,2,-3},
{104,1,-1,1,0,2,0,2,1,3,1,3,2},
{104,1,0,1,1,2,0,2,-1,3,-1,3,-2},
{104,0,1,1,1,1,2,2,2,2,3,3,2},
{104,0,1,1,0,1,-1,2,-1,2,-2,3,-1},
{105,0,1,0,2,1,0,1,-1,1,-2,2,-1},
{105,0,1,0,2,1,2,1,3,1,4,2,3},
{105,1,-1,1,0,1,1,2,1,2,2,2,3},
{105,1,-1,1,0,1,1,2,-1,2,-2,2,-3},
{105,1,0,2,0,2,1,3,1,4,1,3,2},
{105,1,0,2,0,2,-1,3,-1,4,-1,3,-2},
{105,1,0,2,0,2,1,3,1,4,1,1,-1},
{105,1,0,2,0,2,-1,3,-1,4,-1,1,1},
{106,0,1,1,1,1,2,2,2,2,3,3,3}, // off stairs
{106,0,1,1,0,1,-1,2,-1,2,-2,3,-2},
{106,1,0,1,1,2,1,2,2,3,2,3,3},
{106,1,0,1,-1,2,-1,2,-2,3,-2,3,-3},
{107,0,1,0,2,1,2,1,3,2,3,2,4},
{107,0,1,0,2,1,0,1,-1,2,-1,2,-2},
{107, 0,1,1,1,1,2,2,2,2,3,2,4},
{107,0,1,1,0,1,-1,2,-1,2,-2,2,-3},
{107,1,0,2,0,2,1,3,1,3,2,4,2},
{107,1,0,2,0,2,-1,3,-1,3,-2,4,-2},
{107,1,0,1,1,2,1,2,2,3,2,4,2},
{107,1,0,1,-1,2,-1,2,-2,3,-2,4,-2},
{108,0,1,0,2,1,2,1,3,2,3,3,3},
{108,0,1,0,2,1,0,1,-1,2,-1,3,-1},
{108,1,0,2,0,2,-1,3,-1,3,-2,3,-3},
{108,1,0,2,0,2,1,3,1,3,2,3,3},
{0}
};

static char pheight[760];
char used[108+1];
int depth;
int level;
int nsols;
static char dosort[108+1] = {0,85,1,
78,79,80,81,82,83,84,86,87,88,89,90,
91,92,93,94,95,96,97,98,99,100,
101,102,103,104,105,106,107,108,
5,7,8,9,10,11,
13,14,15,16,17,18,19,20,21,22,23,
26,27,28,
30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,
47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,
68,69,70,71,72,73,74,
2,3,4,
6,12,
46,
67,
24,25,29,
75,76,77,
};

static char checkperm[108+1];
int dosort2[756];
char countflag, dispflag;
int lvt, lvc;

/* print solution */
static void showBoard(void)
{
int row, col;
for(row=1; row<=depth; ++row) {
for(col=1; col<=7; ++col) {
int d = board[row][col] % 52;
if(d < 26) d += 'A'; else d += ('a' - 26);
putchar(d);
}
putchar(dispflag ? '\n' : '|');
}
putchar('\n');
fflush(stdout);
}

static void nextLocation(int *xp, int *yp)
{
int x, y;
x = *xp, y = *yp;
top:
if(++y > 7) ++x, y = 1;
if(board[x][y]) goto top;
*xp = x, *yp = y;
}

static char leastc[128];
static char atbottom[128];
static int csize[128];
static int component(int x0, int y0, int h)
{
int cn, b1, b2, b3;
int x, y;
int clow, chigh;
int i;

clow = chigh = 110;
x = x0, y = y0;
top:
if(++y > 7) {
if(++x > h) goto done;
y = 1;
}
if(board[x][y]) goto top;

cn = 0;
b1 = board[x][y-1];
b2 = board[x-1][y];
if(b1 >= 110) b1 = cn = leastc[b1];
if(b2 >= 110) {
b2 = leastc[b2];
if(!cn) cn = b2;
if(cn != b2) {
b3 = b1;
if(b2 < b1) b3 = b2;
for(i=clow; i<chigh; ++i)
if(leastc[i] == b1 || leastc[i] == b2) leastc[i] = b3;
cn = b3;
}
}

if(!cn) {
if(chigh >= 120) { fprintf(stderr, "component number too high\n"); exit(1); }
cn = chigh;
leastc[cn] = cn;
atbottom[cn] = 0;
csize[cn] = 0;
++chigh;
}

/* cn now the least number of its component, so far */
board[x][y] = cn;
if(h == x && h < depth) atbottom[cn] = 1;
goto top;

done:
x = x0, y = y0;
top2:
if(++y > 7) {
if(++x > h) goto done2;
y = 1;
}
if(board[x][y] < 110) goto top2;
++csize[leastc[board[x][y]]];
board[x][y] = 0;
goto top2;

done2:
for(i=clow; i<chigh; ++i) {
if(!csize[i]) continue;
#if DEBUG
printf("hole %d%c\n", csize[i], (atbottom[i] ? '+' : ' '));
#endif
if(!atbottom[i] && csize[i]%7) return -1;
}

return 0;
}

/* place a piece in the board; recursive */
static void place(int x, int y, int h1)
{
int i, ii;
char piece;
const char *s;
int shapelist, shapemask;

/* find best location */
nextLocation(&x, &y);

++level;
#if PERFORM
/* rough measure of performance */
lvt += level;
lvc++;
if(lvc == 100000) {
printf("%d\n", 10*lvt/lvc);
lvc = lvt = 0;
}
#endif

for(i=0; i < 756; ++i) {
ii = dosort2[i];
s = shapes[ii];
piece = *s++;
if(used[piece]) continue;
if(board[x + s[0]][y + s[1]]) continue;
if(board[x + s[2]][y + s[3]]) continue;
if(board[x + s[4]][y + s[5]]) continue;
if(board[x + s[6]][y + s[7]]) continue;
if(board[x + s[8]][y + s[9]]) continue;
if(board[x + s[10]][y + s[11]]) continue;

/* place the piece */
#if DEBUG
if(level >= 1) {
printf("placing piece %d[%d] at square %d,%d, level %d\n", piece, ii, x, y, level);
getchar();
}
#endif
used[piece] = 1;
board[x][y] = piece;
board[x+s[0]][y+s[1]] = piece;
board[x+s[2]][y+s[3]] = piece;
board[x+s[4]][y+s[5]] = piece;
board[x+s[6]][y+s[7]] = piece;
board[x+s[8]][y+s[9]] = piece;
board[x+s[10]][y+s[11]] = piece;

if(level == depth) {
++nsols;
if(!countflag) showBoard();
  exit(0);
} else {
int h2 = h1;
if(x + pheight[ii] > h2) h2 = x + pheight[ii];
if(!component(x, y, h2))
place(x, y, h2);
}

/* remove piece */
used[piece] = 0;
board[x][y] = 0;
board[x+s[0]][y+s[1]] = 0;
board[x+s[2]][y+s[3]] = 0;
board[x+s[4]][y+s[5]] = 0;
board[x+s[6]][y+s[7]] = 0;
board[x+s[8]][y+s[9]] = 0;
board[x+s[10]][y+s[11]] = 0;
}

--level;
} /* place */

void main(int argc, char **argv)
{
int i, j, k;

if(argc > 1) {
if(argv[1][0] == '-') {
if(argv[1][1] == 'c') countflag = 1;
if(argv[1][1] == 'd') dispflag = 1;
++argv, --argc;
}
}

depth = 107;
if(argc > 1 && isdigit(argv[1][0])) {
depth = atoi(argv[1]);
++argv, --argc;
}

if(argc > 1) {
fprintf(stderr, "usage: hept [-c|-d] depth\n");
exit(1);
}

/* the height of each piece */
for(i=0; i<760; ++i) {
int h = 0;
const char *s = shapes[i] + 1;
for(j=0; j<12; j+=2)
if(s[j] > h) h = s[j];
pheight[i] = h;
}

for(i=0; i<9; ++i) {
board[0][i] = -1;
board[depth+1][i] = -1;
}
for(i=0; i<depth+2; ++i) {
board[i][0] = -1;
board[i][8] = -1;
}

used[85] = 1;

/*
for(i=1; i<=108; ++i)
dosort[i] = i*37%108 + 1;
*/

k = 0;
for(i=1; i<=108; ++i) {
char piece = dosort[i];
if(used[piece]) continue;
if(++checkperm[piece] > 1) { printf("repeated piece %d\n", piece); exit(1); }
for(j=0; j<760; ++j) {
const char *s = shapes[j];
if(*s != piece) continue;
dosort2[k++] = j;
}
}
if(k != 756) { printf("after permutation k is %d\n", k); exit(1); }

place(1, 0, 0);

if(countflag) printf("%d solutions\n", nsols);
exit(0);
} /* main */
